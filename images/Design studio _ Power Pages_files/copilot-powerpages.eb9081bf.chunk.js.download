/*! For license information please see copilot-powerpages.eb9081bf.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2645],{41377:function(e,t,a){"use strict";a.r(t),a.d(t,"CopilotPaneWrapper",(function(){return ee}));var n=a(11035),o=a.n(n),r=a(24411),c=a(21793),i=a(20854),l=a(15216),s=a(11382),u=a(21003),p=a(19999),d=a(16432),m=a(21002),b=a(18962),g=a(11203),C=a(21794),E=a(11819),h=a(18953),O=a(21753),f=a(12705),T=a(41378),v=a(41379),y=a(19487),P=a(12600),I=a(18954),S=a(41380),N=a(15175),R=a.n(N),j=a(41383),k=a(21756),A=a(21748),_=a(15108),w=a(20106),L=a(21757),D=a(41394),x=a(12013),M=a.n(x),F=a(15154),G=a(12599),B=a(21763),U=a(41402),H=a(41397),z=a(22249),W=a(41404),q=a(20114),X=a(14497),V=a(12139),Y=a(20021),K=a(21747);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){Z(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Z(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function $(e,t,a,n,o,r,c){try{var i=e[r](c),l=i.value}catch(s){return void a(s)}i.done?t(l):Promise.resolve(l).then(n,o)}var ee=e=>{var t,a=Object(w.a)(),N=Object(r.h)(),x=Object(r.d)(),Q=Object(r.j)(),Z=Object(s.i)(),{t:ee}=Object(g.s)(i.e),{sidecarVisible:te,setSidecarVisible:ae,sidecarContent:ne}=Object(u.a)(),oe=Object(d.f)(e=>e.copilotOperationCxt.componentContext.inKeepItMode),re=Object(d.f)(e=>e.pagesWorkspaceCopilot.isPending),ce=Object(d.f)(e=>e.pagesWorkspaceCopilot.bingSearchConsentEnabled),ie=Object(d.e)(),{isNL2LearnEnabled:le}=Object(P.Jc)(),{enableZeroPromptCopilot:se}=Object(P.Md)(),{enableCopilotCapabilities:ue}=Object(P.jc)(),{enableCrossGeoCall:pe,enableBingChat:de}=Object(_.a)(),{customizationPrefix:me}=Object(q.a)(),be=Object(K.a)(),{enableOrgIdWithIApi:ge}=Object(P.Oc)(),[Ce,Ee]=o.a.useState(!1),he=Object(n.useRef)(void 0),Oe=o.a.useRef(!1),fe=o.a.useRef(""),Te=Object(n.useRef)(null),ve=Object(f.a)(),ye=Object(n.useRef)(new Set),Pe=Object(n.useRef)(()=>{}),Ie=Object(n.useRef)(void 0),Se=Object(n.useContext)(E.b).name.split(" ")[0],Ne=Object(c.b)(),Re=Object(n.useMemo)(()=>({root:{width:"340px",[X.c.smallDown]:{minHeight:"600px"}}}),[]);o.a.useEffect(()=>{ne===m.a.Copilot?te&&!Ce?(N(!0),Q(!0),Ee(!0)):Oe.current!==te?N(te):te&&fe.current!==ne&&N(!0):x&&N(!1),Oe.current=te,fe.current=null!=ne?ne:""},[te,ne]),o.a.useEffect(()=>{x||Object(h.a)().dispatch(Object(y.c)(!1))},[x]),o.a.useEffect(()=>{!x&&Ce&&ne===m.a.Copilot&&(re?(ae(!0),N(!0),ie(Object(y.h)(!0))):Object(Y.a)()?(ae(!0),N(!0)):(ae(!1),ie(p.disableCopilotPanelAutoOpen(!0)))),Te.current&&x&&Te.current.setFocus()},[x,Te]);var je=Object(O.a)(ee),ke=Object(n.useMemo)(()=>{var t,a=ge&&(null==be||null===(t=be.properties.linkedEnvironmentMetadata)||void 0===t?void 0:t.resourceId)||(null==be?void 0:be.name);return{history:Z,sessionId:e.sessionId,orgId:a,enableCrossGeoCall:pe,enableBingChat:de,solutionPrefix:me}},[null==be||null===(t=be.properties.linkedEnvironmentMetadata)||void 0===t?void 0:t.resourceId,null==be?void 0:be.name,ge,Z,e.sessionId,pe,de,me]),Ae=Object(W.a)(e.sessionId).onSendFeedback,_e=Object(n.useCallback)(e=>{var t,a,n,o;e.data&&(I.a.getInstance().featureUsage(i.c.copilotPanel,i.b.guideItemClicked,{item:e.key}),null===(t=Te.current)||void 0===t||t.setGhostText(null!==(a=e.data.ghostText)&&void 0!==a?a:""),null===(n=Te.current)||void 0===n||n.setInputText(e.data.prompt),null===(o=Te.current)||void 0===o||o.setFocus())},[]),we=()=>{var e;return!Object(Y.a)()||(null===(e=Te.current)||void 0===e||e.setInputText(""),!1)},Le=e=>{Pe.current(e,{})},De=e=>{Object(h.a)().dispatch(Object(y.c)(e))},xe=o.a.useRef(void 0);o.a.useEffect(()=>{if(ue&&!xe.current){var e=Ne({type:"copilot",subtype:"custom",messageType:C.ChatMessageType.ContentCard,showChatCardFooter:!1,body:{cardContent:{},renderHeader:()=>o.a.createElement(H.a,{headerString:ee(b.a.CAPABILITIES_WELCOME_MESSAGE,{username:Se})}),renderBody:()=>o.a.createElement(D.a,{chatInputRef:Te})}});xe.current=e}},[ue,ee,Se,Ne]);var Me=function(){var e,t=(e=function*(e,t){var{scenario:a,subScenario:n,telemetryScenario:o}=(e=>{var t,a,n,o=null!=e?e:{};return t=o.telemetryScenario?o.telemetryScenario:I.a.getInstance().createNewScenario(L.c.executePrompt),o.scenario&&o.subScenario?(a=o.scenario,n=o.subScenario):(a=l.d.PowerPagesClassification,n=l.e.Classification),{scenario:a,subScenario:n,telemetryScenario:t}})(t);he.current=M.a.CancelToken.source();var r=J(J({},ke),{},{userInput:e,scenario:a,subScenario:n,scenarioParams:t,axiosCancelToken:he.current.token,telemetryScenario:o,submittedFromPageId:Object(A.a)()});I.a.getInstance().featureUsage(i.c.copilotPanel,i.b.sendChatMessage);var c=yield Object(k.a)(r);return"success"===c.status?I.a.getInstance().featureUsage(i.c.copilotPanel,i.b.executePromptComplete,{scenario:c.scenario,subScenario:c.subScenario}):I.a.getInstance().featureUsage(i.c.copilotPanel,i.b.executePromptFailed),c},function(){var t=this,a=arguments;return new Promise((function(n,o){var r=e.apply(t,a);function c(e){$(r,n,o,c,i,"next",e)}function i(e){$(r,n,o,c,i,"throw",e)}c(void 0)}))});return function(e,a){return t.apply(this,arguments)}}();return o.a.createElement(o.a.Fragment,null,o.a.createElement(j.a,{onRenderFRE:()=>o.a.createElement("div",{style:{display:"flex",flexFlow:"column",alignItems:"center",gap:"3px"}},o.a.createElement(V.a,{src:R.a,"aria-label":ee(b.a.COPILOT_LOGO_ARIA)}),o.a.createElement("div",{style:{fontWeight:600,fontSize:"20px",lineHeight:"28px",margin:"16px 16px 0",padding:0}},i.a)),isPreview:!a,localization:je,successActionOutputCardProps:{onRender:e=>{try{var t,a=null==e?void 0:e.copilotResult,{scenarioResult:n,scenario:o,subScenario:r}=a,{scenarioCardProps:c}=n;return ye.current.has(null==e?void 0:e.id)||(ye.current.add(null==e?void 0:e.id),Ie.current=null==e?void 0:e.id),(null!==(t=n.responseCard)&&void 0!==t?t:B.a)(J(J({},c),{},{handleSubmit:Pe.current,isLastMessage:Ie.current===(null==e?void 0:e.id),userInput:a.userInput,scenario:o,subScenario:r}))}catch(s){var l=new G.a("500.120.000.009","Error rendering success card").from(s);return I.a.getInstance().error(i.b.renderingCardFailed,l.message,l),Object(U.a)({copilotErrorCode:l.code,errorCode:l.code,localizedMessage:Object(z.a)(l),message:l.message,name:l.name,innerError:l.cause,retryable:!l.isUserError,stack:l.stack},Te)}}},failedActionOutputCardProps:{onRender:e=>Object(U.a)(null==e?void 0:e.copilotResult,Te)},responseTimeoutDurationInMs:12e4,onRenderChatInput:e=>(e=>{var t=Object(T.a)(e.isDisabled,ve);return Pe.current=e.handleSubmitButtonClick,Object(h.a)().dispatch(Object(y.g)(!!e.isDisabled)),o.a.createElement(o.a.Fragment,null,o.a.createElement(C.ChatInput,{styles:t,handleSubmitButtonClick:Le,ref:Te,isDisabled:e.isDisabled||oe,isMenuButtonEnabled:!0,maxInputCharLimit:280,contextualMenuHandlerProps:{items:Object(v.a)(ee,de),onItemClick:_e,onRestoreFocus:()=>{var e;null===(e=document.querySelector("#copilot-chat-input button[aria-haspopup=true]"))||void 0===e||e.focus()}},placeholderText:ee(b.a.NL2PAGE_INPUT_PLACEHOLDER),handleOnInput:we}),le&&de&&o.a.createElement(S.a,{isBingSearchConsentEnabled:ce,onConsentUpdate:De}))})(e),utilitySettings:{cesSettings:J({onSendFeedback:Ae},{teamName:"portalsdesigner",surveyName:"powerpageschatgpt"})},executeApiEndPoint:Me,cancelCopilotRequest:()=>{he.current&&(he.current.cancel(F.b.UserCanceled),I.a.getInstance().featureUsage(i.c.copilotPanel,i.b.cancelSendChatMessage))},styles:Re,customFreImageProps:{imagePath:R.a,freTitle:"Copilot",freDescription:[]},featureGates:{stopGeneration:!0,zeroPrompt:se}}))}},41378:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=(e,t)=>({contextualMenu:{background:"transparent"},chatInputContainer:{minHeight:40},chatInput:[{margin:0,border:"1px solid #d1d1d1",background:t.palette.white,transform:"none",cursor:"text"},e?{pointerEvents:"none"}:{}],chatInputButtons:{marginBottom:8,background:"transparent",justifyContent:"space-between"},chatInputLeftButtons:{"> button":{background:"transparent",color:t.palette.themePrimary,":hover":{backgroundColor:t.palette.neutralLight}}},chatInputRightButtons:{"> button":{background:"transparent",color:t.palette.themePrimary,":hover":{background:t.palette.neutralLight}}}})},41379:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(11035),o=a.n(n),r=a(18962),c=a(18969),i=a(12092),l=a(12735),s=a(19607),u=a(16176),p=a(13445),d=a(19545),m=a(20899),b=a(12597),g=a(12600),C=Object(i.db)({guideIcons:{margin:"0 4px"}}),E=(e,t)=>{var a,n,{showCapabilitiesAndHeroPrompts:i}=b.d.getConfig(g.o);return[...(null===(a=c.a.getContextMap())||void 0===a||null===(n=a.portalData)||void 0===n?void 0:n.siteVisibility)===l.g.Public?[]:[{key:"createNewPage",text:"".concat(e(r.a.CREATE_COMPONENT,{componentType:"page",loader:"…"})),iconProps:{},className:m.a,onRenderIcon:()=>o.a.createElement(s.w,{className:C.guideIcons}),data:{prompt:e(r.a.CREATE_COMPONENT,{componentType:"page"})}},{key:"addSection",text:"".concat(e(r.a.CREATE_COMPONENT,{componentType:"section",loader:"…"})),iconProps:{},className:m.a,onRenderIcon:()=>o.a.createElement(s.v,{className:C.guideIcons}),data:{prompt:e(r.a.CREATE_COMPONENT,{componentType:"section"})}}],{key:"addForm",text:"".concat(e(r.a.CREATE_COMPONENT,{componentType:"form",loader:"…"})),iconProps:{},className:m.a,onRenderIcon:()=>o.a.createElement(u.j,{className:C.guideIcons}),data:{prompt:e(r.a.CREATE_COMPONENT,{componentType:"form"})}},{key:"createTheme",text:"".concat(e(r.a.CREATE_COMPONENT,{componentType:"color theme",loader:"…"})),iconProps:{},className:m.a,onRenderIcon:()=>o.a.createElement(p.j,{className:C.guideIcons}),data:{prompt:e(r.a.CREATE_COMPONENT,{componentType:"color theme"})}},...null!=i&&i.ask&&t?[{key:"nl2LearnHowDoI",text:"".concat(e(r.a.HOW_DO_I,{loader:"…"})),iconProps:{},className:m.a,onRenderIcon:()=>o.a.createElement(d.k,{className:C.guideIcons}),data:{prompt:e(r.a.HOW_DO_I)}}]:[]]}},41380:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(11035),o=a.n(n),r=a(12329),c=a(12170),i=a(12092),l=a(41381),s=a.n(l),u=a(41382),p=a(18972),d=a(18962),m=e=>{var t=Object(i.db)({callout:{width:320,padding:"20px 24px"},bingLogo:{height:16,marginRight:5},bingLogoContainer:{alignSelf:"center"},bingSearchStatuslabel:{alignSelf:"center",marginBottom:4}}),[a,l]=Object(n.useState)(),[m,b]=Object(n.useState)(e.isBingSearchConsentEnabled),g=Object(n.useRef)(null);return Object(n.useEffect)(()=>{b(e.isBingSearchConsentEnabled)},[e.isBingSearchConsentEnabled]),o.a.createElement(r.a,{horizontal:!0,tokens:{childrenGap:5}},o.a.createElement(r.a.Item,{align:"center"},o.a.createElement("img",{src:s.a,className:t.bingLogo,"aria-label":Object(p.a)({id:d.a.BING_SEARCH_LOGO})})),o.a.createElement(r.a.Item,{className:t.bingSearchStatuslabel},m?Object(p.a)({id:d.a.BING_SEARCH_SETTINGS_STATUS_ENABLED}):Object(p.a)({id:d.a.BING_SEARCH_SETTINGS_STATUS_DISABLED})),o.a.createElement(r.a.Item,null,o.a.createElement("span",{ref:g},o.a.createElement(c.a,{iconProps:{iconName:"Settings"},onClick:()=>{l(!a)},"aria-label":"Opens Bing settings"})),a?o.a.createElement(u.a,{isBingSearchConsentEnabled:e.isBingSearchConsentEnabled,target:g.current,onDismiss:()=>{l(!1)},onConsentUpdate:t=>{var a;b(t),null===(a=e.onConsentUpdate)||void 0===a||a.call(e,!m)}}):o.a.createElement(o.a.Fragment,null)))}},41381:function(e,t,a){e.exports=a.p+"static/media/bingLogo.19105e76.svg"},41382:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(11035),o=a.n(n),r=a(12261),c=a(12329),i=a(16706),l=a(12092),s=a(41381),u=a.n(s),p=a(12089),d=a(18954),m=a(20854),b=a(18972),g=a(18962),C=e=>{var t=Object(l.db)({callout:{width:320,padding:"20px 24px"},bingLogo:{height:32},bingSettingsHeader:{fontSize:20},bingToggle:{alignSelf:"end",marginBottom:5}}),[a,{toggle:n}]=Object(p.a)(e.isBingSearchConsentEnabled);return o.a.createElement(r.a,{ariaLabel:Object(b.a)({id:g.a.BING_SEARCH_SETTINGS_HEADER}),role:"dialog",className:t.callout,gapSpace:0,target:e.target,onDismiss:e.onDismiss,setInitialFocus:!0},o.a.createElement(c.a,{tokens:{childrenGap:10}},o.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:10}},o.a.createElement("img",{src:u.a,className:t.bingLogo,"aria-label":Object(b.a)({id:g.a.BING_SEARCH_LOGO})}),o.a.createElement(c.a.Item,{grow:2,className:t.bingSettingsHeader},Object(b.a)({id:g.a.BING_SEARCH_SETTINGS_HEADER})),o.a.createElement(i.a,{onChange:()=>{var t;d.a.getInstance().featureUsage(m.c.copilotPanel,m.b.bingConsentToggle,{consentEnabled:!a}),null===(t=e.onConsentUpdate)||void 0===t||t.call(e,!a),n()},className:t.bingToggle,checked:a,ariaLabel:Object(b.a)({id:g.a.BING_SEARCH_TOGGLE})})),o.a.createElement(c.a.Item,null,Object(b.a)({id:g.a.BING_SEARCH_SETTINGS_CONTENT}))))}},41383:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(11035),o=a.n(n),r=a(24411),c=a(15227),i=a(41384),l=a(41390),s=a(15226),u=a(41393),p=e=>{var{isPreview:t=!1,utilitySettings:a,successActionOutputCardProps:p,failedActionOutputCardProps:d,responseTimeoutDurationInMs:m,localization:b,onRenderChatInput:g,onRenderFRE:C,executeApiEndPoint:E,cancelCopilotRequest:h,featureGates:O,customFreImageProps:f,localization:{pane:T,common:v}}=e,y=Object(r.c)(),P=Object(r.d)(),I=Object(r.h)(),S=Object(n.useRef)(P);return Object(n.useEffect)(()=>{c.a.devChatUI,0},[I]),Object(n.useEffect)(()=>{a.cesSettings.teamName!==s.a.teamName&&Object(s.m)(a.cesSettings)},[a.cesSettings]),y&&(S.current||P)?(S.current||(S.current=!0),o.a.createElement(i.a,{isOpen:P,closeLabel:v.close,previewLabel:T.previewLabel,titleLabel:T.title,isPreview:t,onDismiss:()=>I(!1),className:e.className,headerClassName:e.headerClassName,paneSize:e.paneSize,styles:e.styles,theme:e.theme},o.a.createElement(l.a,{localization:b},o.a.createElement(u.a,{responseTimeoutDurationInMs:m,successActionOutputCardProps:p,failedActionOutputCardProps:d,cesSettings:a.cesSettings,localization:b,onRenderChatInput:g,onRenderFRE:C,featureGates:O,executeApiEndPoint:E,customFreImageProps:f,cancelCopilotRequest:h})))):null}},41393:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(11035),o=a.n(n),r=a(11056),c=a(24413);function i(e,t,a,n,o,r,c){try{var i=e[r](c),l=i.value}catch(s){return void a(s)}i.done?t(l):Promise.resolve(l).then(n,o)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var r=e.apply(t,a);function c(e){i(r,n,o,c,l,"next",e)}function l(e){i(r,n,o,c,l,"throw",e)}c(void 0)}))}}var s=Object(r.a)(l((function*(){var[e]=yield Promise.all([Promise.all([a.e(310),a.e(319),a.e(2712),a.e(2711),a.e(2646),a.e(2645)]).then(a.bind(null,46544))]);return e.CopilotChat})),{fallback:o.a.createElement(c.a,{loadingText:"…"})})},41394:function(e,t,a){"use strict";a.d(t,"a",(function(){return R}));var n=a(11035),o=a.n(n),r=a(41395),c=a(12600),i=a(15108),l=a(19607),s=a(16177),u=a(19545),p=a(18962),d=a(19606),m=a.n(d),b=a(12705),g=a(21793),C=a(21794),E=a(11203),h=a(20854),O=a(18954),f=a(15216),T=a(21757),v=a(12092),y=a(41397),P=a(41398),I=a(41400),S=a(41401),N=a(20106),R=e=>{var t=Object(N.a)(),{enableCopilotCapabilities:a,showCapabilitiesAndHeroPrompts:d}=Object(c.jc)(),{t:R}=Object(E.s)(h.e),j=Object(b.a)(),{enableBingChat:k}=Object(i.a)(),A=Object(n.useMemo)(()=>Object(v.db)({heroPromptTitle:{fontWeight:v.l.regular},capabilitiesDescription:{color:j.palette.neutralTertiary},examplesListContainer:{paddingLeft:"20px"},dashStyle:{marginRight:"4px"},examplesStyle:{color:j.palette.neutralPrimary,margin:"0 4px 8px 4px"}}),[j]),_=Object(g.b)(),w=Object(n.useCallback)(t=>{var{current:a}=e.chatInputRef;a&&(a.setInputText(t),a.setGhostText(""),a.setFocus())},[e.chatInputRef]),L=Object(n.useCallback)((e,t)=>o.a.createElement("span",{className:m()(A.heroPromptTitle)},R(e,t)),[A,R]),D=Object(n.useCallback)(e=>o.a.createElement(o.a.Fragment,null,o.a.createElement("p",{className:m()(A.examplesStyle)},R(p.a.FIXED_CAPABILITY_EXAMPLE_RESPONSE_TITLE)," ",o.a.createElement("br",null)),o.a.createElement(r.a,{starterPromptData:e})),[A.examplesStyle,R]),x=Object(n.useCallback)(e=>({type:"copilot",messageType:C.ChatMessageType.ContentCard,showChatCardFooter:!1,body:{cardContent:{},renderHeader:()=>o.a.createElement(y.a,{headerString:e.contentHeader}),renderBody:()=>{var t;return null!==(t=e.contentBody)&&void 0!==t?t:o.a.createElement(r.a,{starterPromptData:e.getPromptData()})}}}),[]),M=e=>{O.a.getInstance().featureUsage(h.c.copilotPanel,T.a.copilotCapabilityClicked,e)},F=Object(n.useCallback)(()=>a?[{icon:o.a.createElement(l.v,{primaryFill:j.palette.themePrimary}),title:R(p.a.PAGE_DESIGN),description:o.a.createElement("div",null,o.a.createElement("span",{className:m()(A.capabilitiesDescription)},R(p.a.PAGE_DESIGN_DESCRIPTION))),handlePromptClick:()=>{_(x({contentHeader:R(p.a.FIXED_COPILOT_RESPONSE,{with_capability:"with page design"}),getPromptData:()=>Object(P.a)({enableCopilotGA:t,addChatLogItem:_,logCapabilitiesTelemetry:M,getChatLogItem:x,showListOfExamples:D,onRenderHeroPromptTitle:L,changeInputTextDynamically:w,t:R})}));var e={scenario:f.d.NL2Page};M(e)}},{icon:o.a.createElement(s.i,{primaryFill:j.palette.themePrimary}),title:R(p.a.DATA_FORMS),description:o.a.createElement("span",{className:m()(A.capabilitiesDescription)},R(p.a.DATA_FORMS_DESCRIPTION)),handlePromptClick:()=>{_(x({contentHeader:R(p.a.FIXED_COPILOT_RESPONSE_SINGULAR,{with_capability:"with data forms"}),getPromptData:()=>Object(I.a)({enableCopilotGA:t,addChatLogItem:_,logCapabilitiesTelemetry:M,getChatLogItem:x,showListOfExamples:D,onRenderHeroPromptTitle:L,changeInputTextDynamically:w,t:R})}));var e={scenario:f.d.NL2Form};M(e)}},...null!=d&&d.ask&&k?[{icon:o.a.createElement(u.k,{primaryFill:j.palette.themePrimary}),title:R(p.a.ASK),description:o.a.createElement("span",{className:m()(A.capabilitiesDescription)},R(p.a.ASK_DESCRIPTION)),handlePromptClick:()=>{_(x({contentHeader:R(p.a.FIXED_NL2LEARN_COPILOT_RESPONSE),getPromptData:()=>Object(S.a)({enableCopilotGA:t,addChatLogItem:_,logCapabilitiesTelemetry:M,getChatLogItem:x,showListOfExamples:D,onRenderHeroPromptTitle:L,changeInputTextDynamically:w,t:R})}));var e={scenario:f.d.NL2Learn};M(e)}}]:[]]:[],[a,j.palette.themePrimary,R,A.capabilitiesDescription,null==d?void 0:d.ask,_,x,D,L,w,k,t]);return o.a.createElement(r.a,{starterPromptData:F()})}},41397:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(11035),o=a.n(n),r=a(12092),c=a(12705),i=a(19606),l=a.n(i),s=e=>{var{headerString:t}=e,a=Object(c.a)(),n=o.a.useMemo(()=>Object(r.db)({cardDataStyle:{color:a.palette.neutralPrimary,margin:"8px 0 8px 4px"}}),[a.palette.neutralPrimary]);return o.a.createElement("div",{className:l()(n.cardDataStyle)},t)}},41398:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(11035),o=a.n(n),r=a(19545),c=a(13445),i=a(19983),l=a(16177),s=a(11703),u=a(41399),p=a.n(u),d=a(18962),m=a(15216),b=a(12597),g=a(12600),C=e=>{var{isWordToPageEnabled:t}=b.d.getConfig(g.Zb),{enableCopilotGA:a,onRenderHeroPromptTitle:n,changeInputTextDynamically:i,logCapabilitiesTelemetry:l,t:s}=e,u={scenario:m.d.NL2Page,subScenario:m.e.GenerateNewPage};return[{icon:o.a.createElement(r.f,null),title:n(d.a.CREATE_COMPONENT,{componentType:"page",purpose:"for frequently asked questions"}),handlePromptClick:()=>{u.prompt="Create a page for frequently asked questions",l(u),i(s(d.a.CREATE_COMPONENT,{componentType:"page",purpose:"for frequently asked questions"}))}},...t?[{badgeLabel:a?s(d.a.PREVIEW).toLocaleUpperCase():void 0,icon:o.a.createElement("img",{src:p.a,alt:"M365Logo","aria-hidden":"true"}),title:n(d.a.CREATE_FAQ_PAGE_FROM_FILE,{url:"https://word.docx"}),handlePromptClick:()=>{u.scenario=m.d.File2Faq,u.subScenario=m.e.GenerateFaqFromFile,u.prompt="Create an FAQ page from this Word doc:",l(u),i(s(d.a.CREATE_FAQ_PAGE_FROM_FILE))}}]:[],{icon:o.a.createElement(c.z,null),title:n(d.a.CREATE_COMPONENT,{componentType:"page",purpose:"about how to contact customer support"}),handlePromptClick:()=>{u.prompt="Create a page about how to contact customer support",l(u),i(s(d.a.CREATE_COMPONENT,{componentType:"page",purpose:"about how to contact customer support"}))}},{icon:o.a.createElement(c.u,null),title:n(d.a.CREATE_COMPONENT,{componentType:"page",purpose:"to share our company background"}),handlePromptClick:()=>{u.prompt="Create a page to share our company background",l(u),i(s(d.a.CREATE_COMPONENT,{componentType:"page",purpose:"to share our company background"}))}}]},E=e=>{var{onRenderHeroPromptTitle:t,changeInputTextDynamically:a,logCapabilitiesTelemetry:n,t:r}=e,s={scenario:m.d.NL2Page,subScenario:m.e.GenerateNewTheme};return[{icon:o.a.createElement(l.c,null),title:t(d.a.CREATE_COMPONENT,{componentType:"color theme",purpose:"using blue colors for my software company"}),handlePromptClick:()=>{s.prompt="Create a color theme using blue colors for my software company",n(s),a(r(d.a.CREATE_COMPONENT,{componentType:"color theme",purpose:"using blue colors for my software company"}))}},{icon:o.a.createElement(i.j,null),title:t(d.a.CREATE_COMPONENT,{componentType:"color theme",purpose:"with summer colors"}),handlePromptClick:()=>{s.prompt="Create a color theme with summer colors",n(s),a(r(d.a.CREATE_COMPONENT,{componentType:"color theme",purpose:"with summer colors"}))}},{icon:o.a.createElement(c.j,null),title:t(d.a.CREATE_COMPONENT,{componentType:"color theme",purpose:"that's neutral​"}),handlePromptClick:()=>{s.prompt="Create a color theme that's neutral",n(s),a(r(d.a.CREATE_COMPONENT,{componentType:"color theme",purpose:"that's neutral​"}))}}]},h=e=>{var{enableCopilotGA:t,addChatLogItem:a,getChatLogItem:n,logCapabilitiesTelemetry:l,onRenderHeroPromptTitle:u,changeInputTextDynamically:p,showListOfExamples:b,t:g}=e;return[{icon:o.a.createElement(s.s,null),title:u(d.a.CREATE_COMPONENT,{componentType:"page"}),handlePromptClick:()=>{p(g(d.a.CREATE_COMPONENT,{componentType:"page"})),a(n({contentHeader:g(d.a.FIXED_CAPABILITY_CLARIFICATION_RESPONSE,{component:"page"}),contentBody:o.a.createElement(o.a.Fragment,null,b(C(e)))}));var t={scenario:m.d.NL2Page,subScenario:m.e.GenerateNewPage};l(t)}},{icon:o.a.createElement(c.n,null),title:u(d.a.CREATE_COMPONENT,{componentType:"section"}),handlePromptClick:()=>{var e=(e=>{var{onRenderHeroPromptTitle:t,changeInputTextDynamically:a,logCapabilitiesTelemetry:n,t:l}=e,s={scenario:m.d.NL2Page,subScenario:m.e.AddSection};return[{icon:o.a.createElement(c.z,null),title:t(d.a.CREATE_COMPONENT,{componentType:"section",purpose:"about how to contact customer support"}),handlePromptClick:()=>{s.prompt="Create a section about how to contact customer support",n(s),a(l(d.a.CREATE_COMPONENT,{componentType:"section",purpose:"about how to contact customer support"}))}},{icon:o.a.createElement(r.i,null),title:t(d.a.CREATE_COMPONENT,{componentType:"section",purpose:"to highlight products and services"}),handlePromptClick:()=>{s.prompt="Create a section to highlight products and services",n(s),a(l(d.a.CREATE_COMPONENT,{componentType:"section",purpose:"to highlight products and services"}))}},{icon:o.a.createElement(i.a,null),title:t(d.a.CREATE_COMPONENT,{componentType:"section",purpose:"for customer testimonials"}),handlePromptClick:()=>{s.prompt="Create a section for customer testimonials",n(s),a(l(d.a.CREATE_COMPONENT,{componentType:"section",purpose:"for customer testimonials"}))}}]})({enableCopilotGA:t,onRenderHeroPromptTitle:u,changeInputTextDynamically:p,logCapabilitiesTelemetry:l,t:g});p(g(d.a.CREATE_COMPONENT,{componentType:"section"}));var s=n({contentHeader:g(d.a.FIXED_CAPABILITY_CLARIFICATION_RESPONSE,{component:"section"}),contentBody:o.a.createElement(o.a.Fragment,null,b(e))});a(s);var C={scenario:m.d.NL2Page,subScenario:m.e.AddSection};l(C)}},{icon:o.a.createElement(c.j,null),title:u(d.a.CREATE_COMPONENT,{componentType:"color theme"}),handlePromptClick:()=>{p(g(d.a.CREATE_COMPONENT,{componentType:"color theme"}));var t=n({contentHeader:g(d.a.FIXED_FORM_THEME_CLARIFICATION_RESPONSE,{component:"color theme"}),contentBody:o.a.createElement(o.a.Fragment,null,b(E(e)))});a(t);var r={scenario:m.d.NL2Page,subScenario:m.e.GenerateNewTheme};l(r)}}]}},41399:function(e,t,a){e.exports=a.p+"static/media/M365Logo.a5857f77.svg"},41400:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(11035),o=a.n(n),r=a(13365),c=a(13445),i=a(19983),l=a(16176),s=a(18962),u=a(15216),p=a(12600),d=a(12597),m=e=>{var{enableCopilotGA:t,addChatLogItem:a,getChatLogItem:n,logCapabilitiesTelemetry:m,showListOfExamples:b,onRenderHeroPromptTitle:g,changeInputTextDynamically:C,t:E}=e,{enableOverrideNL2Form:h}=d.d.getConfig(p.lb),O=(e=>{var{onRenderHeroPromptTitle:t,changeInputTextDynamically:a,logCapabilitiesTelemetry:n,t:l}=e,{enableOverrideNL2Form:m}=d.d.getConfig(p.lb),b={scenario:m?u.d.NL2WebForm:u.d.NL2Form,subScenario:u.e.GenerateNewForm};return[{icon:o.a.createElement(r.a,null),title:t(s.a.CREATE_COMPONENT,{componentType:"form",purpose:"for students to register for university courses"}),handlePromptClick:()=>{b.prompt="Create a form for students to register for university courses",n(b),a(l(s.a.CREATE_COMPONENT,{componentType:"form",purpose:"for students to register for university courses"}))}},{icon:o.a.createElement(c.z,null),title:t(s.a.CREATE_COMPONENT,{componentType:"form",purpose:"for customers to create support tickets​"}),handlePromptClick:()=>{b.prompt="Create a form for customers to create support tickets",n(b),a(l(s.a.CREATE_COMPONENT,{componentType:"form",purpose:"for customers to create support tickets​"}))}},{icon:o.a.createElement(i.d,null),title:t(s.a.CREATE_COMPONENT,{componentType:"form",purpose:"to apply for a credit card"}),handlePromptClick:()=>{b.prompt="Create a form to apply for a credit card",n(b),a(l(s.a.CREATE_COMPONENT,{componentType:"form",purpose:"to apply for a credit card"}))}}]})({enableCopilotGA:t,onRenderHeroPromptTitle:g,changeInputTextDynamically:C,logCapabilitiesTelemetry:m,t:E});return[{badgeLabel:!t||h?E(s.a.PREVIEW).toUpperCase():void 0,icon:o.a.createElement(l.j,null),title:g(s.a.CREATE_COMPONENT,{componentType:"form"}),handlePromptClick:()=>{C(E(s.a.CREATE_COMPONENT,{componentType:"form"}));var e=n({contentHeader:E(s.a.FIXED_FORM_THEME_CLARIFICATION_RESPONSE,{component:"form"}),contentBody:o.a.createElement(o.a.Fragment,null,b(O))});a(e);var t={scenario:u.d.NL2Form,subScenario:u.e.GenerateNewForm};m(t)}}]}},41401:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(11035),o=a.n(n),r=a(13445),c=a(16176),i=a(14846),l=a(18962),s=a(15216),u=e=>{var{onRenderHeroPromptTitle:t,changeInputTextDynamically:a,t:n,logCapabilitiesTelemetry:u}=e,p={scenario:s.d.NL2Learn,subScenario:s.e.AskQuestion};return[{icon:o.a.createElement(r.t,null),title:t(l.a.RESTRICT_SITE),handlePromptClick:()=>{a(n(l.a.RESTRICT_SITE)),p.prompt="Can I restrict access to my site?",u(p)}},{icon:o.a.createElement(c.l,null),title:t(l.a.MULTIPLE_LANGUAGE_SUPPORT),handlePromptClick:()=>{a(n(l.a.MULTIPLE_LANGUAGE_SUPPORT)),p.prompt="How do I enable multiple language support on my site?",u(p)}},{icon:o.a.createElement(i.e,null),title:t(l.a.EDIT_CODE_ON_PORTAL),handlePromptClick:()=>{a(n(l.a.EDIT_CODE_ON_PORTAL)),p.prompt="Where can I edit the code of my site?",u(p)}}]}},41402:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(11035),o=a.n(n),r=a(12705),c=a(12281),i=a(12329),l=a(12707),s=a(13445),u=a(11203),p=a(21757),d=a(18962),m=a(11382),b=a(13217),g=a(21765),C=a(41394),E=a(12597),h=a(12600),O=a(21781),f=a(41403),T=a(21776),v=(e,t)=>{var a,n,{t:v}=Object(u.s)(p.f),y=Object(m.i)(),P=Object(m.l)(b.a.home),I=Object(r.a)(),S=Object(g.b)(I),{isSecurityWorkspaceSiteVisibilityEnabled:N}=E.d.getConfig(h.Fb);switch(e.copilotErrorCode){case"400.902.000.001":case"502.120.004.003":case"502.120.004.004":case"502.120.004.010":case"502.120.004.011":case"502.120.004.014":case"400.120.004.015":case"502.902.000.008":case"500.902.002.003":a=o.a.createElement(C.a,{chatInputRef:t});break;default:a=null}return o.a.createElement("div",{style:{width:"100%"}},o.a.createElement(l.a,{className:S.label},e.localizedMessage),o.a.createElement(i.a,{horizontal:!0,className:S.buttonsRow},o.a.createElement(o.a.Fragment,null,e.copilotErrorCode===p.e.blockedInPublicSiteError&&o.a.createElement(c.a,{onClick:()=>{y.push(N?"".concat(null==P?void 0:P.url).concat(b.a.security).concat(b.a.securitySiteVisibility):"".concat(null==P?void 0:P.url).concat(b.a.setup).concat(b.a.setupSiteVisibility))},className:"noLabelWhenNotFirst",styles:g.a,"aria-label":v(d.a.MANAGE_SITE_VISIBILITY)},o.a.createElement(s.a,null),(n=d.a.MANAGE_SITE_VISIBILITY,o.a.createElement("span",{className:"actionLabel"},v(n)))),e.message===T.c.PVABotDocumentsNotFoundMessageInResponse&&o.a.createElement(O.a,null),e.message===T.c.NL2LearnBingNotSupported&&o.a.createElement(f.a,null))),a)}},41403:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(11035),o=a.n(n),r=a(12281),c=a(13445),i=a(18962),l=a(12734),s=a(11204),u=a(21757),p=a(21776),d={root:{height:32,fontSize:12,fontWeight:400,padding:"0px 4px",borderRadius:4,border:"1px solid #E0E0E0",lineHeight:16,color:"#242424",minWidth:0,"span.actionLabel":{margin:"0 5px"}},icon:{color:"#242424",fontSize:12}},m=e=>{var{t:t}=Object(s.f)("PowerPortals"),a=e.buttonStyles||d;return o.a.createElement(r.a,{styles:a,onClick:()=>{l.a.getInstance().featureUsage(u.b.copilotPanel,p.d.openLearnDocButtonClick,{}),window.open(p.b,"_blank")}},o.a.createElement(c.a,null),o.a.createElement("span",{className:"actionLabel"},t(i.a.NL2LEARN_RESPONSE_OPEN_LEARN_LINK)))}},41404:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(11819),o=a(21747),r=a(15218),c=a(18954),i=a(18960),l=a(15216),s=a(11035);function u(e,t,a,n,o,r,c){try{var i=e[r](c),l=i.value}catch(s){return void a(s)}i.done?t(l):Promise.resolve(l).then(n,o)}var p=e=>{var t,{oid:a,tid:p}=Object(n.o)(),d=Object(o.a)(),m=null!==(t=null==d?void 0:d.location)&&void 0!==t?t:"unknown";return{onSendFeedback:Object(s.useCallback)(function(){var t,n=(t=function*(t,n,o){var s,u,d=null==o?void 0:o.copilotResponse,b=null!==(s=null==d?void 0:d.scenario)&&void 0!==s?s:l.d.Unclassified,g=null!==(u=null==d?void 0:d.subScenario)&&void 0!==u?u:l.e.Unclassified,C="positive"===t,E=Date.now();c.a.getInstance().featureUsage(i.m,C?r.b.LikedMessage:r.b.DislikedMessage,{type:C?r.a.ThumbsUp:r.a.ThumbsDown,timeSent:E,scenario:b,subScenario:g,sessionId:e}),yield Object(r.c)(t,b,m,a,p,e,n,g)},function(){var e=this,a=arguments;return new Promise((function(n,o){var r=t.apply(e,a);function c(e){u(r,n,o,c,i,"next",e)}function i(e){u(r,n,o,c,i,"throw",e)}c(void 0)}))});return function(e,t,a){return n.apply(this,arguments)}}(),[m,a,p,e])}}},46544:function(e,t,a){"use strict";a.r(t),a.d(t,"CopilotChat",(function(){return w}));var n=a(11035),o=a.n(n),r=a(12061),c=a(12329),i=a(13174),l=a(21794),s=a(11215),u=a(21793),p=a(43001),d=a(46545),m=a(24422),b=a(15226),g=a(43008),C=a(15078),E=a(21751),h=a(45909),O=a(46546),f=a(45955),T=a(46547),v=a(11205),y=a(15225),P=a(15216),I=a(46548),S=a(19487),N=a(16432),R=a(46549),j=a(46550);function k(e,t,a,n,o,r,c){try{var i=e[r](c),l=i.value}catch(s){return void a(s)}i.done?t(l):Promise.resolve(l).then(n,o)}function A(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var r=e.apply(t,a);function c(e){k(r,n,o,c,i,"next",e)}function i(e){k(r,n,o,c,i,"throw",e)}c(void 0)}))}}var _=Object(r.a)(),w=e=>{var t,a,{successActionOutputCardProps:r,failedActionOutputCardProps:k,localization:w,cesSettings:L,executeApiEndPoint:D,onRenderChatInput:x,onRenderFRE:M,customFreImageProps:F,cancelCopilotRequest:G}=e,[B,U]=o.a.useState(!1),[H,z]=o.a.useState(!1),W=Object(u.d)(),q=Object(u.b)(),X=Object(p.b)(B,e.styles),V=Object(d.a)(e.styles),Y=_(X),K=_(V),Q=Y.subComponentStyles,J=K.subComponentStyles,Z=Object(n.useRef)(null),$=Object(N.f)(e=>e.app.copilotAnswer),ee=Object(N.e)(),[te,ae]=o.a.useState(void 0),{setIsFREEnabled:ne,FREElement:oe}=Object(j.a)({onRenderFRE:M,localization:w,fREStyle:J.fre,customFreImageProps:F}),re=Object(n.useRef)(null),ce=Object(n.useCallback)(()=>{var e;W.length>0&&(null===(e=re.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"}))},[W.length]);Object(n.useEffect)(()=>{ce()},[W,ce]),Object(n.useEffect)(()=>()=>{Z.current=null,U(!1)},[]),Object(n.useEffect)(()=>{W.length>1&&ne(!1)},[W.length,ne]);var ie=Object(n.useCallback)((e,t,a)=>{var n,r=Object(s.a)();return{diagnosticData:a,type:"copilot",body:{user:"chat",cardContent:{},renderHeader:()=>o.a.createElement(R.a,{outputCardProps:e,copilotResult:t,id:r})},feedbackData:{feedbackArea:"SuccessActionOutputCard",contextData:{prompt:null==a?void 0:a.userMessage,promptId:null==a?void 0:a.originalPromptId},copilotResponse:t,diagnosticData:a},showChatCardFooter:null===(n=null==e?void 0:e.showChatCardFooter)||void 0===n||n,shouldShowAIGeneratedIndicator:!1,messageType:l.ChatMessageType.ContentCard,actionButtonsBarType:l.ActionButtonsBarType.None,id:r}},[]),le=Object(n.useCallback)((e,t,a)=>({diagnosticData:a,type:"copilot",body:{user:"chat",cardContent:{},renderHeader:()=>o.a.createElement(I.a,{outputCardProps:e,copilotResult:t})},feedbackData:{feedbackArea:"FailedActionOutputCard",contextData:{prompt:null==a?void 0:a.userMessage,promptId:null==a?void 0:a.originalPromptId},copilotResponse:t,diagnosticData:a},showChatCardFooter:!0,messageType:l.ChatMessageType.ContentCard,actionButtonsBarType:l.ActionButtonsBarType.None,shouldShowAIGeneratedIndicator:!1,showAnimation:!1}),[]),se=o.a.useMemo(()=>{var e="";"failure"===(null==te?void 0:te.status)&&null!=te&&te.error&&(e=te.error.localizedMessage);return{rawResponse:e,userMessage:null==te?void 0:te.userInput}},[te]),ue=Object(n.useCallback)(function(){var e=A((function*(e,t){var a,n;if(e){var o=Object(s.a)();ne(!1),U(!0),z(!1),Z.current={operationId:o,userMessage:e};var c=t,i=c&&c.userCardMessage?c.userCardMessage:e,u=null!==(a=c.hideUserMessage)&&void 0!==a&&a,p={type:"copilot",body:{user:"human",message:i},messageType:l.ChatMessageType.Default,feedbackData:{feedbackArea:"userMessage",contextData:{prompt:e,promptId:"xus"}}};u||q(p),U(!0);var d=yield D(e,t);if(ae(d),null!==(n=Z.current)&&void 0!==n&&n.operationId)if("success"===d.status){var m={rawResponse:d.scenarioResult.scenarioCardProps.cardMessage,userMessage:d.userInput};U(!1),q(ie(r,d,m)),Z.current=null}else"failure"===d.status&&(U(!1),z(!0),Z.current=null,q(le(k,d.error,se)))}}));return function(t,a){return e.apply(this,arguments)}}(),[ne,q,D,ie,r,le,k,se]);Object(n.useEffect)(()=>{var e,t;$&&"success"===(null==te?void 0:te.status)&&(null==te?void 0:te.scenario)===P.d.NL2Form&&(q(ie(r,{status:"success",scenario:te.scenario,subScenario:te.subScenario,scenarioResult:{scenarioCardProps:{cardMessage:$}},userInput:null!==(e=null===(t=Z.current)||void 0===t?void 0:t.userMessage)&&void 0!==e?e:""})),ee(Object(S.b)("")))},[q,$,te,ie,ee,r]);var pe=Object(n.useCallback)(function(){var e=A((function*(e,t){var a,n,o=Object(v.F)(b.c,m.a.ShortcutAction,{actionType:e});try{if(e===f.c.SubmitFeedback)n=w.writtenFeedbackDialog.thanksText,a={type:"copilot",diagnosticData:{userMessage:t,rawResponse:"handleShortcutAction_SubmitFeedback",originalPromptId:"SubmitFeedbackAction",copilotResponse:te},body:{user:"chat",message:n},showChatCardFooter:!1,messageType:l.ChatMessageType.Default,showAnimation:!1},Z.current=null,q(Object(T.b)(a,n)),U(!1),o.complete();else if(e!==f.c.Undo&&e!==f.c.Redo){var r=e;throw Object(h.c)(new Error("Unsupported shortcut action type ".concat(r)),h.a.UnsuportedShortcutAction,w.errorMessages.genericApiError)}}catch(g){var c,i,s,u,p=Object(h.f)(g)?g:Object(h.c)(g,h.a.HandleShortcutActionFailed,w.errorMessages.genericApiError,!1),d={userMessage:null!==(c=null===(i=Z.current)||void 0===i?void 0:i.userMessage)&&void 0!==c?c:"Unknown-Augloop-Studio",rawResponse:'{actionType: "'.concat(e,'"}'),error:p,originalPromptId:null!==(s=null===(u=Z.current)||void 0===u?void 0:u.operationId)&&void 0!==s?s:"handleShortcutAction"};q(le(k,p,d)),U(!1),o.failure(Object(h.b)(p))}}));return function(t,a){return e.apply(this,arguments)}}(),[q,te,le,k,w.errorMessages.genericApiError,w.writtenFeedbackDialog.thanksText]),{handleChatCardThumbsDownClick:de,handleChatCardThumbsUpClick:me,onDismissCallout:be,onSubmitFeedback:ge,shouldShowCallout:Ce,textInputRef:Ee,calloutType:he}=Object(O.a)({handleActionSubmit:pe,cesSettings:L}),Oe=o.a.useCallback(A((function*(){ue(w.chat.undoRequestMessage,{}),Object(v.O)(b.c,{eventName:m.b.UndoClicked})})),[ue,w]);return o.a.createElement(c.a,{className:Y.wrapper},o.a.createElement(c.a.Item,{className:Y.root},o.a.createElement("div",{className:Y.logContainer},oe,o.a.createElement(l.ChatContainer,{chatLog:W,handleUndoButtonOnClick:Oe,handleChatCardThumbsUpClick:me,handleChatCardThumbsDownClick:de},o.a.createElement("div",{ref:re}))),o.a.createElement(c.a,{className:Y.inputContainer,tokens:{childrenGap:12}},B&&o.a.createElement(l.LoadingUi,{styles:null===(t=Q.loadingUI)||void 0===t?void 0:t.call(Q,{}),loadingUiStrings:[w.chat.processingRequest]}),B&&(null===(a=e.featureGates)||void 0===a?void 0:a.stopGeneration)&&o.a.createElement(c.a,{className:Y.stopGeneratingButtonContainer},o.a.createElement(i.a,{onRenderIcon:()=>o.a.createElement(g.e,null),"aria-label":w.chat.stopGenerating,"aria-live":"assertive",role:"button",className:Y.stopGeneratingButton,onClick:G,disabled:H},w.chat.stopGenerating)),x({isDisabled:B,handleSubmitButtonClick:ue}))),o.a.createElement(E.a,{disclaimerLink:C.a.CopilotDisclaimer,disclaimerText:w.chat.disclaimerNotice_format,seeTermsText:w.chat.readPreviewTermsText}),o.a.createElement(y.a,{localization:w,hidden:!Ce,onDismiss:be,calloutType:he,onSubmit:ge,onButtonDismiss:be,textInputRef:Ee}))}},46545:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(12092),o=e=>{var t=Object(n.Y)();return Object(n.db)({subComponentStyles:{fre:{freHeaderText:{fontWeight:"600",fontSize:"20px",lineHeight:"28px",background:t.palette.black,margin:"16px 16px 0",padding:0,display:"flex",justifyContent:"center"},freDescriptionText:{fontSize:"16px",lineHeight:"22px",color:"#424242",margin:"24px 16px 0",padding:0},freUi:{backgroundColor:t.palette.neutralLighter,marginBottom:4},freCard:{backgroundColor:t.palette.neutralLighter,border:"none",boxShadow:"none",color:t.palette.black,margin:"0 16px","> div":{padding:0}},freFooter:{display:"none"},freIllustration:{"> img":{backgroundColor:"transparent",padding:0}}}}},e)}},46546:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(11819),o=a(11205),r=a(11035),c=a.n(r),i=a(43007),l=a(24422),s=a(15226),u=a(21747),p=a(45955),d=e=>{var t,{handleActionSubmit:a,cesSettings:r}=e,{oid:d,tid:m}=Object(n.o)(),b=Object(u.a)(),g=null!==(t=null==b?void 0:b.location)&&void 0!==t?t:"unknown",[C,E]=c.a.useState(void 0),[h,O]=c.a.useState(!1),f=c.a.useRef(null),T=c.a.useRef(void 0),v=c.a.useCallback(()=>{O(!1)},[]),y=c.a.useCallback(e=>{var t,n,c,u,b=(null===(t=f.current)||void 0===t?void 0:t.value)||"";e&&(b+=" - User provided message - ".concat(null!==(n=null===(c=T.current)||void 0===c||null===(u=c.contextData)||void 0===u?void 0:u.prompt)&&void 0!==n?n:""));r.onSendFeedback?r.onSendFeedback(C,b,T.current):Object(i.a)(C,g,d,m,r,b),O(!1),Object(o.X)(s.c,l.b.SubmitClicked,{includeUsersMessage:e,calloutType:C}),a(p.c.SubmitFeedback,b)},[C,g,d,m,r,a]);return{handleChatCardThumbsUpClick:c.a.useCallback(e=>{T.current=e,O(!0),Object(o.X)(s.c,l.b.ThumbsUpClicked),E("positive")},[]),handleChatCardThumbsDownClick:c.a.useCallback(e=>{T.current=e,O(!0),Object(o.X)(s.c,l.b.ThumbsDownClicked),E("negative")},[]),onDismissCallout:v,onSubmitFeedback:y,shouldShowCallout:h,textInputRef:f,calloutType:C}}},46547:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(11035),o=a.n(n),r=a(45962),c=a(45966),i=a(45958),l=a(45967),s=a(15227);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m=e=>{var{chatLogItem:t,feedbackExtensions:a,localization:n}=e,{onThumbsUpClickedCallback:u,onThumbsDownClickedCallback:p}=Object(c.a)({chatLogItem:t,onThumbsUpClickedExtension:null==a?void 0:a.onThumbsUpClicked,onThumbsDownClickedExtension:null==a?void 0:a.onThumbsDownClicked});return o.a.createElement(i.a,{messageType:"copilot",header:o.a.createElement("span",null,t.message),diagnostic:s.a.showAugloopDebugInfo?o.a.createElement(l.a,{diagnosticData:t.diagnosticData,showDiagnosticLabel:n.actionCard.showDiagnostic||"",dialogTitleLabel:n.actionCard.diagnosticInfo||"",closeLabel:n.actionCard.closeDiagnostic||""}):void 0,footer:!1===(null==t?void 0:t.showChatCardFooter)?null:o.a.createElement(r.a,{chatLogItem:t,onThumbsUpClicked:u,onThumbsDownClicked:p,primaryMessage:null!=t&&t.shouldShowAIGeneratedIndicator?n.actionCard.aiDisclaimer:void 0,thumbsUpButtonLabel:n.actionCard.thumbsUpButtonLabel,thumbsUpTooltipLabel:n.actionCard.thumbsUpButtonLabel,thumbsDownButtonLabel:n.actionCard.thumbsDownButtonLabel,thumbsDownTooltipLabel:n.actionCard.thumbsDownButtonLabel}),localization:n})},b=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isTerminal:!0};return p(p({},e),{},{message:t,data:a})}},46548:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>{var{outputCardProps:t,copilotResult:a}=e;return t.onRender({copilotResult:a})}},46549:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>{var{outputCardProps:t,copilotResult:a,id:n}=e;return t.onRender({copilotResult:a,id:n})}},46550:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(11035),o=a.n(n),r=a(21794),c=e=>{var{onRenderFRE:t,fREStyle:a,localization:n,customFreImageProps:c}=e,[i,l]=o.a.useState(!0),s=o.a.useMemo(()=>{var e,s;return i?t?t():o.a.createElement(r.Fre,{freImagePath:c.imagePath,freCards:[{cardType:r.FreCardContentType.TEXT,titleText:null!==(e=null==c?void 0:c.freTitle)&&void 0!==e?e:n.chat.freTitle,descriptionText:null!==(s=null==c?void 0:c.freDescription)&&void 0!==s?s:[n.chat.freDescription]}],handleDismissButtonClick:()=>l(!1),styles:null==a?void 0:a({})}):null},[i,t,null==c?void 0:c.imagePath,null==c?void 0:c.freTitle,null==c?void 0:c.freDescription,n.chat.freTitle,n.chat.freDescription,a]);return{setIsFREEnabled:l,FREElement:s}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/copilot-powerpages.eb9081bf.chunk.js.map