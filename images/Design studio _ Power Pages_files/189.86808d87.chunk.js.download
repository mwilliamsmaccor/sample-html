/*! For license information please see 189.86808d87.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[189],{23452:function(e,a,t){"use strict";t.r(a),t.d(a,"WebResourcePanel",(function(){return oe}));var n=t(13060),o=t(12281),r=t(12280),i=t(12170),l=t(13174),s=t(14620),c=t(12707),u=t(13139),d=t(13141),m=t(12159),b=t(13252),v=t(13251),p=t(12339),f=t(12341),g=t(12329),y=t(12336),O=t(14610),h=t(13117),j=t(12061),C=t(12065),R=t(13189),E=t(12460),w=t(16639),F=t(12347),N=t(15544),S=t(23453),M=t(17105),k=t(17915),W=t(23429),P=t(11203),D=t(11205),A=t(12457),L=t(19356),T=t.n(L),B=t(11035),x=t.n(B),U=t(17476),z=t(23454),I=t(23455),q=t(17464),K=t(17439),V=t(17104),H=t(23456),_=t(23414),G=t(17438),Q=t(23428),J=t(23457),Z=t(23459),Y=t(23460),X=t(17108);function $(e,a,t,n,o,r,i){try{var l=e[r](i),s=l.value}catch(c){return void t(c)}l.done?a(s):Promise.resolve(s).then(n,o)}function ee(e){return function(){var a=this,t=arguments;return new Promise((function(n,o){var r=e.apply(a,t);function i(e){$(r,n,o,i,l,"next",e)}function l(e){$(r,n,o,i,l,"throw",e)}i(void 0)}))}}function ae(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function te(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?ae(Object(t),!0).forEach((function(a){ne(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ae(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function ne(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:String(n))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var oe=Object(P.r)("WebResourceDesigner")(Object(C.a)(e=>{var a,t,C,{t:P,styles:L,theme:Y,panelDetails:$}=e,{showPanel:ae,onPanelDismiss:ne,isCreate:oe,webResourceId:re,solutionId:ie,hideBackButton:le,showSaveAndPublishButton:se,webResourceTypePanel:ce,setCreatedWebResource:ue,setCurrentWebResourceSelected:de,isPreferredSolutionFeatureEnabled:me}=$,be=x.a.useMemo(()=>Object(j.a)()(L,{theme:Y}),[L,Y]),[ve,pe]=Object(B.useState)(""),[fe,ge]=Object(B.useState)(!0),[ye,Oe]=Object(B.useState)(!1),[he,je]=Object(B.useState)(!1),[Ce,Re]=Object(B.useState)(!1),[Ee,we]=Object(B.useState)(void 0),[Fe,Ne]=x.a.useState(void 0),[Se,Me]=x.a.useState([Object(I.a)(P)]),[ke,We]=Object(B.useState)(Object(Z.c)()),Pe=x.a.createRef(),[De,Ae]=Object(B.useState)(""),{currentEnvironment:Le}=Object(A.Q)(),{environmentClient:Te}=Object(F.e)(),Be=Object(G.b)({solutionId:ie,t:P}),[xe,Ue]=Object(B.useState)(!1),[ze,Ie]=Object(B.useState)(!1),[qe,Ke]=Object(B.useState)(""),Ve=Object(Q.c)({webResourceId:re,t:P,skip:oe||!re,refetchQuery:ye&&!!re}),He=Object(Q.d)({t:P,skip:ce!==X.a.imagesType}),_e=Object(H.a)({t:P}),Ge=Object(_.b)({t:P}),Qe=se?o.a:r.a,{updateWebResource:Je,webResourceUpdated:Ze,errorMessage:Ye,loading:Xe}=Object(W.d)(N.a,P("Common.Request.Failed")),{createWebResource:$e,webResourceCreated:ea,errorMessage:aa,loading:ta}=Object(W.a)(N.a,P("Common.Request.Failed")),na=x.a.useMemo(()=>!Ce||!!xe,[Ce,xe]),oa=Object(B.useMemo)(()=>P(ze?"Common.Publishing":he||Xe||ta?"Common.Saving":"Common.Loading"),[he,Xe,ta,ze]);x.a.useEffect(()=>{var e,a=!Te||!Be||(null==Be?void 0:Be.loading)||!Ge||(null==Ge?void 0:Ge.loading)||Xe||ta||ze||!oe&&(!Ve||(null==Ve?void 0:Ve.loading)||he||!(null!=Ve&&Ve.errorMessage)&&(null==Ve||null===(e=Ve.webResource)||void 0===e?void 0:e.id)!==re);ge(a)},[ae,Te,Be,null==Be?void 0:Be.loading,Ge,null==Ge?void 0:Ge.loading,Xe,ta,ze,oe,null==Ve?void 0:Ve.webResource,null==Ve?void 0:Ve.loading,null==Ve?void 0:Ve.errorMessage,re,he,ge]),x.a.useEffect(()=>{var e;e=oe?!ta&&ea?!ze&&xe?"":qe:aa:!Xe&&Ze?!ze&&xe?"":qe:Ye,ae&&(null!=Be&&Be.errorMessage||null!=Ve&&Ve.errorMessage||null!=Ge&&Ge.errorMessage||e)?(pe(e),je(!1),Oe(!1),Object(D.M)(N.a,{eventName:K.a.WebResourceError,eventData:{error:e}})):pe("")},[ae,null==Be?void 0:Be.errorMessage,null==Ve?void 0:Ve.errorMessage,null==Ge?void 0:Ge.errorMessage,Ye,aa,Xe,ta,oe,ea,xe,Ze,ze,qe]),x.a.useEffect(()=>{null!=Be&&Be.loading||Ae(Object(q.b)(null==Be?void 0:Be.customizationPrefix))},[null==Be?void 0:Be.customizationPrefix,null==Be?void 0:Be.loading]);var ra=x.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ne(void 0),pe(""),je(!1),Re(!1),Ue(!1),Ie(!1),Oe(!1),ne&&ne(e),e||Object(D.O)(N.a,{eventName:K.a.DismissPanel,eventData:{wasDataUpdated:e}})}),[ne]);x.a.useEffect(()=>{var e;if(ae)if(oe&&!ve)na&&(e=Object(Z.d)(void 0,Se,Object(E.q)(Le)),je(!1),Oe(!1),We(te({},e)),we(Object(V.g)(P,ce)));else if(Ve&&!Ve.loading&&!Ve.errorMessage&&Ve.webResource&&!ve){var a=null==Ve?void 0:Ve.webResource;Ze&&he&&ye&&na?(de&&(a=te(te({},a),{},{displayName:ke.displayName}),de(a)),je(!1),Oe(!1),ra(!0)):he||(e=Object(Z.d)(a,Se,Object(E.q)(Le)),We(te({},e)),we(e.schemaName))}},[oe,ae,re,Se,Le,null==Ve?void 0:Ve.loading,null==Ve?void 0:Ve.errorMessage,null==Ve?void 0:Ve.webResource,ce,Ze,he,na,ye,ra,ve]),x.a.useEffect(()=>{ea&&na&&(ue&&ue(Object(Q.b)(ea)),ra(!0))},[ea,na,ra]),x.a.useEffect(()=>{!oe&&Ze&&he&&Oe(!0)},[oe,Ze,he]),x.a.useEffect(()=>{var e=null==_e?void 0:_e.languages;if((null==_e||!_e.loading)&&e&&e.length>0){var a=[Object(I.a)(P)];e.forEach(e=>{var t;a.push({key:e.localeId,text:null!==(t=e.name)&&void 0!==t?t:""})}),Me(a)}else Me([Object(I.a)(P)])},[null==_e?void 0:_e.loading,null==_e?void 0:_e.languages]);var ia=x.a.useCallback(e=>{var a=e.target.files?e.target.files[0]:void 0,t=null==a?void 0:a.name,n=Object(M.b)(t||""),o=a?ce===X.a.imagesType?Object(V.f)(n):Object(V.l)(n):void 0,r=Object(V.m)(Ge,null==a?void 0:a.size),i=!oe&&o===ke.type||oe;if(a&&(null==a?void 0:a.size)>0&&o&&r&&i)pe(""),Ne(a),we(t),Object(S.b)(a).then(e=>{We(te(te({},ke),{},{file:e||"",type:oe?o:ke.type,typeKeySelected:oe?o:ke.typeKeySelected}))}).catch(e=>{Object(D.M)(N.a,{eventName:K.a.ErrorUploadingFileForWebResource,eventData:{error:e}})});else{var l=a&&0!==(null==a?void 0:a.size)?o&&i?P(r?"Common.Request.Failed":"WebResources.Form.InvalidContentSize"):oe?ce===X.a.imagesType?P("WebResources.Form.InvalidImageType"):P("WebResources.Form.InvalidType"):P("WebResources.Form.InvalidTypeOnUpdate"):P("WebResources.Form.EmptyFile");pe(l),We(te(te({},ke),{},{file:"",type:oe?0:ke.type})),Ne(void 0),we(Object(V.g)(P,ce))}},[Fe,ue,Pe,ce,oe,Ge]),la=x.a.useCallback(()=>{var e=null==Be?void 0:Be.solutionUniqueName;je(!0),oe||!re?(Object(D.O)(N.a,{eventName:K.a.CreateWebResource,eventData:{webResourceInfo:T()(ke,K.g),solutionUniqueName:e}}),$e({solutionUniqueName:e||"",webResource:Object(Z.b)(ke,De),isPreferredSolutionFeatureEnabled:me})):(Object(D.O)(N.a,{eventName:K.a.UpdateWebResource,eventData:{webResourceInfo:T()(ke,K.g),solutionUniqueName:e}}),Je({solutionUniqueName:e||"",webResource:Object(Z.e)(ke,re),isPreferredSolutionFeatureEnabled:me}))},[ae,null==Be?void 0:Be.solutionUniqueName,oe,re,ke,$e,Je,me]),sa=x.a.useCallback(ee((function*(){Re(!0),la()})),[la]);x.a.useEffect(()=>{var e;!Ce||xe||!ea&&!Ze||!Le||(Object(D.O)(N.a,{eventName:K.a.PublishWebResource,eventData:{webResourceInfo:T()(ke,K.g)}}),Ie(!0),Object(k.a)({telemetryScope:N.a,data:[{msdyn_objectid:null!==(e=null!=re?re:null==ea?void 0:ea.id)&&void 0!==e?e:"",msdyn_componenttype:R.v.WebResource,msdyn_name:""}],environment:Le,teamName:D.j.FormDesigner}).then(()=>{Ie(!1),Ue(!0)}).catch(e=>{var a;Ke(null!==(a=null==e?void 0:e.message)&&void 0!==a?a:P("Common.Request.Failed"))}))},[Ce,re,ea,Ze,xe,Le,ke]);var ca=x.a.useMemo(()=>{var e=null==Ve?void 0:Ve.webResource,a=!!Object(w.h)(null==Be?void 0:Be.solutionIsManaged,null==Be?void 0:Be.solutionIsPatched,!(null==e||!e.isManaged),[!(null==e||!e.isCustomizable)]);return a&&Object(D.O)(N.a,{eventName:K.a.DisablePanel,eventData:{disableForm:a,isSolutionManaged:null==Be?void 0:Be.solutionIsManaged,isSolutionPatched:null==Be?void 0:Be.solutionIsPatched,isResourceManaged:null==e?void 0:e.isManaged,isResourceCustomizable:null==e?void 0:e.isCustomizable}}),a},[null==Be?void 0:Be.solutionIsManaged,null==Be?void 0:Be.solutionIsPatched,null==Ve||null===(a=Ve.webResource)||void 0===a?void 0:a.isManaged,null==Ve||null===(t=Ve.webResource)||void 0===t?void 0:t.isCustomizable]),ua=x.a.useMemo(()=>oe&&0===ke.typeKeySelected?ce===X.a.imagesType?V.b:V.a:Object(V.c)(ke.typeKeySelected)||".".concat(ke.fileExtension),[oe,ke.typeKeySelected,ke.fileExtension,ce]),da=x.a.useMemo(()=>ce===X.a.imagesType?Object(V.e)(P):Object(V.k)(P),[ce]),ma=x.a.useMemo(()=>oe&&Fe&&ke.type!==ke.typeKeySelected?P("WebResources.Form.InvalidTypeOnCreate"):void 0,[oe,Fe,ke.type,ke.typeKeySelected]),ba=x.a.useMemo(()=>ce===X.a.imagesType?P(oe?"WebResources.NewImageWebResourceHeader":"WebResources.EditImageWebResourceHeader"):P(oe?"WebResources.NewWebResourceHeader":"WebResources.EditWebResourceHeader"),[oe,ce]),va=x.a.useMemo(()=>ca||fe||!ke.schemaName||!ke.file||!ke.type||!ke.typeKeySelected||!ke.isFormValid.isSchemaNameValid||oe&&ke.type!==ke.typeKeySelected,[ca,fe,ke.schemaName,ke.file,ke.type,ke.typeKeySelected,ke.isFormValid.isSchemaNameValid,oe]),pa=x.a.useCallback(()=>x.a.createElement(g.a,{horizontal:!0,horizontalAlign:"start"},se&&x.a.createElement(r.a,{disabled:va,text:P("Common.SaveAndPublish"),className:be.primaryButton,onClick:sa}),x.a.createElement(Qe,{disabled:va,text:P("Common.Save"),className:be.primaryButton,onClick:la}),!se&&x.a.createElement(o.a,{text:P("Common.Cancel"),onClick:()=>ra()})),[oe,ca,fe,ke.schemaName,ke.file,ke.type,ke.typeKeySelected,ke.isFormValid.isSchemaNameValid,se,ra,la,sa]),fa=x.a.useCallback(()=>x.a.createElement(J.a,{sectionDetails:{disableFormFields:ca,formFields:ke,isCreate:oe,setFormFields:We,languageOptions:Se,webResourceTypePanel:ce}}),[ke,ca,oe,Se,ce]),ga=x.a.useCallback(()=>x.a.createElement(x.a.Fragment,null,x.a.createElement(g.a,{className:be.mainContentArea,horizontal:!0,horizontalAlign:"space-between",wrap:!1},x.a.createElement(g.a,{horizontal:!0,horizontalAlign:"center"},!le&&x.a.createElement(i.a,{iconProps:{iconName:"Back"},ariaLabel:P("Common.Back"),onClick:()=>ra(),className:be.headerBackButton}),x.a.createElement("h1",{className:le?be.headerTitleWithNoBackButton:be.headerTitle},ba)),x.a.createElement(g.a,{className:be.headerCloseButton},x.a.createElement(h.a,{content:P("Common.Close")},x.a.createElement(i.a,{ariaLabel:P("Common.Close"),iconProps:{iconName:"Cancel"},onClick:()=>ra(),className:be.headerCloseButtonLabel})))),x.a.createElement(y.a,null,ve&&!fe&&x.a.createElement(u.a,{className:be.errorMessageBar,messageBarType:d.a.error,onDismiss:()=>pe(""),dismissButtonAriaLabel:P("Common.Close")},ve))),[ce,ve,fe]);return x.a.createElement(b.a,{role:"presentation",key:"createImageWebResourceFormKey",type:v.a.medium,isFooterAtBottom:!0,hasCloseButton:!1,className:be.panel,isOpen:ae,onDismiss:()=>ra(),isLightDismiss:!0,onOuterClick:()=>ra(),onLightDismissClick:()=>ra(),onRenderFooterContent:pa,onRenderHeader:ga},x.a.createElement(g.a,{className:be.mainContentArea,tokens:{childrenGap:U.c}},x.a.createElement(y.a,null,fe&&x.a.createElement(m.a,{styles:{root:{backgroundColor:null==Y||null===(C=Y.palette)||void 0===C?void 0:C.white,opacity:.9}}},x.a.createElement(p.a,{size:f.a.large,label:oa,ariaLabel:oa,ariaLive:"assertive",labelPosition:"right"})),!fe&&x.a.createElement(g.a,{className:be.mainContentArea,"aria-live":"polite",tokens:{childrenGap:U.c}},x.a.createElement(y.a,null,x.a.createElement(c.a,{required:!0,"aria-label":ce===X.a.imagesType?P("WebResources.Form.UploadImageRequiredAriaLabel"):P("WebResources.Form.UploadFileRequiredAriaLabel"),className:be.uploadLabel},ce===X.a.imagesType?P("WebResources.Form.UploadImage"):P("WebResources.Form.UploadFile")),x.a.createElement("input",{type:"file",ref:Pe,style:{display:"none"},accept:ua,onChange:ia,disabled:ca}),x.a.createElement(o.a,{"data-test-id":"UploadFile",onClick:()=>{Pe.current&&Pe.current.click()},disabled:ca},ce===X.a.imagesType?P("Common.UploadImage"):P("Common.UploadFile")),x.a.createElement("div",{className:be.fileNameContainer},x.a.createElement("span",{className:be.fileSelectionText},Ee))),ce===X.a.imagesType&&x.a.createElement(y.a,null,x.a.createElement(u.a,{className:be.fileDescriptionText,messageBarType:d.a.info,dismissButtonAriaLabel:P("WebResources.Form.SvgDescription")},P("WebResources.Form.SvgDescription"))),x.a.createElement(y.a,null,x.a.createElement(O.a,{label:P("WebResources.Form.DisplayName"),ariaLabel:P("WebResources.Form.DisplayName"),"data-test-id":"DisplayName","aria-required":!0,disabled:ca,maxLength:z.a.webResourceDisplayNameMax,value:ke.displayName,onChange:(e,a)=>{We(te(te({},ke),{},{displayName:a||""}))}})),x.a.createElement(y.a,null,x.a.createElement(O.a,{label:P("WebResources.Form.Name"),ariaLabel:P("WebResources.Form.Name"),"data-test-id":"Name","aria-required":!0,required:!0,disabled:!oe||ca,maxLength:z.a.webResourceSchemaNameMax,prefix:De&&oe?De:void 0,value:ke.schemaName,onGetErrorMessage:e=>{var a;return Object(q.e)(/[^a-z0-9A-Z_\\./-]/g,e,P("WebResources.Form.NameValidation"))||Object(q.e)(/[/]{2,}/g,e,P("WebResources.Form.NameValidation"))||(e?"":P("WebResources.Form.EmptyName"))||(null!=He&&null!==(a=He.webResources)&&void 0!==a&&a.find(a=>a.name===Object(Z.a)(e,De))?P("WebResources.Form.DuplicatedName"):"")||Object(q.e)(/ ^[/\\.]/g,Object(Z.a)(e,De),P("WebResources.Form.NameValidation"))},validateOnLoad:!1,onNotifyValidationResult:(e,a)=>{We(te(te({},ke),{},{isFormValid:te(te({},ke.isFormValid),{},{isSchemaNameValid:!e})}))},onChange:(e,a)=>{We(te(te({},ke),{},{schemaName:a||""}))}})),x.a.createElement(y.a,null,x.a.createElement(s.a,{label:P("WebResources.Form.Type"),ariaLabel:P("WebResources.Form.Type"),"data-test-id":"Type",required:!0,disabled:!oe||ca,selectedKey:ke.typeKeySelected,options:da,onChange:(e,a)=>{var t,n=null==a||null===(t=a.key)||void 0===t?void 0:t.toString();We(te(te({},ke),{},{typeKeySelected:n?parseInt(n,10):0}))},errorMessage:ma})),x.a.createElement(y.a,null,x.a.createElement(O.a,{label:P("WebResources.Form.Description"),ariaLabel:P("WebResources.Form.Description"),"data-test-id":"Description",disabled:ca,maxLength:z.a.webResourceDescriptionMax,value:ke.description,multiline:!0,rows:3,resizable:!1,onChange:(e,a)=>{We(te(te({},ke),{},{description:a||""}))}})),x.a.createElement(y.a,{className:be.noTop},x.a.createElement(n.a,{text:P("WebResources.Form.AdvancedOptions"),"data-test-id":"AdvancedOptions",onRenderContent:()=>fa(),isHiddenOnDismiss:!0,styles:U.a,buttonAs:l.a,"aria-expanded":ke.wasAdvanceSectionOpened,onOpen:()=>{We(te(te({},ke),{},{wasAdvanceSectionOpened:!0}))},onClose:()=>{We(te(te({},ke),{},{wasAdvanceSectionOpened:!1}))}}))))))},Y.a))},23453:function(e,a,t){"use strict";function n(e,a,t,n,o,r,i){try{var l=e[r](i),s=l.value}catch(c){return void t(c)}l.done?a(s):Promise.resolve(s).then(n,o)}function o(e){return function(){var a=this,t=arguments;return new Promise((function(o,r){var i=e.apply(a,t);function l(e){n(i,o,r,l,s,"next",e)}function s(e){n(i,o,r,l,s,"throw",e)}l(void 0)}))}}function r(e,a){for(var t=[],n=0;n<e.length;n+=512){for(var o=e.slice(n,n+512),r=new Array(o.length),i=0;i<o.length;i++)r[i]=o.charCodeAt(i);var l=new Uint8Array(r);t.push(l)}return new Blob(t,{type:a})}function i(e,a){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,a);else{var t=URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download=a,n.target="_blank",document.body.appendChild(n),n.click(),n.remove()}}function l(e){return s.apply(this,arguments)}function s(){return(s=o((function*(e){return new Promise((a,t)=>{var n=new FileReader;n.onload=function(){var e=n.result,t=Array.from(new Uint8Array(e)),o=btoa(t.map(e=>String.fromCharCode(e)).join(""));a(o)},n.onerror=t,n.readAsArrayBuffer(e)})}))).apply(this,arguments)}function c(e,a){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(e))),t.setAttribute("download",a),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}t.d(a,"a",(function(){return r})),t.d(a,"c",(function(){return i})),t.d(a,"b",(function(){return l})),t.d(a,"d",(function(){return c}))},23454:function(e,a,t){"use strict";t.d(a,"a",(function(){return n}));var n={webResourceDisplayNameMax:100,webResourceSchemaNameMax:100,webResourceDescriptionMax:2e3}},23455:function(e,a,t){"use strict";t.d(a,"a",(function(){return n}));var n=e=>({key:"",data:"",text:e("Common.None")})},23456:function(e,a,t){"use strict";t.d(a,"a",(function(){return u}));var n=t(11035),o=t(11205),r=t(15544),i=t(17439),l=t(13847),s=t(12347),c=t(12457),u=e=>{var{t:a,skipCall:t}=e,{environmentClientHasCds2Database:u}=Object(s.e)(),{currentEnvironment:d}=Object(c.Q)(),[m,b]=Object(n.useState)(void 0),v=u,{loading:p,errorMessage:f,languages:g}=Object(l.c)(r.a,!v||t,a("Common.Request.Failed"));return Object(n.useEffect)(()=>{v&&(Object(o.O)(r.a,{eventName:i.d.GetLanguages,eventData:{languages:g,loading:p,errorMessage:f}}),b({loading:p,errorMessage:f,languages:g}))},[v,d,g,p,f]),m}},23457:function(e,a,t){"use strict";t.d(a,"a",(function(){return w}));var n=t(11035),o=t.n(n),r=t(12329),i=t(12336),l=t(12520),s=t(23458),c=t(12061),u=t(12065),d=t(17476),m=t(14620),b=t(11203),v=t(17104),p=t(12707),f=t(23415),g=t(13272),y=t(17108),O=t(17439),h=t(11205),j=t(15544);function C(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function R(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?C(Object(t),!0).forEach((function(a){E(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function E(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:String(n))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var w=Object(b.r)("WebResourceDesigner")(Object(u.a)(e=>{var a,{t:t,styles:n,theme:s,sectionDetails:u}=e,{disableFormFields:b,isCreate:C,formFields:E,setFormFields:w,languageOptions:F,webResourceTypePanel:N}=u,S=o.a.useMemo(()=>Object(c.a)()(n,{theme:s}),[n,s]),M=Object(f.b)({t:t,platformFCBNames:[null===f.a||void 0===f.a?void 0:f.a.MocaOffline]}),[k,W]=o.a.useState(!1);o.a.useEffect(()=>{var e;M&&(null==M?void 0:M.size)>0&&W(!(null==M||null===(e=M.get(null===f.a||void 0===f.a?void 0:f.a.MocaOffline))||void 0===e||!e.value))},[M]);var P=o.a.useMemo(()=>!(!b&&1!==(null==F?void 0:F.length)),[b,null==F?void 0:F.length]),D=o.a.useMemo(()=>!C&&E.fileUrl?Object(v.h)(E.fileUrl):void 0,[C,E.fileUrl]),A=o.a.useMemo(()=>k&&(N===y.a.imagesType||Object(v.n)(E.typeKeySelected)),[C,k,E.typeKeySelected]);return o.a.createElement(r.a,{className:S.mainContentArea,"aria-live":"polite",tokens:{childrenGap:d.c}},o.a.createElement(i.a,null,o.a.createElement(m.a,{label:t("WebResources.Form.Language"),ariaLabel:t("WebResources.Form.Language"),"data-test-id":"Language",selectedKey:(null===(a=E.language)||void 0===a?void 0:a.key)||"",options:F,onChange:(e,a)=>{w(R(R({},E),{},{language:a})),Object(h.O)(j.a,{eventName:O.a.UpdateLanguage,eventData:{languageSelected:a}})},disabled:P})),A&&o.a.createElement(i.a,{className:S.mobileContainer},o.a.createElement(g.a,{checked:!!E.isEnabledForMobileClient,onChange:(e,a)=>{w(R(R({},E),{},{isEnabledForMobileClient:a||!1,isAvailableForMobileOffline:a&&E.isAvailableForMobileOffline||!1}))},disabled:b,id:"tooltipEnabledForMobileClient",label:t("WebResources.Form.EnableForMobile"),ariaLabel:t("Entities.Form.EnableForMobile")})),A&&E.isEnabledForMobileClient&&o.a.createElement(i.a,{className:S.mobileContainer},o.a.createElement(g.a,{checked:!!E.isAvailableForMobileOffline,onChange:(e,a)=>{w(R(R({},E),{},{isAvailableForMobileOffline:a||!1}))},disabled:b,id:"tooltipAvailableOffline",label:t("WebResources.Form.AvailableOffline"),ariaLabel:t("Entities.Form.AvailableOffline")})),!!D&&o.a.createElement(i.a,null,o.a.createElement(p.a,null,t("WebResources.Form.Url")),o.a.createElement("div",{className:S.urlLinkContainer},o.a.createElement(l.a,{className:S.urlLink,href:D,target:"_blank"},E.fileUrl))))},s.a))},23458:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(12079),o=(Object(n.c)(window),n.a.large,e=>{var a=null==e?void 0:e.theme,t=null==a?void 0:a.palette;return{mainContentArea:{fontSize:16,color:(null==t?void 0:t.neutralPrimary)||"#323130"},urlLinkContainer:{overflowWrap:"break-word"},urlLink:{fontSize:"12px !important",lineHeight:"16px !important"},mobileContainer:{paddingTop:5}}})},23459:function(e,a,t){"use strict";t.d(a,"a",(function(){return i})),t.d(a,"c",(function(){return l})),t.d(a,"b",(function(){return s})),t.d(a,"e",(function(){return c})),t.d(a,"d",(function(){return u}));var n=t(17104),o=t(12462),r=t(17105),i=(e,a)=>"".concat(a).concat(e),l=()=>({isFormValid:{isSchemaNameValid:!0},displayName:"",schemaName:"",type:0,file:"",typeKeySelected:0}),s=(e,a)=>{var t;return{content:e.file,type:e.type,displayName:e.displayName,name:i(e.schemaName,a),description:e.description,languageCode:(null===(t=e.language)||void 0===t?void 0:t.key)||void 0,isEnabledForMobileClient:e.isEnabledForMobileClient,isAvailableForMobileOffline:e.isAvailableForMobileOffline}},c=(e,a)=>{var t;return{id:a,displayName:e.displayName,content:e.file,description:e.description,languageCode:(null===(t=e.language)||void 0===t?void 0:t.key)||0,isEnabledForMobileClient:e.isEnabledForMobileClient,isAvailableForMobileOffline:e.isAvailableForMobileOffline}},u=(e,a,t)=>{var i=(null==e?void 0:e.name)||"",l=(null==e?void 0:e.type)||0;return{isFormValid:{isSchemaNameValid:!0},displayName:(null==e?void 0:e.displayName)||"",schemaName:i,type:l,typeKeySelected:l,file:(null==e?void 0:e.content)||"",description:(null==e?void 0:e.description)||"",language:(null==a?void 0:a.find(a=>a.key===(null==e?void 0:e.languageCode)))||void 0,fileUrl:Object(o.Z)(t,i)||"",fileExtension:e&&Object(r.b)(null==e?void 0:e.name)||"",imageFileUrl:e?Object(n.d)(e):"",isEnabledForMobileClient:null==e?void 0:e.isEnabledForMobileClient,isAvailableForMobileOffline:null==e?void 0:e.isAvailableForMobileOffline}}},23460:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(17476),o=e=>{var a=null==e?void 0:e.theme,t=null==a?void 0:a.palette;return{panel:{selectors:{".ms-Panel-commands":{marginTop:n.c},".ms-Panel-header":{paddingLeft:n.c,paddingRight:n.c},".ms-Panel-content":{paddingLeft:n.c,paddingRight:n.c,paddingBottom:n.c,marginBottom:11,marginTop:n.c},".ms-Panel-navigation":{justifyContent:"space-between"},".ms-Link":{fontSize:16,lineHeight:22,textDecoration:"underline",color:null==t?void 0:t.themeSecondary,selectors:{"&:hover":{color:null==t?void 0:t.themeSecondary},"&:active":{color:null==t?void 0:t.themeSecondary}}},".ms-Overlay .ms-Spinner":{position:"relative",top:"40%",transform:"translateY(-50%)"},".ms-Checkbox.is-disabled":{color:(null==t?void 0:t.neutralTertiary)||"#A19F9D"},".ms-TextField, .ms-Dropdown":{maxWidth:308},".ms-Panel-footerInner":{paddingLeft:n.c}}},headerTitle:{fontSize:20,fontWeight:600,color:(null==t?void 0:t.neutralPrimary)||"#323130",lineHeight:28,overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto",marginBottom:10},headerTitleWithNoBackButton:{fontSize:20,fontWeight:600,color:(null==t?void 0:t.neutralPrimary)||"#323130",lineHeight:28,overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto",marginBottom:10,marginLeft:n.c},headerBackButton:{marginLeft:n.c,marginRight:16,fontSize:16,lineHeight:"100%",color:(null==t?void 0:t.neutralSecondary)||"#605E5C"},headerCloseButton:{marginRight:n.c},headerCloseButtonLabel:{color:(null==t?void 0:t.neutralSecondary)||"#605E5C"},mainContentArea:{fontSize:16,color:(null==t?void 0:t.neutralPrimary)||"#323130"},fileSelectionText:{marginLeft:12,fontSize:14,lineHeight:20,overflowWrap:"break-word",wordBreak:"break-word"},fileDescriptionText:{fontSize:12,lineHeight:16,maxWidth:308},errorMessageBar:{marginTop:14},noTop:{marginTop:"0 !important"},primaryButton:{marginRight:8},fileNameContainer:{display:"inline-flex",maxWidth:480},uploadLabel:{paddingBottom:9}}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/189.86808d87.chunk.js.map