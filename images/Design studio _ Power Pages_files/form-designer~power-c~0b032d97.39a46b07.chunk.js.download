/*! For license information please see form-designer~power-c~0b032d97.39a46b07.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{16540:function(t,e,i){"use strict";i.d(e,"b",(function(){return C})),i.d(e,"a",(function(){return O}));var n=i(13189),r=i(16541),a=i(16545),o=i(16547),s=i(16549),l=i(16551),d=i(11205),c=i(16470),u=i(16484),y=i(16557),h=i(16558),m=i(16475),p=i(16559),f=i(16561),v=i(16577),b=i(16578);function g(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function M(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){g(a,n,r,o,s,"next",t)}function s(t){g(a,n,r,o,s,"throw",t)}o(void 0)}))}}var C=function(t){return t.ManyToManyRelationship="N:N",t.ManyToOneRelationship="N:1",t.OneToManyRelationship="1:N",t.OneToOneRelationship="1:1",t}({});class O{constructor(t,e,i,r,a){var s=this;this.queryClient=t,this.apolloClient=e,this.environment=i,this.telemetryScope=r,this.team=a,this.allEntities=[],this.viewsByEntity=new Map,this.primaryTableName=void 0,this.getPrimaryIdField=function(){var t=M((function*(t){var e=yield s.getAllEntityAttributesByType(t,[m.c.UniqueIdentifierType]);return(null==e?void 0:e.length)>0?e[0].name:"".concat(t.toLocaleLowerCase(),"id")}));return function(e){return t.apply(this,arguments)}}(),this.getMainFormsForEntity=function(){var t=M((function*(t){return yield Object(o.a)({entityName:t,formType:n.m.Main,environment:s.environment,team:s.team,telemetryScope:s.telemetryScope},s.queryClient)}));return function(e){return t.apply(this,arguments)}}()}initialize(t){this.primaryTableName=t,this.apolloClient&&(this.apolloClient=null)}getAllValidTables(){var t=this;return M((function*(){return(yield t.getAllTables()).filter(e=>t.IsValidTableForFormEditor(e)).sort((t,e)=>{var i;return null===(i=t.displayCollectionName)||void 0===i?void 0:i.localeCompare(e.displayCollectionName)})}))()}IsValidTableForFormEditor(t){return!!t&&(!this.IsEntityInExclusionList(t.objectTypeCode)&&(!(!t.isValidForAdvancedFind||t.isChildEntity)||!!this.IsEntityInInclusionList(t.objectTypeCode)))}IsEntityInInclusionList(t){switch(t){case h.a.BulkOperation:case h.a.InvoiceDetail:case h.a.KnowledgeArticleIncident:case h.a.OpportunityProduct:case h.a.QueueItem:case h.a.QuoteDetail:case h.a.SalesOrderDetail:case h.a.DynamicProperty:case h.a.ProductAssociation:case h.a.ProductSubstitute:case h.a.ActivityMimeAttachment:return!0;default:return!1}}IsEntityInExclusionList(t){switch(t){case h.a.ActivityParty:case h.a.Annotation:case h.a.ConnectionRoleObjectTypeCode:case h.a.CustomerAddress:case h.a.DynamicProperty:case h.a.ProductAssociation:case h.a.ProductSubstitute:case h.a.SavedQuery:return!0;default:return!1}}getTable(t){var e=this;return M((function*(){return(yield e.getAllTables()).find(e=>e.logicalName===t)}))()}getAllTables(){var t=this;return M((function*(){if(0===t.allEntities.length){var e=yield Object(r.b)(t.queryClient,t.environment,{entityTypeNames:[]},u.a,d.j.FormDesigner);t.allEntities=e}return t.allEntities}))()}getAllPublicViewsByTable(t){var e=this;return M((function*(){var i=yield e.getActiveLookupAndPublicViewsForEntity(t);return null!=i&&i.length?i.filter(t=>0===t.queryType):[]}))()}getAllAttributesMetadata(t){var e=this;return M((function*(){var i=yield Object(v.a)(e.queryClient,e.environment,{entityTypeNames:[t],isFilterable:!1},u.a,d.j.FormDesigner);return i&&i[0]}))()}getAllEntityAttributes(t){var e=this;return M((function*(){var i=[],n=t||e.primaryTableName;return(yield e.getAllAttributesMetadata(n)).attributes.forEach(t=>{!1===t.isLogical&&i.push(e.getAttributeModel(t,n))}),i}))()}getAllEntityAttributesByType(t,e){var i=this;return M((function*(){var n=[],r=t||i.primaryTableName;return(yield i.getAllAttributesMetadata(r)).attributes.forEach(t=>{!1===t.isLogical&&(e.includes(t.attributeType)||e.includes(t.attributeTypeName))&&n.push(i.getAttributeModel(t,r))}),n}))()}getColumnNamesForView(t){var e=(new DOMParser).parseFromString(t,"text/xml");return Array.from(e.getElementsByTagName("attribute")).map(t=>t.getAttribute("name"))}getLookupColumnsOnView(t,e){var i=this;return M((function*(){if(null!=e&&e.fetchXml){var n=yield i.getAllEntityAttributesByType(t,[m.c.Lookup,m.c.LookupType]),r=i.getColumnNamesForView(e.fetchXml),a=[];return r.forEach(t=>{var e=n.find(e=>e.name===t);e&&a.push(e)}),a}return[]}))()}getTargetViewsMapForLookups(t){var e=this;return M((function*(){var i={};return t.forEach(t=>{(null==t?void 0:t.targets).forEach(function(){var n=M((function*(n){i[t.name]=yield e.getActiveLookupAndPublicViewsForEntity(n)}));return function(t){return n.apply(this,arguments)}}())}),i}))()}getAttributeModel(t,e){var i=new y.a(new c.a(t.id),t.logicalName,t.schemaName,t.displayName,t.description,t.isCustom,t.attributeTypeName,t.format||t.formatName||m.d.None,new m.b(t.requiredLevel||m.b.None),e,null,!0,t.isRequiredForForm);if(i.description=t.description,"BooleanAttribute"===t.__typename){var n=t;i.AddBooleanInformation(n.trueOption,n.falseOption)}else if("OptionSetAttribute"===t.__typename){var r=t;r.optionSet&&i.AddOptionsInformation(r.optionSet.options)}return i.isValidForCreate=t.isValidForCreate,i.isValidForForm=t.isValidForForm,i.isValidForGrid=t.isValidForGrid,i.attributeType=t.attributeType,t.targets&&(i=y.c.CreateEntityLookupAttribute(i,t.targets,[])),i}getAttributeMetadata(t,e){var i=this;return M((function*(){var n=yield i.getAllAttributesMetadata(t);return n&&n.attributes&&n.attributes.find(t=>t.logicalName===e)}))()}getActiveLookupAndPublicViewsForEntity(t){var e=this;return M((function*(){var i,n=[];(n=e.viewsByEntity.get(t))||(n=(yield Object(s.a)({entityTypeName:t,isActive:!0,queryApis:[""],queryTypes:[0,64],environmentId:null===(i=e.environment)||void 0===i?void 0:i.id,telemetryScope:e.telemetryScope,team:e.team},e.queryClient)).map(t=>(t.id=t.id.toLowerCase(),t)),e.viewsByEntity.set(t,n));return n}))()}getDefaultLookupViewForEntity(t){var e=this;return M((function*(){var i=yield e.getActiveLookupAndPublicViewsForEntity(t);return null!=i&&i.length?i.find(t=>!0===t.isDefault&&64===t.queryType):null}))()}getDefaultPublicViewForEntity(t){var e=this;return M((function*(){var i=yield e.getActiveLookupAndPublicViewsForEntity(t);return null!=i&&i.length?i.find(t=>!0===t.isDefault&&0===t.queryType):null}))()}getBooleanAttribute(t,e){var i=this;return M((function*(){return i.getAttributeMetadata(t,e)}))()}getLookupAttribute(t,e){var i=this;return M((function*(){return i.getAttributeMetadata(t,e)}))()}getCardFormsForEntity(t){var e=this;return M((function*(){return yield Object(o.a)({entityName:t,formType:n.m.Card,environment:e.environment,team:e.team,telemetryScope:e.telemetryScope},e.queryClient)}))()}getQuickViewFormsForEntity(t){var e=this;return M((function*(){return yield Object(o.a)({entityName:t,formType:n.m.QuickViewForm,environment:e.environment,team:e.team,telemetryScope:e.telemetryScope},e.queryClient)}))()}getQuickCreateFormsForEntity(t){var e=this;return M((function*(){return yield Object(o.a)({entityName:t,formType:n.m.QuickCreate,environment:e.environment,team:e.team,telemetryScope:e.telemetryScope},e.queryClient)}))()}getEntityDisplayNames(t){var e=this;return M((function*(){return yield Object(r.b)(e.queryClient,e.environment,{entityTypeNames:t},u.a,d.j.FormDesigner)}))()}getAttributesInfoForRelatedRecords(t){var e=this;return M((function*(){return yield Object(v.a)(e.queryClient,e.environment,{entityTypeNames:t,isFilterable:null},u.a,d.j.FormDesigner)}))()}getTableRelationships(t,e,i){return M((function*(){return yield Object(a.a)({team:d.j.FormDesigner,telemetryScope:u.a,entityName:t,environmentId:e,queryClient:i})}))()}getExpandedTableRelationships(t){var e=this;return M((function*(){return yield Object(p.a)(e.queryClient,e.environment,{entityTypeNames:t},u.a,d.j.FormDesigner)}))()}getRelationshipDefinition(t){var e=arguments,i=this;return M((function*(){var n=e.length>1&&void 0!==e[1]&&e[1],r=yield Object(l.a)({environment:i.environment,schemaName:t,queryClient:i.queryClient,refetch:n,telemetryScope:u.a,team:d.j.FormDesigner});return r&&r.length>0?r[0]:void 0}))()}getTimelineConfigDataForEntity(){var t=this;return M((function*(){var e=yield Object(r.b)(t.queryClient,t.environment,{entityTypeNames:[]},u.a,d.j.FormDesigner),i=e&&e.length>0?e.map(t=>{var{id:e,logicalName:i,displayName:n,objectTypeCode:r,isActivity:a,isCustomEntity:o,isReadOnlyInMobileClient:s,activityTypeMask:l}=t;return{id:e,logicalName:i,displayName:n,objectTypeCode:r,isActivity:a,isCustomEntity:o,isReadOnlyInMobileClient:s,activityTypeMask:l}}):[],n=yield Object(f.a)(t.queryClient,t.environment,{isFilterable:null,entityLogicalName:"activitypointer"},u.a,d.j.FormDesigner);return{activityAttributes:[{attributes:n&&n.length>0?n.map(t=>{var{id:e,logicalName:i,displayName:n,attributeTypeName:r}=t;return{id:e,logicalName:i,displayName:n,attributeTypeName:r}}):[]}],allEntities:i}}))()}getTimelineEntityAttributes(t){var e=this;return M((function*(){return yield Object(f.a)(e.queryClient,e.environment,{entityLogicalName:t,isFilterable:null},u.a,d.j.FormDesigner)}))()}getActivityStatusReasons(t){var e=this;return M((function*(){var i=t.map(t=>Object(b.a)(e.environment,t,"statuscode"));return(yield Promise.all(i)).map(t=>t.optionSet.options)}))()}}},16545:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i(16546),r=i(11205),a=i(13794),o=i(12462),s=i(13828);function l(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function d(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){l(a,n,r,o,s,"next",t)}function s(t){l(a,n,r,o,s,"throw",t)}o(void 0)}))}}function c(t,e){return[t,e,"entityRelatedRecords"]}function u(t){return y.apply(this,arguments)}function y(){return(y=d((function*(t){var e,{telemetryScope:i,team:l,entityName:u,environmentId:y,queryClient:h}=t,m=Object(r.P)(i,a.h.getEntityRelatedRecords,{},l);try{var p=yield h.fetchQuery({queryKey:c(y,u),queryFn:(e=d((function*(){var t=null!=u&&u.length>0,e="".concat(o.h).concat(o.nb,"/msdyn_solutioncomponentsummaries?$select=").concat("msdyn_objectid,msdyn_schemaname,msdyn_subtype,msdyn_primaryentityname,msdyn_relatedentity,msdyn_relatedentityattribute");if(t){var i="msdyn_primaryentityname%20eq%20'".concat(encodeURIComponent(u),"'%20");e+="&$filter=".concat(i," and (msdyn_componenttype eq 10)&api-version=9.1")}return(yield Object(s.b)(e)).map(n.a)})),function(){return e.apply(this,arguments)})});return m.complete({resultLength:p.length}),p}catch(M){var f,v,b,g=null!==(f=null===(v=M.response)||void 0===v||null===(b=v.data)||void 0===b?void 0:b.error)&&void 0!==f?f:M;throw m.failure({error:g}),g}}))).apply(this,arguments)}},16546:function(t,e,i){"use strict";function n(t){return{objectId:t.msdyn_objectid,schemaName:t.msdyn_schemaname,subType:t.msdyn_subtype,primaryEntityName:t.msdyn_primaryentityname,relatedEntity:t.msdyn_relatedentity,relatedEntityAttribute:t.msdyn_relatedentityattribute}}i.d(e,"a",(function(){return n}))},16549:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i(12462),r=i(11818),a=i(11205),o=i(13794),s=i(16550);function l(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function d(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){l(a,n,r,o,s,"next",t)}function s(t){l(a,n,r,o,s,"throw",t)}o(void 0)}))}}function c(t,e){return u.apply(this,arguments)}function u(){return(u=d((function*(t,e){var{isActive:i,queryTypes:n,isDefault:r,entityTypeName:s,queryApis:l,environmentId:d,telemetryScope:c,team:u}=t,h=Object(o.k)(c,o.h.getViews,o.d.ViewDesigner,o.e.DataQueryFn,u,a.f.Medium,{isActive:i,queryTypes:n,isDefault:r,entityTypeName:s,queryApis:l});try{var m=yield e.fetchQuery({queryKey:["powerapps-ui-common","getViews",null!=d?d:"",null!=s?s:"",null!=i?i:"",null!=r?r:"",null!=n?n:""],queryFn:()=>y(t)});return h.complete(),m}catch(p){throw h.failure({error:p}),p}}))).apply(this,arguments)}function y(t){return h.apply(this,arguments)}function h(){return(h=d((function*(t){var e,{isActive:i,queryTypes:a,isDefault:o,entityTypeName:l,queryApis:d}=t,c=m(l,i,d,a,o),u="".concat(n.h).concat(n.nb,"/savedqueries").concat(c),y=yield Object(r.f)(u,{headers:{Accept:"application/json","Content-Type":"application/json"}});return null!=y&&null!==(e=y.data)&&void 0!==e&&e.value&&Array.isArray(y.data.value)?y.data.value.map(t=>s.a(t)):[]}))).apply(this,arguments)}function m(t,e,i,n,r){var a=[];if(t&&a.push("(returnedtypecode eq '".concat(t.toLowerCase(),"')")),null!=n&&n.length&&a.push("(querytype eq ".concat(n.join(" or querytype eq "),")")),void 0!==e&&a.push("(statuscode eq ".concat(e?1:0,")")),void 0!==r&&a.push("(isdefault eq ".concat(r,")")),i&&i.length>0){var o=[...i];o.indexOf("")>-1&&o.push(null),a.push("(".concat(o.map(t=>"(queryapi eq ".concat(null===t?"null":"'".concat(t,"'"),")")).join(" or "),")"))}return 0===a.length?"":"/Microsoft.Dynamics.CRM.RetrieveUnpublishedMultiple()?$filter=".concat(a.join(" and "))}},16551:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n=i(12462),r=i(13189),a=i(11818),o=i(16552),s=i(16555),l=i(16556),d=i(11205),c=i(13794);function u(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function y(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){u(a,n,r,o,s,"next",t)}function s(t){u(a,n,r,o,s,"throw",t)}o(void 0)}))}}function h(t){return m.apply(this,arguments)}function m(){return(m=y((function*(t){var{schemaName:e,queryClient:i,refetch:n,telemetryScope:r,team:a}=t,o=Object(c.k)(r,c.h.getRelationshipDefinitionBySchemaName,c.d.FormDesigner,c.e.DataQueryFn,a,d.f.MediumHigh,{schemaName:e});try{var s=yield i.fetchQuery(["getRelationshipDefinitionBySchemaName",e],()=>p(e),n?{staleTime:0,cacheTime:0}:{});return o.complete(),s}catch(l){return o.failure({error:l}),[]}}))).apply(this,arguments)}function p(t){return f.apply(this,arguments)}function f(){return(f=y((function*(t){var e,i,d="".concat(n.h).concat(n.nb,"/RelationshipDefinitions?$filter=SchemaName eq '").concat(t,"'"),c=yield a.f.get(d);if((null==c||null===(e=c.data)||void 0===e||null===(i=e.value)||void 0===i?void 0:i.length)>0){var u=c.data.value[0];switch(u.RelationshipType){case r.u.OneToManyRelationship:return[o.a(u)];case r.u.ManyToManyRelationship:return[s.a(u)];case r.u.ManyToOneRelationship:return[l.a(u)];default:throw new Error("No Relationship type found")}}return[]}))).apply(this,arguments)}},16552:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(13707),r=i.n(n);function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l=o(o({},i(16553).a),{},{schemaName:"SchemaName",isValidForAdvancedFind:"IsValidForAdvancedFind",referencedAttribute:"ReferencedAttribute",referencedEntityNavigationPropertyName:"ReferencedEntityNavigationPropertyName",referencingAttribute:"ReferencingAttribute",referencingEntityNavigationPropertyName:"ReferencingEntityNavigationPropertyName",referencingEntityTypeName:t=>t.RelationshipEntity||t.ReferencingEntity,isHierarchical:"IsHierarchical",referencedEntity:"ReferencedEntity",referencingEntity:"ReferencingEntity"});function d(t){return r()(l,t)}},16553:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));i(13707);var n=i(16554),r={id:"MetadataId",relationshipType:t=>t.EntityRelationshipType?t.EntityRelationshipType:t.RelationshipType,entity1AssociatedMenuConfiguration:t=>t.Entity1AssociatedMenuConfiguration?n.a(t.Entity1AssociatedMenuConfiguration):void 0,entity2AssociatedMenuConfiguration:t=>t.Entity2AssociatedMenuConfiguration?n.a(t.Entity2AssociatedMenuConfiguration):void 0,associatedMenuConfiguration:t=>t.AssociatedMenuConfiguration?n.a(t.AssociatedMenuConfiguration):void 0,isCustomizable:t=>{var e;return!(null===(e=t.IsCustomizable)||void 0===e||!e.Value)}}},16554:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i(13707),r=i.n(n),a={behavior:"Behavior",isCustomizable:"IsCustomizable",label:t=>{var e,i;return null!==(e=t.Label)&&void 0!==e&&e.LocalizedLabels?{localizedLabels:t.Label.LocalizedLabels?null===(i=t.Label)||void 0===i?void 0:i.LocalizedLabels.map(t=>({label:t.Label,languageCode:t.LanguageCode,isManaged:t.IsManaged,metadataId:t.MetadataId,hasChanged:t.HasChanged})):[],userLocalizedLabel:t.Label.UserLocalizedLabel?{label:t.Label.UserLocalizedLabel.Label,languageCode:t.Label.UserLocalizedLabel.LanguageCode,isManaged:t.Label.UserLocalizedLabel.IsManaged,metadataId:t.Label.UserLocalizedLabel.MetadataId,hasChanged:t.Label.UserLocalizedLabel.HasChanged}:void 0}:void 0}};function o(t){return r()(a,t)}},16555:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(13707),r=i.n(n);function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l=o(o({},i(16553).a),{},{referencingEntity:"RelationshipEntity",schemaName:"SchemaName",isValidForAdvancedFind:"IsValidForAdvancedFind",entity1LogicalName:"Entity1LogicalName",entity2LogicalName:"Entity2LogicalName",intersectEntityName:"ManyToManyRelationshipMetadata.IntersectEntity",entity1IntersectAttribute:"ManyToManyRelationshipMetadata.IntersectPrimaryAttribute",entity2IntersectAttribute:"ManyToManyRelationshipMetadata.IntersectRelatedAttribute",referencedAttribute:"ReferencedAttribute",referencingAttribute:"ReferencingAttribute"});function d(t){return r()(l,t)}},16556:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(13707),r=i.n(n);function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l=o(o({},i(16553).a),{},{schemaName:"SchemaName",isValidForAdvancedFind:"IsValidForAdvancedFind",referencedAttribute:"ReferencedAttribute",referencingAttribute:"ReferencingAttribute",referencingEntityTypeName:"RelationshipEntity",referencedEntity:"ReferencedEntity",referencingEntity:"ReferencingEntity",isHierarchical:"IsHierarchical"});function d(t){return r()(l,t)}},16557:function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return d})),i.d(e,"c",(function(){return c})),i.d(e,"d",(function(){return u}));var n=i(16474),r=i(16471),a=i(16472),o=i(16475),s=function(t){return t[t.NotLoaded=0]="NotLoaded",t[t.Loading=1]="Loading",t[t.Loaded=2]="Loaded",t}({});class l{constructor(t,e,i,n,o,s,l,d,c,u,y,h,m,p,f,v,b,g,M,C,O,A){this.id=void 0,this.name=void 0,this.displayName=void 0,this.externalName=void 0,this.schemaName=void 0,this.isCustomAttribute=void 0,this.baseDataType=void 0,this.dataType=void 0,this.dataTypeFormat=void 0,this.requiredLevel=void 0,this.entityLogicalName=void 0,this.optionsetProperties=void 0,this.isPersisted=void 0,this.isRequiredForForm=void 0,this.isValidForAdvancedFind=void 0,this.yomiOf=void 0,this.isValidForGrid=void 0,this.attributeOf=void 0,this.aggregateOf=void 0,this.calculationOf=void 0,this.targets=void 0,this.lookupStyle=void 0,this.minValue=void 0,this.maxValue=void 0,this.precision=void 0,this.precisionSource=void 0,this.isBaseCurrency=void 0,this.isValidForCreate=void 0,this.attributeType=void 0,this.format=void 0,this.formatName=void 0,this.isSearchable=void 0,this.isSecured=void 0,this.isAuditEnabled=void 0,this.description=void 0,this.isGlobalFilterEnabled=void 0,this.isSortableEnabled=void 0,this.sourceType=void 0,this.maxLength=void 0,this.imeMode=void 0,this.dateTimeBehavior=void 0,this.formulaDefinition=void 0,this.formulaDefinitionJson=void 0,this.isManaged=void 0,this.isCustomizable=void 0,this.canModifyAuditSettings=void 0,this.canBeSecuredForRead=void 0,this.canBeSecuredForCreate=void 0,this.canBeSecuredForUpdate=void 0,this.isValidForRead=void 0,this.isValidForUpdate=void 0,this.isValidForForm=void 0,this.isLogical=void 0,this.validForRead=void 0,this.isPrimaryId=void 0,this.optionsetReference=void 0,this.isRollupInfrastructure=void 0,this.hasMultipleLabels=void 0,this.sourceTypeMask=void 0,this.isRenameable=void 0,this.canModifyAdditionalSettings=void 0,this.requiredLevelManagedProperty=void 0,this.displayMask=void 0,this.isValidForMap=void 0,this.boolTrueOption=void 0,this.boolFalseOption=void 0,this.optionsetOptions=void 0,this.autoNumberFormat=void 0,this.id=t,this.name=e,this.schemaName=i,this.displayName=n,this.description=o,this.isCustomAttribute=s,this.dataType=l,this.dataTypeFormat=d,this.requiredLevel=c,this.entityLogicalName=u,this.optionsetProperties=y,this.isPersisted=h,this.isRequiredForForm=!r.a.IsNullOrUndefined(m)&&m,this.isValidForAdvancedFind=!r.a.IsNullOrUndefined(p)&&p,this.yomiOf=r.a.IsNullOrUndefined(f)?a.a.EmptyString:f,this.isValidForGrid=!r.a.IsNullOrUndefined(v)&&v,this.attributeOf=b,this.calculationOf=g,this.targets=M,this.isValidForCreate=C,this.isManaged=O,this.isValidForMap=!r.a.IsNullOrUndefined(A)&&A}AddRangeInformation(t,e,i){this.minValue=t,this.maxValue=e,this.precision=i}AddBooleanInformation(t,e){this.boolTrueOption=t,this.boolFalseOption=e}AddOptionsInformation(t){this.optionsetOptions=t}get AttributeBaseDataType(){return this.baseDataType}set AttributeBaseDataType(t){this.baseDataType=t}}class d{constructor(t){this.entityName=t,this.entityObjectTypeCode=void 0,this.entityId=void 0,this.attributes=void 0,this.entityAttributeMap=void 0,this.dataSource=void 0,this.dataProviderId=void 0,this.isCustomEntity=void 0,this.entityDisplayName=void 0,this.isManaged=void 0,this.canCreateForms=void 0,this.canCreateViews=void 0,this.canCreateAttributes=void 0,this.isCustomizable=void 0,this.isReadOnlyInMobileClient=void 0,this.isVisibleInMobileClient=void 0,this.canModifyMobileClientVisibility=void 0,this.isActivity=void 0,this.isChildEntity=void 0,this.isValidForAdvancedFind=void 0,this.displayCollectionName=void 0,this.logicalCollectionName=void 0,this.primaryNameAttribute=void 0,this.primaryIdAttribute=void 0,this.isBPFEntity=void 0,this.hasActivities=void 0,this.hasNotes=void 0,this.isKnowledgeManagementEnabled=void 0,this.schemaName=void 0,this.isArchivalEnabled=void 0,this.attributes=new Array,this.entityAttributeMap=new n.a}get EntityObjectTypeCode(){return this.entityObjectTypeCode}set EntityObjectTypeCode(t){this.entityObjectTypeCode=t}get HasActivities(){return this.hasActivities}set HasActivities(t){this.hasActivities=t}get HasNotes(){return this.hasNotes}set HasNotes(t){this.hasNotes=t}get IsActivity(){return this.isActivity}set IsActivity(t){this.isActivity=t}get IsChildEntity(){return this.isChildEntity}set IsChildEntity(t){this.isChildEntity=t}get IsValidForAdvancedFind(){return this.isValidForAdvancedFind}set IsValidForAdvancedFind(t){this.isValidForAdvancedFind=t}get IsCustomEntity(){return this.isCustomEntity}set IsCustomEntity(t){this.isCustomEntity=t}get IsBPFEntity(){return this.isBPFEntity}set IsBPFEntity(t){this.isBPFEntity=t}get IsKnowledgeManagementEnabled(){return this.isKnowledgeManagementEnabled}set IsKnowledgeManagementEnabled(t){this.isKnowledgeManagementEnabled=t}get IsVisibleInMobileClient(){return this.isVisibleInMobileClient}set IsVisibleInMobileClient(t){this.isVisibleInMobileClient=t}get CanModifyMobileClientVisibility(){return this.canModifyMobileClientVisibility}set CanModifyMobileClientVisibility(t){this.canModifyMobileClientVisibility=t}get DataSource(){return this.dataSource}set DataSource(t){this.dataSource=t}get DataProviderId(){return this.dataProviderId}set DataProviderId(t){this.dataProviderId=t}get EntityDisplayName(){return this.entityDisplayName}set EntityDisplayName(t){this.entityDisplayName=t}removeAttribute(t){var e=this.attributes.indexOf(t);-1!==e&&(this.attributes.splice(e,1),this.entityAttributeMap.remove(t.name))}getEntityAttributeByName(t){return this.entityAttributeMap.getValue(t)}containsEntityAttributeByName(t){return this.entityAttributeMap.containsKey(t)}updateAttribute(t){var e=this.attributes.indexOf(this.attributes.filter(e=>e.name===t.name)[0]);e>-1?(this.attributes[e]=t,this.entityAttributeMap.update(t.name,t)):(this.attributes.push(t),this.entityAttributeMap.add(t.name,t))}getFilteredEntityAttributeList(t){var e=new d(this.entityName);return this.attributes.filter(t).forEach(t=>{e.updateAttribute(t)}),e}isCurrencyBase(t){if(t.dataType&&t.dataType.toString()===o.c.Currency){var e=t.calculationOf;if(!r.a.IsNullOrUndefined(e)){var i=this.getEntityAttributeByName(e);if(!r.a.IsNullOrUndefined(i))return!0}}return!1}get CustomFieldsCount(){var t=0;return this.attributes.forEach(e=>{e.isCustomAttribute&&!this.isCurrencyBase(e)&&t++}),t}}class c extends l{constructor(t,e,i,n){super(t,e,i,n),this.relationship=void 0}static CreateEntityLookupAttribute(t,e,i){var n=new this(t.id,t.name,t.schemaName,t.description);return n.displayName=t.displayName,n.schemaName=t.schemaName,n.isCustomAttribute=t.isCustomAttribute,n.dataType=t.dataType,n.dataTypeFormat=t.dataTypeFormat,n.requiredLevel=t.requiredLevel,n.entityLogicalName=t.entityLogicalName,n.optionsetProperties=t.optionsetProperties,n.isPersisted=t.isPersisted,n.isRequiredForForm=t.isRequiredForForm,n.isValidForForm=t.isValidForForm,n.isValidForAdvancedFind=t.isValidForAdvancedFind,n.yomiOf=t.yomiOf,n.isValidForGrid=t.isValidForGrid,n.attributeOf=t.attributeOf,n.calculationOf=t.calculationOf,n.targets=t.targets,n.isValidForCreate=t.isValidForCreate,n.isSearchable=t.isSearchable,n.isSecured=t.isSecured,n.isAuditEnabled=t.isAuditEnabled,n.description=t.description,n.isGlobalFilterEnabled=t.isGlobalFilterEnabled,n.isSortableEnabled=t.isSortableEnabled,n.sourceType=t.sourceType,n.maxLength=t.maxLength,n.imeMode=t.imeMode,n.dateTimeBehavior=t.dateTimeBehavior,n.formulaDefinition=t.formulaDefinition,n.formulaDefinitionJson=t.formulaDefinitionJson,n.isValidForRead=t.isValidForRead,n.isValidForUpdate=t.isValidForUpdate,n.format=t.format,n.formatName=t.formatName,n.attributeType=t.attributeType,n.UpdateRelationship(e,i),n}UpdateRelationship(t,e){this.targets=t,this.relationship=e}}class u extends class{constructor(){this.displayName=void 0,this.logicalName=void 0,this.logicalCollectionName=void 0,this.objectTypeCode=void 0,this.primaryNameAttribute=void 0,this.primaryIdAttribute=void 0,this.id=void 0,this.isActivity=void 0,this.isActivityParty=void 0,this.workflowSupport=void 0,this.hasStateCode=void 0,this.isBPFEntity=void 0,this.privilegeList=void 0,this.isChildEntity=void 0,this.isValidForAdvancedFind=void 0,this.displayCollectionName=void 0,this.isVisibleInMobileClient=void 0,this.canModifyMobileClientVisibility=void 0,this.isConnectionsEnabled=void 0,this.canTriggerWorkflow=void 0,this.isCustomizable=void 0,this.canModifyAuditSettings=void 0,this.isEnabledForTrace=void 0,this.isDocumentManagementEnabled=void 0,this.isManaged=void 0,this.ownershipType=void 0,this.isCustomEntity=void 0,this.iconSmallName=void 0,this.isKnowledgeManagementEnabled=void 0,this.isStateModelAware=void 0,this.enforceStateTransitions=void 0}get DisplayName(){return this.displayName}set DisplayName(t){this.displayName=t}get LogicalName(){return this.logicalName}set LogicalName(t){this.logicalName=t}get LogicalCollectionName(){return this.logicalCollectionName}set LogicalCollectionName(t){this.logicalCollectionName=t}get ObjectTypeCode(){return this.objectTypeCode}set ObjectTypeCode(t){this.objectTypeCode=t}get PrimaryNameAttribute(){return this.primaryNameAttribute}set PrimaryNameAttribute(t){this.primaryNameAttribute=t}get PrimaryIdAttribute(){return this.primaryIdAttribute}set PrimaryIdAttribute(t){this.primaryIdAttribute=t}get Id(){return this.id}set Id(t){this.id=t}get IsActivity(){return this.isActivity}set IsActivity(t){this.isActivity=t}get IsActivityParty(){return this.isActivityParty}set IsActivityParty(t){this.isActivityParty=t}get WorkflowSupport(){return this.workflowSupport}set WorkflowSupport(t){this.workflowSupport=t}get HasStateCode(){return this.hasStateCode}set HasStateCode(t){this.hasStateCode=t}get IsBPFEntity(){return this.isBPFEntity}set IsBPFEntity(t){this.isBPFEntity=t}get Privileges(){return this.privilegeList}set Privileges(t){this.privilegeList=t}get IsChildEntity(){return this.isChildEntity}set IsChildEntity(t){this.isChildEntity=t}get IsValidForAdvancedFind(){return this.isValidForAdvancedFind}set IsValidForAdvancedFind(t){this.isValidForAdvancedFind=t}get DisplayCollectionName(){return this.displayCollectionName}set DisplayCollectionName(t){this.displayCollectionName=t}get IsConnectionsEnabled(){return this.isConnectionsEnabled}set IsConnectionsEnabled(t){this.isConnectionsEnabled=t}get IsEnabledForTrace(){return this.isEnabledForTrace}set IsEnabledForTrace(t){this.isEnabledForTrace=t}get CanModifyAuditSettings(){return this.canModifyAuditSettings}set CanModifyAuditSettings(t){this.canModifyAuditSettings=t}get IsManaged(){return this.isManaged}set IsManaged(t){this.isManaged=t}get IsCustomizable(){return this.isCustomizable}set IsCustomizable(t){this.isCustomizable=t}get CanTriggerWorkflow(){return this.canTriggerWorkflow}set CanTriggerWorkflow(t){this.canTriggerWorkflow=t}get IsDocumentManagementEnabled(){return this.isDocumentManagementEnabled}set IsDocumentManagementEnabled(t){this.isDocumentManagementEnabled=t}get OwnershipType(){return this.ownershipType}set OwnershipType(t){this.ownershipType=t}get IsKnowledgeManagementEnabled(){return this.isKnowledgeManagementEnabled}set IsKnowledgeManagementEnabled(t){this.isKnowledgeManagementEnabled=t}get IsCustomEntity(){return this.isCustomEntity}set IsCustomEntity(t){this.isCustomEntity=t}get IconSmallName(){return this.iconSmallName}set IconSmallName(t){this.iconSmallName=t}get IsStateModelAware(){return this.isStateModelAware}set IsStateModelAware(t){this.isStateModelAware=t}get EnforceStateTransitions(){return this.enforceStateTransitions}set EnforceStateTransitions(t){this.enforceStateTransitions=t}get IsVisibleInMobileClient(){return this.isVisibleInMobileClient}set IsVisibleInMobileClient(t){this.isVisibleInMobileClient=t}get CanModifyMobileClientVisibility(){return this.canModifyMobileClientVisibility}set CanModifyMobileClientVisibility(t){this.canModifyMobileClientVisibility=t}}{constructor(t){super(),this.entityAttributeList=void 0,this.attributeLoadState=void 0,this.optionSetLoadState=void 0,this.relatedMetadataLoadState=void 0,this.manyToOneRelationships=void 0,this.oneToManyRelationships=void 0,this.manyToManyRelationships=void 0,this.entityAttributeList=new d(t),this.attributeLoadState=s.NotLoaded,this.optionSetLoadState=s.NotLoaded,this.relatedMetadataLoadState=s.NotLoaded,this.manyToOneRelationships=new Array,this.oneToManyRelationships=new Array,this.manyToManyRelationships=new Array}get EntityAttributeList(){return this.entityAttributeList}set EntityAttributeList(t){this.entityAttributeList=t}get AttributeLoadState(){return this.attributeLoadState}set AttributeLoadState(t){this.attributeLoadState=t}get RelatedMetadataLoadState(){return this.relatedMetadataLoadState}set RelatedMetadataLoadState(t){this.relatedMetadataLoadState=t}get OptionSetLoadState(){return this.optionSetLoadState}set OptionSetLoadState(t){this.optionSetLoadState=t}get ManyToOneRelationships(){return this.manyToOneRelationships}set ManyToOneRelationships(t){this.manyToOneRelationships=t}get OneToManyRelationships(){return this.oneToManyRelationships}set OneToManyRelationships(t){this.oneToManyRelationships=t}get ManyToManyRelationships(){return this.manyToManyRelationships}set ManyToManyRelationships(t){this.manyToManyRelationships=t}get CumulativeLoadState(){return this.attributeLoadState===s.NotLoaded||this.optionSetLoadState===s.NotLoaded||this.relatedMetadataLoadState===s.NotLoaded?s.NotLoaded:this.attributeLoadState===s.Loading||this.optionSetLoadState===s.Loading||this.relatedMetadataLoadState===s.Loading?s.Loading:s.Loaded}ContainsManyToOneRelationship(t){return this.manyToOneRelationships.filter(e=>e.ReferencedEntity===t.ReferencedEntity&&e.ReferencedAttribute===t.ReferencedAttribute&&e.ReferencingAttribute===t.ReferencingAttribute).length>0}ContainsOneToManyRelationship(t){return this.oneToManyRelationships.filter(e=>e.ReferencingEntity===t.ReferencingEntity&&e.ReferencingAttribute===t.ReferencingAttribute&&e.ReferencedAttribute===t.ReferencedAttribute).length>0}ContainsManyToManyRelationship(t){return this.manyToManyRelationships.filter(e=>e.ReferencingEntity===t.ReferencingEntity&&e.ReferencingAttribute===t.ReferencingAttribute&&e.ReferencedAttribute===t.ReferencedAttribute&&e.IntersectEntity===t.IntersectEntity&&e.IntersectPrimaryAttribute===t.IntersectPrimaryAttribute&&e.IntersectRelatedAttribute===t.IntersectRelatedAttribute&&e.FromEntityAttribute===t.FromEntityAttribute&&e.ToEntityAttribute===t.ToEntityAttribute).length>0}}},16558:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(16474),r=i(16475);class a{static get Boolean(){return"Boolean"}static get Picklist(){return"Picklist"}static get State(){return"State"}static get Status(){return"Status"}}class o{static get ManyToOneRelationship(){return"ManyToOneRelationship"}static get OneToManyRelationship(){return"OneToManyRelationship"}static get ManyToManyRelationship(){return"ManyToManyRelationship"}}class s{static initializeTypes(){var t=new n.b;return(t=new n.b).add(r.c.TwoOptions,"Microsoft.Dynamics.CRM.BooleanAttributeMetadata"),t.add(r.c.OptionSet,"Microsoft.Dynamics.CRM.PicklistAttributeMetadata"),t.add(r.c.WholeNumber,"Microsoft.Dynamics.CRM.IntegerAttributeMetadata"),t.add(r.c.SingleLineofText,"Microsoft.Dynamics.CRM.StringAttributeMetadata"),t.add(r.c.FloatingPointNumber,"Microsoft.Dynamics.CRM.DoubleAttributeMetadata"),t.add(r.c.DecimalNumber,"Microsoft.Dynamics.CRM.DecimalAttributeMetadata"),t.add(r.c.Currency,"Microsoft.Dynamics.CRM.MoneyAttributeMetadata"),t.add(r.c.MultipleLineofText,"Microsoft.Dynamics.CRM.MemoAttributeMetadata"),t.add(r.c.DateTime,"Microsoft.Dynamics.CRM.DateTimeAttributeMetadata"),t.add(r.c.MultiSelectOptionSet,"Microsoft.Dynamics.CRM.MultiSelectPicklistAttributeMetadata"),t.add(r.c.Image,"Microsoft.Dynamics.CRM.ImageAttributeMetadata"),t.add(r.c.UniqueIdentifier,"Microsoft.Dynamics.CRM.UniqueIdentifierAttributeMetadata"),t.add(r.c.Customer,"Microsoft.Dynamics.CRM.ComplexLookupAttributeMetadata"),t.add(r.c.LookupType,"Microsoft.Dynamics.CRM.LookupAttributeMetadata"),t.add(r.c.Status,"Microsoft.Dynamics.CRM.StatusAttributeMetadata"),t.add(r.c.State,"Microsoft.Dynamics.CRM.StateAttributeMetadata"),t.add(o.OneToManyRelationship,"Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata"),t.add(r.c.PartyList,"Microsoft.Dynamics.CRM.LookupAttributeMetadata"),t.add(r.c.Owner,"Microsoft.Dynamics.CRM.LookupAttributeMetadata"),t.add(r.c.BigInt,"Microsoft.Dynamics.CRM.BigIntAttributeMetadata"),t}static getODataType(t){return s.oDataTypes.containsKey(t)?s.oDataTypes.getValue(t):null}}s.oDataTypes=s.initializeTypes();class l{static initializeTypes(){var t=new n.b;return(t=new n.b).add(a.Boolean,"Microsoft.Dynamics.CRM.BooleanOptionSetMetadata"),t.add(a.Picklist,"Microsoft.Dynamics.CRM.OptionSetMetadata"),t}static getODataType(t){return l.oDataTypes.containsKey(t)?l.oDataTypes.getValue(t):null}}l.oDataTypes=l.initializeTypes();class d{}d.OpportunityProduct=1083,d.QueueItem=2029,d.BulkOperation=4406,d.InvoiceDetail=1091,d.QuoteDetail=1085,d.SalesOrderDetail=1089,d.DynamicProperty=1048,d.ProductAssociation=1025,d.ProductSubstitute=1028,d.KnowledgeArticleIncident=9954,d.Annotation=5,d.SavedQuery=1039,d.ConnectionRoleObjectTypeCode=3233,d.ActivityParty=135,d.CustomerAddress=1071,d.ActivityMimeAttachment=1001},16559:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i(13794),r=i(11388),a=i(16544),o=i(16541),s=i(16560);function l(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function d(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){l(a,n,r,o,s,"next",t)}function s(t){l(a,n,r,o,s,"throw",t)}o(void 0)}))}}function c(t,e,i,n,r,a){return u.apply(this,arguments)}function u(){return(u=d((function*(t,e,i,o,s,l){var d=Object(n.k)(o,n.h.getEntityAttributes,n.d.FormDesigner,n.e.DataQueryFn,s,r.a.High);try{var c,u=yield t.fetchQuery({queryKey:a.a.getEntityTypesWithRelationships(e.name,null!==(c=i.entityTypeNames)&&void 0!==c?c:[""]),queryFn:()=>y(e,i),staleTime:"network-only"===l?0:void 0,cacheTime:"network-only"===l?0:void 0});return d.complete(),u}catch(h){throw d.failure({error:h}),h}}))).apply(this,arguments)}function y(t,e){return h.apply(this,arguments)}function h(){return(h=d((function*(t,e){if(!t)return[];var{entityTypeNames:i,filterEntities:n,solutionId:r,lcid:a}=e,l=yield Object(o.c)(t,{entityTypeNames:i,solutionId:r,filterEntities:n,lcid:a}),c=l.map(function(){var e=d((function*(e){var i=yield Object(s.a)({environment:t,entityTypeName:e.logicalName});e.relationships=i}));return function(t){return e.apply(this,arguments)}}());return yield Promise.all(c),l}))).apply(this,arguments)}},16560:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n=i(13039),r=i(16552),a=i(16556),o=i(16555);function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function u(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){c(a,n,r,o,s,"next",t)}function s(t){c(a,n,r,o,s,"throw",t)}o(void 0)}))}}function y(t){return h.apply(this,arguments)}function h(){return(h=u((function*(t){var{environment:e,entityTypeName:i}=t,s=yield Object(n.b)(e),d={entityName:i},c=yield s.fetchExpandedEntity(l(l({},d),{},{solutionName:"",solutionId:"",entityId:""}),{fetchModelComponents:!1,retryOnFailure:!1}),u={};return c&&(c.OneToManyRelationships&&(u.OneToManyRelationships=c.OneToManyRelationships.map(t=>r.a(l(l({},t),{},{EntityRelationshipType:t.RelationshipType,RelationshipEntity:t.ReferencingEntity})))),c.ManyToOneRelationships&&(u.ManyToOneRelationships=c.ManyToOneRelationships.map(t=>a.a(l(l({},t),{},{EntityRelationshipType:t.RelationshipType,RelationshipEntity:t.ReferencingEntity})))),c.ManyToManyRelationships&&(u.ManyToManyRelationships=c.ManyToManyRelationships.map(t=>o.a(l(l({},t),{},{EntityRelationshipType:t.RelationshipType}))))),u}))).apply(this,arguments)}},16561:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(11388),r=i(13794),a=i(16544),o=i(16562);function s(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function l(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){s(a,n,r,o,l,"next",t)}function l(t){s(a,n,r,o,l,"throw",t)}o(void 0)}))}}function d(t,e,i,n,r,a){return c.apply(this,arguments)}function c(){return(c=l((function*(t,e,i,o,s,l){var d=Object(r.k)(o,r.h.getEntityAttributes,r.d.FormDesigner,r.e.DataQueryFn,s,n.a.Medium);try{var c=yield t.fetchQuery({queryKey:a.a.getEntityAttributes(null==e?void 0:e.name,i.entityLogicalName),queryFn:()=>u(e,i),staleTime:"network-only"===l?0:void 0,cacheTime:"network-only"===l?0:void 0});return d.complete(),c}catch(y){throw d.failure({error:y}),y}}))).apply(this,arguments)}function u(t,e){return y.apply(this,arguments)}function y(){return(y=l((function*(t,e){var{entityLogicalName:i,isFilterable:n,lcid:r}=e;return yield Object(o.a)({environment:t,entityTypeName:i,isFilterable:n,displayNameLanguageCode:r})}))).apply(this,arguments)}},16743:function(t,e,i){"use strict";var n=i(16744);i.d(e,"a",(function(){return n.a}));var r=i(16752);i.d(e,"b",(function(){return r.a}))},16744:function(t,e,i){"use strict";i.d(e,"a",(function(){return I}));var n=i(11203),r=i(14558),a=i(14708),o=i(12142),s=i(12092),l=i(11035),d=i.n(l),c=i(16745),u=i(16749),y=i(16677),h=i(16750),m=i(16751),p=i(16743),f=i(12064),v=i(12072),b=i(13326);function g(t,e,i,n,r,a,o){try{var s=t[a](o),l=s.value}catch(d){return void i(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function M(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){g(a,n,r,o,s,"next",t)}function s(t){g(a,n,r,o,s,"throw",t)}o(void 0)}))}}function C(){return(C=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function O(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function A(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?O(Object(i),!0).forEach((function(e){T(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function T(t,e,i){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var E=Object(h.a)();class S extends d.a.Component{constructor(t){super(t),this.itemRefs={},this.expandItem=t=>{if(!this.state.expandedItemKeys.has(t)){var e=[...this.state.expandedItemKeys,t];this.setState({expandedItemKeys:new Set(e)})}},this.renderComponentTree=t=>{if(!t||t.length<1)return d.a.createElement("div",{"aria-live":"polite"},d.a.createElement(m.a,{errorMessage:this.props.t("FieldSelectionList.emptyFieldsList"),secondaryErrorMessage:this.props.strings.noComponentsToDisplay,displayIconName:this.props.tabIconName,customEmptyStateProps:this.props.customEmptyStateProps}));var e=Object(s.Y)(),i=S._mapComponentsToTreeItems(t),n=this.state.searchText?new Set(i.filter(t=>!this.state.collapsedItemKeysOnSearch.has(t.key)).map(t=>t.key)):this.state.expandedItemKeys,r={items:i,onRenderItemLabel:t=>this._onRenderItem(t),strings:{listAriaLabel:this.props.strings.listAriaLabel,moreCommandsAriaLabel:this.props.strings.moreCommandsAriaLabel},expandedItemKeys:n,onItemExpand:this._onItemExpand,onItemCollapse:this._onItemCollapse,onRenderItemContainer:this._onRenderItemContainer,selectedItemKeys:new Set,styles:{root:{backgroundColor:"transparent"},list:{width:"100%"},noExpandIcon:{width:"0"},levelIndentSpacer:{width:0},itemIsNotSelected:{selectors:{":hover":{backgroundColor:"transparent"}}},expandIconButton:{color:e.palette.neutralSecondary}},getItemStyle:this._getItemStyle};return d.a.createElement("div",{"aria-live":"polite",className:Object(s.eb)(E.listContainer,this.props.listContainerStyles)},d.a.createElement(a.b,r),this.props.strings.searchResultString&&d.a.createElement(b.a,{message:this.props.strings.searchResultString+r.items.length}))},this._getItemStyle=t=>t.isFolder?E.categoryItemLabel:E.componentItem,this._onItemExpand=(t,e)=>{if(this.state.searchText){var i=new Set(this.state.collapsedItemKeysOnSearch);i.delete(t.key),this.setState({collapsedItemKeysOnSearch:i})}else{var n=new Set(this.state.expandedItemKeys);n.add(t.key),this.setState({expandedItemKeys:n})}},this._onItemCollapse=(t,e)=>{if(this.state.searchText){var i=new Set(this.state.collapsedItemKeysOnSearch);i.add(t.key),this.setState({collapsedItemKeysOnSearch:i})}else{var n=new Set(this.state.expandedItemKeys);n.delete(t.key),this.setState({expandedItemKeys:n})}},this._onRenderItemContainer=(t,e,i,n,r)=>{var a;return null!==(a=t.children)&&void 0!==a&&a.length?d.a.createElement("div",{"data-testid":"".concat(t.key,"-container"),onClick:()=>i?this._onItemCollapse(t,n):this._onItemExpand(t,n)},r()):r()},this.onSearchTextChange=t=>{this.setState({searchText:t,collapsedItemKeysOnSearch:t?this.state.collapsedItemKeysOnSearch:new Set})},this.filterItems=(t,e)=>t.reduce((t,i)=>{var n,r=A({},i);return i.children&&(r.children=this.filterItems(i.children,e)),(null!==(n=r.children)&&void 0!==n&&n.length||!r.children&&!r.hideOnSearch&&i.label.toLowerCase().indexOf(e.toLowerCase())>-1)&&t.push(r),t},[]),this._onRenderItem=t=>{var e=this.findItem(t),i={id:e.id,label:e.label,onSelect:()=>this.itemOnSelect(e,t.key),iconSvgId:e.iconName||"",commands:e.commands,info:e.info,isDisabled:e.isDisabled&&e.isDisabled(),isDraggable:e.isDraggable,labelStyles:E.componentItemLabel,containerStyles:Object(s.eb)(E.componentItemLabelContainer,e.itemContainerStyles),actionButtonStyles:E.componentItemLabelActionButton};if(e.children)return d.a.createElement(d.a.Fragment,null,e.label);this.itemRefs[t.key]||(this.itemRefs[t.key]=d.a.createRef());var n=this.props.allowDrag&&!i.isDisabled?d.a.createElement(u.a,C({},i,{onDrop:(i,n)=>{this.itemOnDrop(e,t.key,i,n)}})):d.a.createElement(c.a,i),r=d.a.createElement(d.a.Fragment,null);if(this.state.insertionRenderer&&t.key===this.state.itemBeingConfiguredKey)switch(this.state.insertionRenderer.renderSurface){case p.b.Dialog:r=d.a.createElement(f.a,{hidden:void 0===this.state.itemBeingConfiguredKey,styles:E.dialogStyles,minWidth:E.dialogStyles.dialogWidth,maxWidth:E.dialogStyles.dialogWidth,dialogContentProps:{title:this.state.insertionRenderer.headerText,type:v.a.normal,styles:E.dialogContentStyles},modalProps:{onDismissed:this.dismissInsertionRenderer,isBlocking:!0},onDismiss:this.dismissInsertionRenderer},this.state.insertionRenderer?this.state.insertionRenderer.render(this.dismissInsertionRenderer,()=>({dispose:()=>null})):d.a.createElement(d.a.Fragment,null));break;case p.b.Callout:r=d.a.createElement(y.a,{calloutProps:{target:this.itemRefs[t.key].current,directionalHint:o.a.rightCenter,ariaLabelledBy:i.id}},d.a.createElement(y.b.Consumer,null,t=>this.state.insertionRenderer?d.a.createElement(d.a.Fragment,null,this.getHeaderText(this.state.insertionRenderer.headerText),this.state.insertionRenderer.render(this.dismissInsertionRenderer,t.onDismiss)):d.a.createElement(d.a.Fragment,null)))}return d.a.createElement("div",{className:E.componentItemContainer,ref:this.itemRefs[t.key]},n,r)},this.dismissInsertionRenderer=()=>{this.setState({insertionRenderer:void 0,itemBeingConfiguredKey:void 0})};var e=this.props.components.some(t=>"popular"===t.id);this.state={expandedItemKeys:new Set([e?"popular":"layout"]),collapsedItemKeysOnSearch:new Set}}render(){var t=this.state.searchText?this.filterItems(this.props.components,this.state.searchText):this.props.components,e={strings:{searchBoxPlaceholder:this.props.strings.searchBoxPlaceholder,searchBoxClearButtonTitle:this.props.strings.searchBoxClearButtonTitle,allItemsFilterItemText:"All"},items:t,shouldFilterItem:()=>!0,onChangeSearchText:this.onSearchTextChange,views:[{key:"list",text:"List",iconName:"List",onRenderView:this.renderComponentTree}],styles:{root:{height:"100%",display:"flex",flexDirection:"column"}}};return d.a.createElement("div",{className:E.componentPickerRoot},d.a.createElement(r.a,e))}findItem(t){for(var e of this.props.components){if(e.id===t.id)return e;if(e.children)for(var i of e.children)if(i.id===t.id)return i}throw new Error("item not found")}getHeaderText(t){if(t)return d.a.createElement("div",{style:E.headerContainer},d.a.createElement("h2",{style:E.headerText,title:t},t))}itemOnSelect(t,e){var i=this;return M((function*(){if(t.onSelect){var n=t.onSelect();n&&i.setState({insertionRenderer:n,itemBeingConfiguredKey:e})}}))()}itemOnDrop(t,e,i,n){var r=this;return M((function*(){if(t.onDrop){var a=t.onDrop(i,n);a&&r.setState({insertionRenderer:a,itemBeingConfiguredKey:e})}}))()}}S._mapComponentsToTreeItems=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.length?e[e.length-1]:null,r=0;r<t.length;r++){var a=t[r];e.push(A(A({},a),{},{key:"".concat(null!=n&&n.key?"".concat(n.key,"-"):"").concat(a.id),level:i,setSize:t.length,indexInParent:r,isFolder:!!a.children,disableSelection:a.isDisabled&&a.isDisabled(),disableFocus:!a.children})),a.children&&S._mapComponentsToTreeItems(a.children,e,i+1)}return e};var I=Object(n.r)("FieldSelectionList")(S)},16750:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(12092);function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function o(t,e,i){var n;return(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=()=>a(a({},Object(n.db)({componentPickerRoot:{height:"100%",width:"100%",fontSize:"14px"},listStyles:{width:"100%"},searchResult:{width:"1px",height:"1px",color:"transparent",background:"transparent",overflow:"hidden"},categoryItemLabel:{height:"36px",fontSize:"16px",fontWeight:n.l.semibold,lineHeight:"20px"},componentItem:{height:"max-content"},componentItemLabelContainer:{height:"max-content",alignItems:"center"},componentItemLabel:{lineHeight:"normal"},componentItemLabelActionButton:{height:"max-content"},componentItemContainer:{width:"100%",selectors:{"@media screen and (-ms-high-contrast: active)":{selectors:{button:{selectors:{":focus":{border:"2px solid highlight",color:"highlight"}}}}}}},listContainer:{width:"100%",flexGrow:1,height:"100%"}})),{},{headerContainer:l,headerText:d,dialogStyles:c,dialogContentStyles:u}),l={minHeight:52,paddingBottom:8,paddingTop:16,paddingLeft:24,paddingRight:24,textOverflow:"ellipsis",overflow:"hidden"},d={fontSize:20,lineHeight:"28px",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis"},c={root:{},main:{height:640,borderRadius:2},dialogWidth:"720px"},u={content:{},subText:{fontSize:14},header:{height:60},button:{padding:0,marginTop:22,marginRight:22,height:16,width:16,minWidth:16},inner:{paddingBottom:0},innerContent:{maxHeight:554,marginBottom:32},title:{fontSize:20,fontWeight:n.l.semibold,paddingBottom:8},topButton:{padding:0,margin:0}}},16751:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(13265),r=i(12339),a=i(12341),o=i(11035),s=i.n(o);function l(){return(l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}class d extends s.a.PureComponent{constructor(t){super(t)}render(){var{displayIconName:t,errorMessage:e,secondaryErrorMessage:i,dismissButtonText:o,onDismiss:d,customEmptyStateProps:c}=this.props;return e?s.a.createElement("div",{style:{paddingTop:32,paddingLeft:12,paddingRight:26}},s.a.createElement(n.a,l({icon:t,primaryMessage:e,secondaryMessage:i,callToActionText:o,callToActionProps:{onClick:d}},c))):s.a.createElement(r.a,{size:a.a.medium,style:{overflow:"hidden",margin:"auto",paddingRight:"52px"}})}}},16752:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(t){return t.Dialog="Dialog",t.Callout="Callout",t}({})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/form-designer~power-c~0b032d97.39a46b07.chunk.js.map