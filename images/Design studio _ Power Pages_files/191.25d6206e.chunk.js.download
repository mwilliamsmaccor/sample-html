/*! For license information please see 191.25d6206e.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{23465:function(e,t,a){"use strict";a.r(t),a.d(t,"VirtualTableCreatePanel",(function(){return j}));var n=a(11035),r=a.n(n),i=a(11203),o=a(12061),l=a(12065),c=a(13252),s=a(13251),u=a(17438),d=a(12457),m=a(15544),b=a(23436),v=a(23466),f=a(12159),p=a(17467),g=a(11205),C=a(12329),y=a(23469),h=a(23470),S=a(17459),T=a(17266),O=a(12170),E=a(13117);function D(){return(D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var j=Object(i.r)("PowerappsPortalEntities")(Object(l.a)(e=>{var{t:t,styles:a,theme:i,details:l}=e,{showPanel:y,onPanelDismiss:j,solutionId:N}=l,[w,P]=Object(n.useState)(!1),[V,x]=Object(n.useState)({showLoading:!0,message:t("Common.Loading")}),[k,L]=Object(n.useState)(""),[R,F]=Object(n.useState)(!1),{enableVirtualTableGA:M}=Object(b.g)(),{currentEnvironmentName:A}=Object(d.R)(),I=Object(u.b)({solutionId:N,t:t}),[z]=Object(n.useState)(Object(g.F)(m.a,p.n.VirtualTableCreationScenarioName,{environmentName:A,solutionId:N})),U=r.a.useMemo(()=>Object(o.a)()(a,{theme:i}),[a,i]);Object(n.useEffect)(()=>{var e=null==I?void 0:I.errorMessage;e?(L(e),F(!0),P(!1),Object(g.M)(m.a,{eventName:p.n.VirtualTableErrorPanel,eventData:{error:e}})):(L(""),F(!1))},[null==I?void 0:I.errorMessage]);var[W,K]=Object(n.useState)(!1),[B,q]=Object(n.useState)(!1),H=r.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;w||(t||!B?(j&&j(e,a),Object(g.O)(m.a,{eventName:p.n.DismissPanel,eventData:{createdData:e}}),e?z.complete({isTableCreated:!0}):z.completeWithWarning({isTableCreated:!1,scenarioHasError:R})):(K(!0),Object(g.O)(m.a,{eventName:p.n.CloseDialog,eventData:{createdData:e}})))}),[w,j,B,R]),_=r.a.useCallback((e,a,n)=>{var i,o,c,s=void 0===(null===(i=l.alternativeCreateConnectionDialogDetails)||void 0===i?void 0:i.isGA)||(null===(o=l.alternativeCreateConnectionDialogDetails)||void 0===o?void 0:o.isGA);return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{className:U.headerArea,horizontal:!0,horizontalAlign:"space-between"},r.a.createElement(C.a,{horizontal:!0,horizontalAlign:"center"},r.a.createElement("h1",{id:n,className:U.headerTitle},t("VirtualTables.Create.Header")),null!==(c=!M||!s)&&void 0!==c&&c&&r.a.createElement(v.a,{className:U.previewTag,previewTitle:t("Common.PreviewTitle"),previewDescription:t("Common.PreviewDescription")})),r.a.createElement(C.a,{className:U.headerCloseButton},r.a.createElement(E.a,{content:t("Common.Close")},r.a.createElement(O.a,{ariaLabel:t("Common.Close"),iconProps:{iconName:"Cancel"},onClick:()=>H(),className:U.headerCloseButtonLabel})))))},[H]),G=!I||!(null==I||!I.loading),Q=G||V.showLoading;return r.a.createElement(c.a,{role:"presentation",key:"CreateVirtualTableWizard",type:s.a.large,className:U.panel,isOpen:y,onDismiss:()=>H(),isLightDismiss:!w,onOuterClick:()=>H(),onLightDismissClick:()=>H(),hasCloseButton:!1,headerText:"virtualTableColumnPanel",onRenderHeader:_},Q&&r.a.createElement(f.a,{className:U.overlay}),r.a.createElement(S.a,{onPanelDismiss:()=>H(!1,!0),openDialog:W,setOpenDiscardDialog:K,titleAriaId:t("Common.Close"),translationFile:T.h}),r.a.createElement(h.a,D({},e,{isLoadingOrSaving:V,setIsLoadingOrSaving:x,errorMessage:k,dismissPanel:H,isCreateVirtualTableTriggered:w,setIsCreateVirtualTableTriggered:P,environmentName:A,solution:I,isParentLoading:!!G,setIsDirty:q,scenario:z,setScenarioHasError:F,alternativeCreateConnectionDialogDetails:l.alternativeCreateConnectionDialogDetails,useAlternativeCreateConnectionDialog:l.useAlternativeCreateConnectionDialog})))},y.a))},23466:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(12089),r=a(12086),i=a(12281),o=a(12261),l=a(12133),c=a(11035),s=a.n(c),u=a(23467),d=a(23468),m=e=>{var{previewTitle:t,previewDescription:a,className:c}=e,[m,b]=Object(n.a)(!1),v=Object(r.a)("preview-callout-button"),f=s.a.useCallback(e=>{var t,a;(null===(t=e.key)||void 0===t?void 0:t.toUpperCase())!==d.a.TAB&&(null===(a=e.key)||void 0===a?void 0:a.toUpperCase())!==d.a.ENTER||(e.stopPropagation(),e.preventDefault(),b.toggle())},[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.a,{id:v,styles:u.a,className:c,onClick:b.toggle,"aria-expanded":m},s.a.createElement(l.a,{iconName:"ConstructionCone",className:u.b.iconText}),t),m&&s.a.createElement(o.a,{target:"#".concat(v),onDismiss:b.toggle,role:"alert",setInitialFocus:!0,onKeyDown:f},s.a.createElement("div",{tabindex:0},s.a.createElement("p",{className:u.b.text},a))))}},23467:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));var n=a(12092),r=Object(n.db)({iconText:{marginRight:4},text:{width:240,padding:8,fontSize:n.k.small,textAlign:"center"}}),i={root:{minHeight:26,padding:"0 4px",fontSize:n.k.small},label:{fontWeight:n.l.regular}}},23468:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e){return e.CTRL="CTRL",e.SHIFT="SHIFT",e.ALT="ALT",e.CTRL_ALT_A="CTRL+ALT+A",e.ENTER="ENTER",e.TAB="TAB",e}({})},23469:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(12092),r=a(12079),i=Object(r.c)(window)<=r.a.large,o=e=>{var t=null==e?void 0:e.theme,a=null==t?void 0:t.palette;return{panel:{selectors:{".ms-Panel-content":{height:"100%",paddingLeft:0,paddingRight:0,paddingBottom:0,marginBottom:0,borderTop:"1px solid ".concat(null==a?void 0:a.neutralQuaternaryAlt)},".ms-Panel-scrollableContent":{height:"100%",overflow:"hidden"},".ms-Link":{textDecoration:"underline",color:"".concat(null==a?void 0:a.themeSecondary," !important"),selectors:{"&:hover":{color:null==a?void 0:a.themeSecondary},"&:active":{color:null==a?void 0:a.themeSecondary}}}}},mainContentArea:{fontSize:16,color:(null==a?void 0:a.neutralPrimary)||"#323130",selectors:{".ms-TooltipHost":{paddingLeft:5}},height:"100%"},errorMessageBar:{marginBottom:4},overlay:{backgroundColor:null==t?void 0:t.palette.white,opacity:.4,zindex:n.G.Layer+1},headerArea:{fontSize:16,color:(null==a?void 0:a.neutralPrimary)||"#323130",selectors:{".ms-TooltipHost":{paddingLeft:5}},paddingLeft:i?8:24,paddingRight:i?5:14,paddingBottom:i?4:10},headerTitle:{fontSize:20,fontWeight:600,color:(null==a?void 0:a.neutralPrimary)||"#323130",lineHeight:28,overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},headerCloseButtonLabel:{color:(null==a?void 0:a.neutralSecondary)||"#605E5C"},previewTag:{marginLeft:"12px !important",color:(null==a?void 0:a.neutralSecondary)||"#605E5C",borderColor:(null==a?void 0:a.neutralSecondary)||"#605E5C",height:"fit-content",minHeight:27,minWidth:90,fontSize:14,lineHeight:20}}}},23470:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(11035),r=a.n(n),i=a(12329),o=a(12336),l=a(14724),c=a(11203),s=a(12061),u=a(12065),d=a(13110),m=a(12281),b=a(12520),v=a(13139),f=a(13141),p=a(12079),g=a(15544),C=a(17467),y=a(11205),h=a(23471),S=a(23472),T=a(23473),O=a(23513),E=a(23514),D=a(23520),j=a(17464),N=a(12339),w=a(12341),P=a(17616);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){k(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var L=Object(c.r)("PowerappsPortalEntities")(Object(u.a)(e=>{var t,a,c,u,{t:V,styles:k,theme:L,isLoadingOrSaving:R,setIsLoadingOrSaving:F,errorMessage:M,dismissPanel:A,isCreateVirtualTableTriggered:I,setIsCreateVirtualTableTriggered:z,environmentName:U,solution:W,isParentLoading:K,setIsDirty:B,scenario:q,setScenarioHasError:H}=e,[_,G]=Object(n.useState)(M),[Q,Z]=Object(n.useState)(0),[Y,X]=Object(n.useState)(Object(O.a)(e.useAlternativeCreateConnectionDialog,e.alternativeCreateConnectionDialogDetails)),[J,$]=Object(n.useState)(Object(S.b)(V)),[ee,te]=Object(n.useState)(!1),[ae,ne]=Object(n.useState)(null!==(t=e.useAlternativeCreateConnectionDialog)&&void 0!==t&&t);Object(n.useEffect)(()=>{if(W){var e=Object(j.b)(null==W?void 0:W.customizationPrefix),t=!e||e.indexOf("_")<1?"new_":e;X(e=>x(x({},e),{},{customizationPrefix:Object(j.b)(null==W?void 0:W.customizationPrefix),connectionReferenceLogicalNamePrefix:t,solutionId:null==W?void 0:W.solutionId,solutionName:null==W?void 0:W.solutionUniqueName}))}},[null==W?void 0:W.customizationPrefix,null==W?void 0:W.solutionId,null==W?void 0:W.solutionUniqueName]);var{connections:re,loading:ie,errorMessage:oe}=Object(E.a)(V,null==W?void 0:W.solutionId,X),le=Object(p.c)(window)<=p.a.medium,ce=r.a.useMemo(()=>Object(s.a)()(k,{theme:L}),[k,L]);Object(n.useEffect)(()=>{var e,t,a,n=null==Y||null===(e=Y.loadingOrSavingState)||void 0===e?void 0:e.showLoading,r=null!=Y&&null!==(t=Y.loadingOrSavingState)&&void 0!==t&&t.showLoading?null==Y||null===(a=Y.loadingOrSavingState)||void 0===a?void 0:a.message:V("Common.Loading");F({showLoading:n,message:r})},[null==Y||null===(a=Y.loadingOrSavingState)||void 0===a?void 0:a.showLoading,null==Y||null===(c=Y.loadingOrSavingState)||void 0===c?void 0:c.message]),Object(n.useEffect)(()=>{var e=M||(null==Y?void 0:Y.errorMessage);e?(G(e),z(!1),H(!0),Object(y.M)(g.a,{eventName:C.n.VirtualTableError,eventData:{error:e}})):G("")},[M,null==Y?void 0:Y.errorMessage]),Object(n.useEffect)(()=>{var e=re,t=null==e?void 0:e.length;if(!ie&&!oe){if(t){var a=Object(S.b)(V);$(a),Object(y.O)(g.a,{eventName:C.n.InitialWizardStepsUpdated,eventData:{connectionsLength:t,steps:a}})}e&&te(!0)}},[re,ie,oe]);var se=Object(n.useMemo)(()=>{var e,t;return Object(D.a)(V,null===(e=J[Q])||void 0===e?void 0:e.key,U,X,null==Y?void 0:Y.refetchConnections,null==Y?void 0:Y.refetchConnectionDataset,null==Y?void 0:Y.refetchConnectionTable,(null==Y?void 0:Y.useAlternativeCreateConnectionDialog)||ae,ne,null==Y||null===(t=Y.alternativeCreateConnectionDialogDetails)||void 0===t?void 0:t.logEvent)},[V,J,Q,U,null==Y?void 0:Y.refetchConnections,null==Y?void 0:Y.refetchConnectionDataset,null==Y?void 0:Y.refetchConnectionTable,ae,null==Y||null===(u=Y.alternativeCreateConnectionDialogDetails)||void 0===u?void 0:u.logEvent]),ue=Object(n.useCallback)(()=>{B(!0),Object(S.f)(J,$,Q,Z,Y,X,z,V),null==q||q.progress({currentStepKey:J[Q].key})},[J,Q,Y,z,V]),[de,me]=r.a.useState(!1),be=r.a.useCallback(()=>{me(!0)},[]),ve=r.a.useMemo(()=>{var e,t,a,n,i;return J[Q].key===T.a.selectConnection&&!de?r.a.createElement(v.a,{messageBarType:f.a.info,isMultiline:!0,dismissButtonAriaLabel:V("Common.Close"),onDismiss:be},r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,ae?null===(e=Y.alternativeCreateConnectionDialogDetails)||void 0===e?void 0:e.availableApiMessageFirst:V("VirtualTables.AvailableApisMessage.firstSentence")),"Â ",ae?null===(t=Y.alternativeCreateConnectionDialogDetails)||void 0===t?void 0:t.availableApiMessageRest:V("VirtualTables.AvailableApisMessage.rest"),r.a.createElement(b.a,{href:ae?null===(a=Y.alternativeCreateConnectionDialogDetails)||void 0===a?void 0:a.availableApiMessageLink:P.a.connectionsSupportedVirtualTables,target:"_blank","aria-label":ae?null===(n=Y.alternativeCreateConnectionDialogDetails)||void 0===n?void 0:n.availableApiMessageLinkText:V("VirtualTables.AvailableApisMessage.linkText"),styles:{root:{paddingLeft:"0.4em"}}},ae?null===(i=Y.alternativeCreateConnectionDialogDetails)||void 0===i?void 0:i.availableApiMessageLinkText:V("VirtualTables.AvailableApisMessage.linkText")))):null},[J,Q,de,be,V]),fe=r.a.useCallback(()=>{X(e=>x(x({},e),{},{tableAlreadyExistsMessageDismissed:!0}))},[]),pe=r.a.useMemo(()=>Y.tableAlreadyExists&&!Y.tableAlreadyExistsMessageDismissed?r.a.createElement(v.a,{messageBarType:f.a.info,isMultiline:!1,dismissButtonAriaLabel:V("Common.Close"),onDismiss:fe},V("VirtualTables.TableAlreadyExists")):null,[V,Y.tableAlreadyExistsMessageDismissed,fe,Y.tableAlreadyExists]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{className:ce.mainContentArea},r.a.createElement(l.c,{progressProps:{currentindex:Q,stepNames:J.map(e=>e.nameTreeSection||""),computeAriaDescription:e=>e<Q?J[e].ariaDescription+" "+V("Common.Completed"):e===Q?J[e].ariaDescription+" "+V("Common.InProgress"):J[e].ariaDescription+" "+V("Common.Pending"),onProgressStepClick:e=>{},stepSummaries:J.map(e=>[]),stepStatuses:Object(S.d)(J,Q,Y),expandButtonLabel:V("VirtualTables.ExpandSteps"),collapseButtonLabel:V("Common.Collapse"),styles:{currentStep:{cursor:"auto !important"},futureStep:{cursor:"auto !important"},passedStep:{cursor:"auto !important"}}},footerProps:{renderFooterContent:e=>r.a.createElement(r.a.Fragment,null,e(),r.a.createElement(m.a,{disabled:I,text:V("Common.Cancel"),onClick:()=>A(),className:ce.cancelButton})),backButtonText:V("Common.Back"),canGoToNextStep:Object(S.a)(J,Q,Y,null==R?void 0:R.showLoading,M),canGoToPreviousStep:Q>0,continueButtonText:J.length&&J[Q].key===T.a.createVirtualTable?V("Common.Finish"):V("Common.Next"),shouldDisplayBackButton:!0,goToPreviousStep:()=>{Object(S.e)(J,Q,Z,Y,X),null==q||q.progress({currentStepKey:J[Q].key})},goToNextStep:ue,styles:{root:{position:"sticky",bottom:0}}},onRenderStep:()=>{var e;return r.a.createElement(r.a.Fragment,null,(K||R.showLoading)&&r.a.createElement(N.a,{size:w.a.large,label:R.message,ariaLabel:R.message,ariaLive:"assertive",labelPosition:"right",className:ce.spinner}),K||!ee?r.a.createElement(r.a.Fragment,null):r.a.createElement(i.a,{className:ce.mainContentArea},r.a.createElement(o.a,null,_&&!(null!=R&&R.showLoading)&&r.a.createElement(v.a,{className:ce.errorMessageBar,messageBarType:f.a.error,onDismiss:()=>G(""),dismissButtonAriaLabel:V("Common.Close")},_)),r.a.createElement(o.a,null,r.a.createElement(d.a,{className:ce.commandBarArea,items:se,ariaLabel:V("Common.CommandBar"),styles:{root:{visibility:null!=se&&se.length?"":"hidden",display:null!=se&&se.length||!(le||J.length&&(null===(e=J[Q])||void 0===e?void 0:e.key)===T.a.createVirtualTable)?void 0:"none"}}})),r.a.createElement(o.a,null,ve),r.a.createElement(o.a,null,pe),r.a.createElement(o.a,{className:ce.mainBodyContentArea},Object(S.c)(J,Q,Z,U,Y,X,I,z,ue,(e,t)=>A(e,!0,t),$,V,ae,ne))))},styles:Object(h.b)(e)})))},h.a))},23471:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(12092),r=a(12079),i=Object(n.X)(void 0,n.A-1),o=e=>{var t=null==e?void 0:e.theme,a=null==t?void 0:t.palette,i=Object(r.c)(window)<=r.a.medium;return{mainContentArea:{fontSize:16,color:(null==a?void 0:a.neutralPrimary)||"#323130",selectors:{".ms-TooltipHost":{paddingLeft:5}}},mainBodyContentArea:{marginTop:i?void 0:"36px !important",marginRight:32,marginLeft:32},cancelButton:{position:"absolute",right:28,display:i?"none":"block"},spinner:{position:"absolute",top:"45%",left:"50%",transform:"translateX(-50%)",zindex:n.G.Layer+1},errorMessageBar:{marginBottom:4},commandBarArea:{selectors:{".ms-CommandBar":{borderBottom:"1px solid ".concat(null==a?void 0:a.neutralLighter),paddingLeft:24},".ms-Button":{selectors:{":hover":{backgroundColor:null==a?void 0:a.neutralQuaternaryAlt}}}}}}},l=e=>{var t=null==e?void 0:e.theme,a=null==t?void 0:t.palette;return{root:{height:"100%",selectors:{".ba-wizard-progress":{[i]:{borderBottom:"1px solid ".concat(null==a?void 0:a.neutralQuaternaryAlt," !important")}}}},stepBody:{overflowY:"auto",height:"100%"},stepContainer:{margin:0,overflowY:"auto",overflowX:"auto",maxHeight:null!=e&&e.useAlternativeCreateConnectionDialog?"calc(100% - 74px)":"calc(100% - 61px)"}}}},23472:function(e,t,a){"use strict";a.d(t,"b",(function(){return E})),a.d(t,"a",(function(){return D})),a.d(t,"f",(function(){return j})),a.d(t,"e",(function(){return N})),a.d(t,"d",(function(){return w})),a.d(t,"c",(function(){return P}));var n=a(11035),r=a.n(n),i=a(14724),o=a(17360),l=a(23473),c=a(23474),s=a(23483),u=a(23487),d=a(23491),m=a(23499),b=a(23508),v=a(11205),f=a(15544),p=a(17467),g=a(23479),C=a(23490),y=a(15514),h=a(23510);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var E=e=>[l.a.selectConnection,l.a.selectTable,l.a.createVirtualTable].map(t=>T({key:t},V(e,t))),D=(e,t,a,n,r)=>{var i,o,c;if(n||r)return!1;switch(e[t].key){case l.a.selectConnection:return!a.errorMessage&&!!a.connectionSelected&&!(a.connectionSelected.isInError||a.connectionSelected.isAuthError);case l.a.createOrSelectConnectionReference:return a.shouldCreateConnectionReference?!!a.connectionReferenceParamsAreValid:!!a.connectionReferenceSelected;case l.a.chooseWorkspace:return!(null===(i=a.workspaceLakehouseDetails)||void 0===i||null===(o=i.workspaceSelected)||void 0===o||!o.length)&&!(null===(c=a.workspaceLakehouseDetails.lakehouseSelected)||void 0===c||!c.length)&&!!a.datasetSelected&&!!a.datasetSelected&&Object(g.c)(a.datasetSelected.id).trim().length>0&&Object(g.a)(a.datasetSelected.id).trim().length>0;case l.a.selectDataset:return Object(g.e)(a.connectionSelected)?!!a.datasetSelected&&Object(g.c)(a.datasetSelected.id).trim().length>0&&Object(g.a)(a.datasetSelected.id).trim().length>0:!!a.datasetSelected||!!a.customDatasetUrl&&!!a.validCustomDatasetUrl;case l.a.selectTable:return!!a.selectedTableExternalId&&!!a.selectedTableExternalName;case l.a.stageVirtualTable:return void 0!==a.primaryKeyName&&void 0!==a.primaryFieldName&&a.isTableDisplayNameValid&&a.isTablePluralNameValid&&a.isTableSchemaNameValid&&Object(C.a)(a.areColumnsDisplayNamesValid)&&Object(C.a)(a.areColumnsSchemaNamesValid);case l.a.createVirtualTable:return!0;default:return!1}},j=(e,t,a,n,r,i,c,s)=>{var u;switch(e[a].key){case l.a.selectConnection:var d=T({},r.connectionSelected);if(r.manuallyConfigureConnectionReference)R(e,t,s);else{var m;if(null!==(m=r.usableConnectionReferences)&&void 0!==m&&m.length)i(e=>T(T({},e),{},{connectionReferenceSelected:r.usableConnectionReferences[0]}));else{var b="".concat(null==d?void 0:d.apiDisplayName," ").concat(null==d?void 0:d.name),g=Object(o.b)(b);i(e=>T(T({},e),{},{shouldCreateConnectionReference:!0,connectionReferenceParamsAreValid:!0,connectionReferenceParams:{displayName:b,logicalName:g}}))}var C=e;if(d.apiDisplayName===y.a.MicrosoftFabric){var h="".concat(null==d?void 0:d.apiDisplayName," ").concat(null==d?void 0:d.name),S=Object(o.b)(h);i(e=>T(T({},e),{},{shouldCreateConnectionReference:!0,connectionReferenceParamsAreValid:!0,connectionReferenceParams:{displayName:h,logicalName:S}})),d.apiDisplayName=d.apiDisplayName===y.a.MicrosoftFabric?y.a.SQLServer:d.apiName,x(l.a.selectConnection,l.a.chooseWorkspace,C,t,s)}r.manuallyConfigureConnectionReference||(C=M(l.a.createOrSelectConnectionReference,e,t)),d.apiDisplayName!==y.a.Salesforce&&d.apiDisplayName!==y.a.Oracle||(C=M(l.a.selectDataset,e,t)),L(l.a.selectConnection,C,t,r.datasetSelected,s)}n(a+1);break;case l.a.chooseWorkspace:n(a+1);break;case l.a.createOrSelectConnectionReference:L(l.a.createOrSelectConnectionReference,e,t,r.datasetSelected,s),n(a+1);break;case l.a.selectDataset:if(r.customDatasetUrl&&!r.datasetSelected)Object(v.O)(f.a,{eventName:p.n.SearchCustomDatasetUrlEntered,eventData:{customDatasetUrl:"User has entered a custom dataset url",triggerSearchOfCustomDataset:!0}}),i(e=>T(T({},e),{},{triggerSearchOfCustomDataset:!0}));else{var O,E;if(Object(v.O)(f.a,{eventName:p.n.RecentDatasetUrlSelected,eventData:{customDataset:"It has been selected",triggerSearchOfCustomDataset:!1}}),null!=r&&null!==(O=r.alternativeCreateConnectionDialogDetails)&&void 0!==O&&O.logEvent)null==r||null===(E=r.alternativeCreateConnectionDialogDetails)||void 0===E||E.logEvent(p.b.TableOrDatasetSelected);n(a+1)}break;case l.a.selectTable:var D,j;if(r.configureTable)F(e,t,s),Object(v.O)(f.a,{eventName:p.n.ConfigureVirtualTableSelected,eventData:{configureVirtualTable:!0}});else if(M(l.a.stageVirtualTable,e,t),Object(v.O)(f.a,{eventName:p.n.ConfigureVirtualTableSelected,eventData:{configureVirtualTable:!1}}),null!=r&&null!==(D=r.alternativeCreateConnectionDialogDetails)&&void 0!==D&&D.logEvent)null==r||null===(j=r.alternativeCreateConnectionDialogDetails)||void 0===j||j.logEvent(p.b.TableOrDatasetSelected);n(a+1);break;case l.a.stageVirtualTable:var N,w;if(null!=r&&null!==(u=r.alternativeCreateConnectionDialogDetails)&&void 0!==u&&u.logEvent)null==r||null===(N=r.alternativeCreateConnectionDialogDetails)||void 0===N||N.logEvent(p.b.ConfigureVirtualTableSelected,{configureVirtualTable:null!==(w=r.configureTable)&&void 0!==w&&w});n(a+1);break;case l.a.createVirtualTable:c(!0)}},N=(e,t,a,n,r)=>{switch(e[t].key){case l.a.createOrSelectConnectionReference:r(e=>T(T({},e),{},{connectionReferenceSelected:void 0,shouldCreateConnectionReference:!1,connectionReferenceParamsAreValid:!1,connectionReferenceParams:void 0})),a(t-1);break;case l.a.selectDataset:A(l.a.createOrSelectConnectionReference,e)?r(e=>{var t;return T(T({},e),{},{datasetSelected:void 0,customDatasetUrl:I(null===(t=e.datasetSelected)||void 0===t?void 0:t.id,e.customDatasetUrl),triggerSearchOfCustomDataset:!1})}):r(e=>{var t;return T(T({},e),{},{datasetSelected:void 0,customDatasetUrl:I(null===(t=e.datasetSelected)||void 0===t?void 0:t.id,e.customDatasetUrl),triggerSearchOfCustomDataset:!1,connectionReferenceSelected:void 0,shouldCreateConnectionReference:!1,connectionReferenceParamsAreValid:!1,connectionReferenceParams:void 0})}),a(t-1);break;case l.a.chooseWorkspace:A(l.a.createOrSelectConnectionReference,e)?r(e=>{var t;return T(T({},e),{},{datasetSelected:void 0,customDatasetUrl:I(null===(t=e.datasetSelected)||void 0===t?void 0:t.id,e.customDatasetUrl),triggerSearchOfCustomDataset:!1,errorMessage:""})}):r(e=>{var t;return T(T({},e),{},{datasetSelected:void 0,customDatasetUrl:I(null===(t=e.datasetSelected)||void 0===t?void 0:t.id,e.customDatasetUrl),triggerSearchOfCustomDataset:!1,connectionReferenceSelected:void 0,shouldCreateConnectionReference:!1,connectionReferenceParamsAreValid:!1,connectionReferenceParams:void 0,errorMessage:""})}),a(t-1);break;case l.a.selectTable:A(l.a.selectDataset,e)||A(l.a.createOrSelectConnectionReference,e)?r(e=>{var t;return T(T({},e),{},{selectedTableExternalId:void 0,selectedTableExternalName:void 0,customDatasetUrl:I(null===(t=e.datasetSelected)||void 0===t?void 0:t.id,e.customDatasetUrl),triggerSearchOfCustomDataset:!1})}):r(e=>T(T({},e),{},{selectedTableExternalId:void 0,selectedTableExternalName:void 0,datasetSelected:void 0,customDatasetUrl:void 0,triggerSearchOfCustomDataset:!1})),a(t-1);break;case l.a.stageVirtualTable:r(e=>T(T({},e),{},{selectedTableExternalId:void 0,selectedTableOriginalExternalName:void 0,selectedTableOriginalPluralName:void 0,selectedTableExternalName:void 0,selectedTablePluralName:void 0,selectedTableSchemaName:void 0,primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,primaryKeyName:void 0,primaryFieldName:void 0,virtualTableColumns:void 0,tableAlreadyExists:!1,tableAlreadyExistsMessageDismissed:!1,customizationPrefixExistingTable:void 0})),a(t-1);break;case l.a.createVirtualTable:A(l.a.stageVirtualTable,e)||r(e=>T(T({},e),{},{selectedTableExternalId:void 0,selectedTableOriginalExternalName:void 0,selectedTableOriginalPluralName:void 0,selectedTableExternalName:void 0,selectedTablePluralName:void 0,selectedTableSchemaName:void 0,primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,primaryKeyName:void 0,primaryFieldName:void 0,virtualTableColumns:void 0,tableAlreadyExists:!1,tableAlreadyExistsMessageDismissed:!1,customizationPrefixExistingTable:void 0})),a(t-1)}},w=(e,t,a)=>e.map((e,n)=>null!=a&&a.errorMessage&&n===t?i.a.Error:n>=t?i.a.Empty:i.a.Valid),P=(e,t,a,n,i,o,g,C,y,S,O,E,D,j)=>{switch(e[t].key){case l.a.selectConnection:return r.a.createElement(c.a,{wizardState:i,setWizardState:o,useAlternativeCreateConnectionDialog:null!=D&&D,setUseAlternativeCreateConnectionDialog:j});case l.a.createOrSelectConnectionReference:return r.a.createElement(s.a,{wizardState:i,setWizardState:o});case l.a.selectDataset:return r.a.createElement(m.a,{wizardState:i,setWizardState:o,goToNextStep:()=>{a(t+1)}});case l.a.chooseWorkspace:return r.a.createElement(h.a,{wizardState:i,setWizardState:o,goToNextStep:()=>{a(t+1)}});case l.a.selectTable:return r.a.createElement(b.a,{wizardState:i,setWizardState:o});case l.a.stageVirtualTable:return r.a.createElement(u.a,{wizardState:i,setWizardState:o});case l.a.createVirtualTable:return r.a.createElement(d.a,{wizardState:i,setWizardState:o,isCreateVirtualTableTriggered:g,setIsCreateVirtualTableTriggered:C,dismissPanel:S,chooseDifferentList:()=>((e,t,a,n,r)=>{if(a(e=>T(T({},e),{},{selectedTableExternalId:void 0,selectedTableOriginalExternalName:void 0,selectedTableOriginalPluralName:void 0,selectedTableExternalName:void 0,selectedTablePluralName:void 0,selectedTableSchemaName:void 0,triggerSearchOfCustomDataset:!1,primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,primaryKeyName:void 0,primaryFieldName:void 0,virtualTableColumns:void 0,tableAlreadyExists:!1,tableAlreadyExistsMessageDismissed:!1,customizationPrefixExistingTable:void 0})),A(l.a.selectTable,e))t(e.findindex(e=>e.key===l.a.selectTable));else{Object(v.M)(f.a,{eventName:p.n.VirtualTableError,eventData:{error:"Choose different list error: selectTable step not found in steps list",stepsList:e}});var i=e.findindex(e=>e.key===l.a.stageVirtualTable);if(-1===i&&(i=e.findindex(e=>e.key===l.a.createVirtualTable)),-1===i)throw new Error("CreateVirtualTable step is missing.");var o=[...e];k(i-1,l.a.selectTable,o,n,r),t(i)}})(e,a,o,O,E),editTableConfiguration:()=>((e,t,a,n)=>{if(A(l.a.stageVirtualTable,e))t(e.findindex(e=>e.key===l.a.stageVirtualTable));else{var r=e.findindex(e=>e.key===l.a.createVirtualTable);if(-1===r)throw new Error("CreateVirtualTable step is missing.");var i=[...e];k(r-1,l.a.stageVirtualTable,i,a,n),t(r)}})(e,a,O,E)});default:return}},V=(e,t)=>{var a=l.b.get(t);if(!a)return{nameTreeSection:"",ariaDescription:""};var n=(null==a?void 0:a.nameTreeSection)||"",r=(null==a?void 0:a.ariaDescription)||"";return{nameTreeSection:e(n),ariaDescription:e(r)}},x=(e,t,a,n,r)=>{if(!A(t,a)){var i=a.findindex(t=>t.key===e),o=[...a];k(i,t,o,n,r)}},k=(e,t,a,n,r)=>{a.splice(e+1,0,T({key:t},V(r,t))),n(a)},L=(e,t,a,n,r)=>{n?M(l.a.selectDataset,t,a):x(e,l.a.selectDataset,t,a,r)},R=(e,t,a)=>{x(l.a.selectConnection,l.a.createOrSelectConnectionReference,e,t,a)},F=(e,t,a)=>{x(l.a.selectTable,l.a.stageVirtualTable,e,t,a)},M=(e,t,a)=>{var n=t.findindex(t=>t.key===e);if(n>=0){var r=[...t];return r.splice(n,1),a(r),r}return t},A=(e,t)=>(null==t?void 0:t.findindex(t=>t.key===e))>=0,I=(e,t)=>e===t?t:void 0},23473:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n=function(e){return e.selectConnection="selectConnection",e.createOrSelectConnectionReference="createOrSelectConnectionReference",e.selectDataset="selectDataset",e.selectTable="selectTable",e.stageVirtualTable="stageVirtualTable",e.createVirtualTable="createVirtualTable",e.chooseWorkspace="chooseWorkspace",e}({}),r=new Map([[n.selectConnection,{nameTreeSection:"VirtualTables.Steps.PickConnection",ariaDescription:"VirtualTables.Steps.PickConnection"}],[n.createOrSelectConnectionReference,{nameTreeSection:"VirtualTables.Steps.ConnectionReference",ariaDescription:"VirtualTables.Steps.ConnectionReference"}],[n.selectDataset,{nameTreeSection:"VirtualTables.Steps.ConnectionDetails",ariaDescription:"VirtualTables.Steps.ConnectionDetails"}],[n.selectTable,{nameTreeSection:"VirtualTables.Steps.ChooseData",ariaDescription:"VirtualTables.Steps.ChooseData"}],[n.stageVirtualTable,{nameTreeSection:"VirtualTables.Steps.ConfigureTable",ariaDescription:"VirtualTables.Steps.ConfigureTable"}],[n.createVirtualTable,{nameTreeSection:"VirtualTables.Steps.ReviewAndFinish",ariaDescription:"VirtualTables.Steps.ReviewAndFinish"}],[n.chooseWorkspace,{nameTreeSection:"VirtualTables.Steps.ChooseWorkspace",ariaDescription:"VirtualTables.Steps.ChooseWorkspace"}]])},23474:function(e,t,a){"use strict";a.d(t,"a",(function(){return G}));var n=a(11035),r=a.n(n),i=a(13060),o=a(11820),l=a(17476),c=a(13272),s=a(13174),u=a(12329),d=a(12336),m=a(12061),b=a(12065),v=a(11203),f=a(12457),p=a(16797),g=a(16799),C=a(17492),y=a(11205),h=a(17467),S=a(15544),T=a(13283),O=a(13287),E=a(12520),D=a(13281),j=a(13282),N=a(23475),w=a(12133),P=a(23477),V=a(23478),x=a(23479),k=a(11215),L=a(15510),R=a(15514),F=a(15517),M=a(13816),A=a(13029),I=a(23436),z=a(23480),U=a(23481);function W(e,t,a,n,r,i,o){try{var l=e[i](o),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function K(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){W(i,n,r,o,l,"next",e)}function l(e){W(i,n,r,o,l,"throw",e)}o(void 0)}))}}function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){H(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function H(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _=[R.b.SharePoint,R.b.SqlServer,R.b.MicrosoftFabric,R.b.SalesForce,R.b.Oracle],G=Object(v.r)("PowerappsPortalEntities")(Object(b.a)(e=>{var t,a,b,{t:v,styles:P,theme:W,wizardState:B,setWizardState:H,useAlternativeCreateConnectionDialog:G,setUseAlternativeCreateConnectionDialog:Q}=e,{allApis:Z,allConnections:Y,allConnectionReferences:X,connectionReferenceIdsInSolution:J,connectionSelected:$}=e.wizardState,ee=Object(n.useMemo)(()=>({key:"create-MicrosoftFabric",apiName:R.a.MicrosoftFabric,name:v("VirtualTables.Workspace.ConnectionName"),imageUrl:U.a,type:_[2],createShortcutForConnectionType:R.b.MicrosoftFabric}),[v]),{enableSalesforceConnector:te}=Object(I.m)(),{enableOracleConnector:ae}=Object(I.l)(),{currentEnvironment:ne}=Object(f.Q)(),{oid:re}=Object(n.useContext)(o.a),{enableFabricVirtualTablesCreation:ie}=Object(I.j)(),{data:oe}=Object(M.b)({settingName:"IsFabricVirtualTableEnabled",telemetryScope:A.c,enabled:ie}),le="false"!==(null==oe||null===(t=oe.orgDbOrgSettingValue)||void 0===t?void 0:t.toLowerCase()),ce=Object(g.e)(),se=(null==B||null===(a=B.alternativeCreateConnectionDialogDetails)||void 0===a?void 0:a.enableFabric)||!1,ue=!!(le&&ie&&(ce?se:ie)),de=r.a.useMemo(()=>r.a.createElement(V.a,{openDialog:B.openCreateConnectionDialog,setOpenDialog:e=>{Object(y.O)(S.a,{eventName:h.n.RefreshConnectionDialog,eventData:{openDialog:e}}),H(t=>q(q({},t),{},{openCreateConnectionDialog:e}))},refetchConnections:B.refetchConnections,setUseAlternativeDialog:e=>{Q&&(Object(y.O)(S.a,{eventName:h.n.RefreshConnectionDialog,eventData:{useAlternativeDialog:e}}),Q(e),H(t=>q(q({},t),{},{useAlternativeCreateConnectionDialog:e})))},useAlternativeDialog:G||(null==B?void 0:B.useAlternativeCreateConnectionDialog),alternativeDialogDetails:null==B?void 0:B.alternativeCreateConnectionDialogDetails,redirectLink:B.alternativeCreateConnectionRedirectUrl}),[B.openCreateConnectionDialog,B.refetchConnections,null==B?void 0:B.useAlternativeCreateConnectionDialog,null==B?void 0:B.alternativeCreateConnectionDialogDetails,B.alternativeCreateConnectionRedirectUrl,G,H,Q]),me=r.a.useCallback(e=>{var t,a,n;if(e)if(ue&&(null==e?void 0:e.apiName)===R.a.MicrosoftFabric&&null!=e&&e.connection){var r,i,o,l,c=q(q({},null==e?void 0:e.connection),{},{apiDisplayName:R.a.MicrosoftFabric,iconUri:U.a}),s="".concat(encodeURIComponent(null===(r=e.connection)||void 0===r||null===(i=r.connectionParameter)||void 0===i?void 0:i.server),",").concat(encodeURIComponent(null===(o=e.connection)||void 0===o||null===(l=o.connectionParameter)||void 0===l?void 0:l.database));H(e=>q(q({},e),{},{connectionSelected:c,datasetSelected:{id:s,displayName:s}}))}else if((null===(t=e.connection)||void 0===t?void 0:t.connectorType)!==R.b.SqlServer||Object(x.e)(e.connection))(null===(a=e.connection)||void 0===a?void 0:a.connectorType)===R.b.SalesForce||(null===(n=e.connection)||void 0===n?void 0:n.connectorType)===R.b.Oracle?H(t=>q(q({},t),{},{connectionSelected:e.connection,datasetSelected:{id:"default",displayName:"default"}})):H(t=>q(q({},t),{},{connectionSelected:e.connection,datasetSelected:void 0}));else{var u="".concat(encodeURIComponent(e.connection.connectionParameter.server),",").concat(encodeURIComponent(e.connection.connectionParameter.database));H(t=>q(q({},t),{},{connectionSelected:e.connection,datasetSelected:{id:u,displayName:u}}))}},[ue,H]),be=r.a.useCallback((e,t)=>{H(e=>q(q({},e),{},{manuallyConfigureConnectionReference:!!t}))},[H]),ve=r.a.useCallback((e,t)=>{H(e=>q(q({},e),{},{useEnvironmentVariables:!!t}))},[H]),[fe]=r.a.useState(new D.a({selectionMode:j.d.single,onSelectionChanged:()=>{me(fe.getSelection()[0])}}));r.a.useEffect(()=>{if($){var e,t,a=null!=X&&X.length?null==X?void 0:X.filter(e=>e.connectionId===$.name&&!e.isManaged).map(e=>q(q({},e),{},{isInCurrentSolution:!(null==J||!J.has(e.id))})).sort((e,t)=>e.isInCurrentSolution?t.isInCurrentSolution?0:-1:t.isInCurrentSolution?1:0):[];if(Object(y.O)(S.a,{eventName:h.n.ConnectionSelectedChanged,eventData:{connectionSelectedName:$.name,filteredConnectionReferences:null==a?void 0:a.length}}),null!=B&&null!==(e=B.alternativeCreateConnectionDialogDetails)&&void 0!==e&&e.logEvent)null==B||null===(t=B.alternativeCreateConnectionDialogDetails)||void 0===t||t.logEvent(h.b.ConnectionSelectedChanged,{connectionSelectedName:$.name,filteredConnectionReferences:null==a?void 0:a.length});H(e=>q(q({},e),{},{usableConnectionReferences:a}))}},[$,J,X,null==B||null===(b=B.alternativeCreateConnectionDialogDetails)||void 0===b?void 0:b.logEvent,null==B?void 0:B.alternativeCreateConnectionDialogDetails,H]);var pe=Object(n.useMemo)(()=>Object(m.a)()(P,{theme:W}),[P,W]),ge=Object(n.useCallback)((e,t,a)=>{var n,r;Object(y.O)(S.a,{eventName:h.n.BuildConnectionsList,eventData:{connectionsLength:null===(n=e)||void 0===n?void 0:n.length,apisLength:null==t?void 0:t.length}});var i=[];if(null!==(r=e)&&void 0!==r&&r.length){te||(e=e.filter(e=>e.connectorType!==R.b.SalesForce)),ae||(e=e.filter(e=>e.connectorType!==R.b.Oracle)),i=e.map(e=>{var t,a,n;return{key:e.name,id:e.id,apiName:null!==(t=e.apiDisplayName)&&void 0!==t?t:"",name:e.displayName,imageUrl:null!==(a=e.iconUri)&&void 0!==a?a:"",type:null!==(n=e.apiName)&&void 0!==n?n:"",isConnected:e.isConnected,isInError:e.isInError,isInAuthError:e.isAuthError,connection:e}});var o=Object(z.c)(e,R.a.SharedSql,re);if(a&&(-1!==o||!o)){var l=i[o].key;i.push(q(q({},i[o]),{},{apiName:ee.apiName,imageUrl:ee.imageUrl,connectionKey:l,key:ee.apiName}))}}return _.forEach(a=>{var n;if((te||a!==R.b.SalesForce)&&(ae||a!==R.b.Oracle)&&(null===(n=e)||void 0===n||!n.length||-1===e.findindex(e=>e.connectorType===a))){a===R.b.MicrosoftFabric&&i.every(e=>e.apiName!==R.a.MicrosoftFabric)&&ue&&i.push(ee);var r,o,l,c=null==t?void 0:t.find(e=>e.name===Object(F.b)(a));if(c)i.push({key:"create-"+a,apiName:null!==(r=c.apiDisplayName)&&void 0!==r?r:"",name:null!==(o=c.name)&&void 0!==o?o:"",imageUrl:null!==(l=c.iconUri)&&void 0!==l?l:"",type:a,createShortcutForConnectionType:a})}}),i.sort((e,t)=>{var a,n,r,i,o=null!==(a=e.createShortcutForConnectionType)&&void 0!==a?a:null===(n=e.connection)||void 0===n?void 0:n.connectorType,l=null!==(r=t.createShortcutForConnectionType)&&void 0!==r?r:null===(i=t.connection)||void 0===i?void 0:i.connectorType,c=_.indexOf(o),s=_.indexOf(l);return c===s?0:-1===c?1:-1===s||c<s?-1:1})},[re,ae,te,ee,ue]),Ce=Object(n.useMemo)(()=>ge(Y,Z,ue),[ge,Y,Z,ue]),ye=Object(C.d)(e=>({iconUri:e.imageUrl,iconAltText:e.apiName}),C.c.medium),he=r.a.useRef(null),Se=Object(n.useCallback)(e=>r.a.createElement(E.a,{className:pe.fixConnectionLink,href:G||e===R.b.MicrosoftFabric?void 0:Object(p.o)(null==ne?void 0:ne.name,!0,Object(F.b)(e),ce),target:"_blank","aria-label":v("VirtualTables.Connection.AddConnection"),onClick:K((function*(){if(ue&&e===R.b.MicrosoftFabric){Q&&(Q(!1),H(e=>q(q({},e),{},{useAlternativeCreateConnectionDialog:!1})));var t=null==Z?void 0:Z.find(e=>(null==e?void 0:e.name)===R.a.SharedSql),a=(null==t?void 0:t.oAuthRedirectUrl)||"",n={apiName:R.a.SharedSql,connectionId:Object(k.a)(),environmentId:(null==ne?void 0:ne.name)||"",refetchConnections:B.refetchConnections,connectionRedirectUrl:a};(yield Object(L.a)(n)).connectionCreated&&(Object(L.b)(n),H(e=>q(q({},e),{},{openCreateConnectionDialog:!0})))}else{var r,i;if(G){var o=Object(p.C)(null==ne?void 0:ne.name,!0,Object(F.b)(e));H(e=>q(q({},e),{},{useAlternativeCreateConnectionDialog:!0,alternativeCreateConnectionRedirectUrl:o,openCreateConnectionDialog:!0}))}else H(e=>q(q({},e),{},{openCreateConnectionDialog:!0}));if(Object(y.Y)(S.a,h.n.CreateConnectionShortcutClicked,{connectionType:e,useAlternativeDialog:G}),null!=B&&null!==(r=B.alternativeCreateConnectionDialogDetails)&&void 0!==r&&r.logEvent)null==B||null===(i=B.alternativeCreateConnectionDialogDetails)||void 0===i||i.logEvent(h.b.CreateConnection,{connectionType:e})}}))},r.a.createElement(w.a,{className:pe.addConnectionIcon,iconName:"Add"}),v("VirtualTables.Connection.AddConnection")),[Z,pe.addConnectionIcon,pe.fixConnectionLink,null==ne?void 0:ne.name,ue,ce,H,v,G,null==B?void 0:B.alternativeCreateConnectionDialogDetails,B.refetchConnections,Q]),Te=Object(n.useCallback)(()=>[ye,{key:"apiName",name:"",fieldName:"apiName",minWidth:150,isResizable:!0,className:pe.connectionApiName},{key:"name",name:"",fieldName:"name",minWidth:200,flexGrow:1,isResizable:!0,className:pe.connectionName,onRender:e=>{var{apiName:t,createShortcutForConnectionType:a,isInError:n,isInAuthError:i}=e;if(a)return Se(a);var o=ue&&t===R.a.MicrosoftFabric;return e&&ne&&(n||i)?r.a.createElement(E.a,{className:pe.fixConnectionLink,onClick:function(){var t=K((function*(t){if(o){var a=null==Z?void 0:Z.find(e=>(null==e?void 0:e.name)===R.a.SharedSql),n=(null==e?void 0:e.connectionKey)||"",r=(null==a?void 0:a.oAuthRedirectUrl)||"",i=q(q({},Object(z.a)(n,null==ne?void 0:ne.name,B.refetchConnections)),{},{connectionRedirectUrl:r});(yield Object(L.a)(i)).connectionCreated&&(Object(L.b)(i),H(e=>q(q({},e),{},{openCreateConnectionDialog:!0})))}}));return function(e){return t.apply(this,arguments)}}(),href:o?void 0:Object(p.t)(ne.name,e.type,e.key),target:"_blank","aria-label":v("VirtualTables.Connection.FixConnectionLinkText")},v("VirtualTables.Connection.FixConnectionLinkText")):e.name}},{key:"isInError",name:"",fieldName:"isInError",minWidth:30,maxWidth:30,flexGrow:1,onRender:e=>{var{createShortcutForConnectionType:t,isInError:a}=e;if(t)return null;var n=a?"Error":"Completed",i=v(a?"VirtualTables.Connection.ConnectionsNeedsAttentionAriaLabel":"VirtualTables.Connection.ValidConnectionAriaLabel"),o=a?pe.connectionErrorIndicator:pe.connectionSuccessIndicator;return r.a.createElement(w.a,{className:o,iconName:n,ariaLabel:i})}}],[Se,Z,pe.connectionApiName,pe.connectionErrorIndicator,pe.connectionName,pe.connectionSuccessIndicator,pe.fixConnectionLink,ne,ye,ue,H,v,B.refetchConnections]),Oe=r.a.useMemo(()=>Te(),[Te]);r.a.useEffect(()=>{if($)switch(null==$?void 0:$.apiDisplayName){case R.a.MicrosoftFabric:fe.selectToKey($.apiDisplayName);break;default:fe.selectToKey($.name)}else null!=Y&&Y.length&&fe.selectToindex(0)},[Y,$,fe]);var{enableEnvironmentVariablesForVirtualTables:Ee}=Object(I.h)(),De=r.a.useCallback(()=>r.a.createElement(u.a,{tokens:{childrenGap:20}},r.a.createElement(d.a,null,r.a.createElement(c.a,{label:v("VirtualTables.Connection.ManualConfigurationOfReference"),ariaLabel:v("VirtualTables.Connection.ManualConfigurationOfReference"),checked:B.manuallyConfigureConnectionReference,onChange:be})),Ee&&r.a.createElement(d.a,null,r.a.createElement(c.a,{label:v("VirtualTables.Connection.UseEnvironmentVariables"),ariaLabel:v("VirtualTables.Connection.UseEnvironmentVariables"),checked:B.useEnvironmentVariables,onChange:ve}))),[v,B.manuallyConfigureConnectionReference,B.useEnvironmentVariables,be,Ee,ve]);return r.a.createElement(N.a,{titleText:v("VirtualTables.Connection.Connections"),subtitleText:v("VirtualTables.Connection.ChooseConnection")},r.a.createElement(u.a,null,de,r.a.createElement(d.a,null,r.a.createElement("div",{ref:he},r.a.createElement(T.a,{ariaLabelForGrid:v("VirtualTables.Connection.ConnectionsListAriaLabel"),isHeaderVisible:!1,items:Ce,columns:Oe,selection:fe,checkboxVisibility:O.a.hidden,selectionPreservedOnEmptyClick:!0,onShouldVirtualize:()=>!1}))),!($&&$.apiDisplayName===R.a.MicrosoftFabric)&&r.a.createElement(d.a,null,r.a.createElement(i.a,{text:v("VirtualTables.Connection.AdvancedOptions"),onRenderContent:De,isHiddenOnDismiss:!0,styles:l.a,buttonAs:s.a,className:pe.accordion}))))},P.a))},23475:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(12061),r=a(12065),i=a(12707),o=a(11035),l=a(23476),c=Object(n.a)(),s=Object(r.a)(e=>{var t=c(e.styles,{theme:e.theme}),{titleText:a,subtitleText:n}=e;return o.createElement(o.Fragment,null,a&&o.createElement(i.a,{className:t.mainContentTitle},a),n&&o.createElement(i.a,{className:t.mainContentSubTitle},e.subtitleText),o.createElement("div",{className:t.mainContentArea},e.children))},l.a)},23476:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>{var{palette:t}=e.theme;return{mainContentArea:{fontSize:14,color:(null==t?void 0:t.neutralPrimary)||"#323130",height:"100%",marginTop:32},mainContentTitle:{fontSize:16,fontWeight:600,lineHeight:20,color:(null==t?void 0:t.neutralPrimary)||"#323130"},mainContentSubTitle:{fontSize:14,fontWeight:400,lineHeight:20,color:(null==t?void 0:t.neutralPrimary)||"#323130"}}}},23477:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({connectionApiName:{fontWeight:600,fontSize:14},connectionName:{textAlign:"right"},fixConnectionLink:{fontSize:"12px !important"},connectionSuccessIndicator:{color:"#107C10",fontSize:16},connectionErrorIndicator:{color:"#D83B01",fontSize:16},accordion:{marginTop:16},addConnectionIcon:{fontSize:14,paddingRight:8,verticalAlign:"bottom"}})},23478:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(11035),r=a(12064),i=a(12072),o=a(12166),l=a(12281),c=a(12280),s=a(11204),u=a(11205),d=a(15544),m=a(17467),b=e=>{var{openDialog:t,setOpenDialog:a,refetchConnections:b,setUseAlternativeDialog:v,useAlternativeDialog:f,alternativeDialogDetails:p,redirectLink:g}=e,{title:C,bodyContent:y,primaryButtonText:h,cancelButtonText:S,primaryButtonAriaLabel:T,primaryButtonIconName:O,logEvent:E}=p||{},D={main:{maxWidth:450}},{t:j}=Object(s.f)("PowerappsPortalEntities"),N=n.useMemo(()=>({titleAriaId:"RefreshConnectionDialog",isBlocking:!0,styles:D}),[]);return n.createElement(r.a,{hidden:!t,onDismiss:()=>{a(!1),v&&p&&p.title&&v(!0)},dialogContentProps:{type:i.a.normal,title:f?C:j("Common.ApplyChanges"),closeButtonAriaLabel:j("Common.Cancel"),subText:f?y:j("VirtualTables.Connection.RefreshConnections")},modalProps:N},n.createElement(o.a,null,n.createElement(l.a,{onClick:()=>{a(!1),v&&p&&p.title&&v(!0)},text:f?S:j("Common.Cancel")}),n.createElement(c.a,{onClick:()=>{if(f&&v)return Object(u.Y)(d.a,m.n.AlternativeConnectionDialogClicked,{useAlternativeDialog:f}),E&&E(m.b.AlternativeConnectionDialogClicked),void v(!1);b&&(b(),E&&E(m.b.RefreshConnections)),a(!1),v&&p&&p.title&&v(!0)},text:f?h:j("Common.Refresh"),href:f?g:void 0,target:f?"_blank":void 0,iconProps:f?{iconName:O}:void 0,ariaLabel:f?T:j("Common.Refresh")})))}},23479:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(15514),r=e=>{var t,a;return{serverName:null!==(t=null==e?void 0:e.split(",")[0])&&void 0!==t?t:"",databaseName:null!==(a=null==e?void 0:e.split(",")[1])&&void 0!==a?a:""}},i=e=>r(e).serverName,o=e=>r(e).databaseName,l=e=>{var t,a;return(null==e||null===(t=e.connectionParameter)||void 0===t?void 0:t.name)===n.c.AAD||(null==e||null===(a=e.connectionParameter)||void 0===a?void 0:a.name)===n.c.WindowsAuthNonShared},c=e=>({workspace:(null==e?void 0:e.workspaceSelected)||"",lakehouse:(null==e?void 0:e.lakehouseSelected)||""})},23480:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(15517),r=a(15514),i=e=>({id:null==e?void 0:e.id,apiId:null==e?void 0:e.apiId,displayName:null==e?void 0:e.displayName,name:null==e?void 0:e.name,isInError:null==e?void 0:e.isInError,isAuthError:null==e?void 0:e.isAuthError,isConnected:null==e?void 0:e.isConnected,isOnPrem:null==e?void 0:e.isOnPrem,iconUri:null==e?void 0:e.iconUri,statusErrorMessage:null==e?void 0:e.statusErrorMessage,primaryRuntimeUrl:null==e?void 0:e.primaryRuntimeUrl,apiDisplayName:null==e?void 0:e.apiDisplayName,apiName:null==e?void 0:e.apiName,connectionParameter:null==e?void 0:e.connectionParameter,createdByUserId:null==e?void 0:e.createdByUserId,connectorType:Object(n.c)(null==e?void 0:e.apiId)}),o=(e,t,a)=>e.findindex(e=>{var n;return(null===(n=e.connectionParameter)||void 0===n?void 0:n.name)===r.c.AAD&&e.apiName===t&&e.createdByUserId===a}),l=(e,t,a)=>({apiName:r.a.SharedSql,connectionId:e,environmentId:t,refetchConnections:a})},23481:function(e,t,a){"use strict";var n=a(23482),r=a.n(n);a.d(t,"a",(function(){return r.a}))},23482:function(e,t,a){e.exports=a.p+"static/media/MicrosoftFabricLogo.e0056a0f.svg"},23483:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(11035),r=a.n(n),i=a(12061),o=a(12065),l=a(14546),c=a(14620),s=a(12329),u=a(12336),d=a(11203),m=a(11205),b=a(15544),v=a(17467),f=a(23484),p=a(23475),g=a(23485);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){h(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function h(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var S=function(e){return e.UseExisting="UseExisting",e.CreateNew="CreateNew",e}(S||{}),T=Object(d.r)("PowerappsPortalEntities")(Object(o.a)(e=>{var{t:t,styles:a,theme:o,wizardState:d,setWizardState:f}=e,{usableConnectionReferences:C,connectionReferenceSelected:h,shouldCreateConnectionReference:T}=d,[O,E]=r.a.useState(null),[D,j]=r.a.useState(T?S.CreateNew:S.UseExisting),N=r.a.createRef(),w=r.a.useMemo(()=>Object(i.a)()(a,{theme:o}),[a,o]);r.a.useEffect(()=>{var e;null===(e=N.current)||void 0===e||e.focus()},[]);var P=r.a.useCallback((e,t)=>{var a;t&&(f(e=>y(y({},e),{},{connectionReferenceSelected:t.data})),Object(m.O)(b.a,{eventName:v.n.ConnectionReferenceSelected,eventData:{connectionReferenceId:null===(a=t.key)||void 0===a?void 0:a.toString()}}))},[f]),V=r.a.useCallback((e,t)=>{var a;t&&(j(t.key),t.key===S.CreateNew?f(e=>y(y({},e),{},{connectionReferenceSelected:void 0,shouldCreateConnectionReference:!0,connectionReferenceParamsAreValid:!1})):f(e=>y(y({},e),{},{shouldCreateConnectionReference:!1})),Object(m.O)(b.a,{eventName:v.n.SelectOrCreateChoiceChanged,eventData:{key:null===(a=t.key)||void 0===a?void 0:a.toString()}}))},[f]),x=Object(n.useMemo)(()=>{return null!=(e=C)&&e.length?e.map(e=>{var t=e.displayName||e.name;return{key:e.id,text:t,ariaLabel:t,data:e}}):[];var e},[C]),k=Object(n.useMemo)(()=>[{key:S.UseExisting,text:t("VirtualTables.ConnectionReference.UseExisting"),disabled:!(null!=C&&C.length)},{key:S.CreateNew,text:t("VirtualTables.ConnectionReference.CreateNew")}],[C]);r.a.useEffect(()=>{h?E(h.id):null!=C&&C.length&&D===S.UseExisting?(E(C[0].id),f(e=>y(y({},e),{},{connectionReferenceSelected:C[0]}))):E(null)},[C,h,D,f]),r.a.useEffect(()=>{null!=C&&C.length||(j(S.CreateNew),f(e=>y(y({},e),{},{shouldCreateConnectionReference:!0})))},[C]);var L=r.a.useCallback(()=>D===S.UseExisting?r.a.createElement(c.a,{className:w.connectionReferenceDropdown,dropdownWidth:0,options:x,label:t("VirtualTables.ConnectionReference.DropdownLabel"),ariaLabel:t("VirtualTables.ConnectionReference.DropdownLabel"),multiSelect:!1,onChange:P,selectedKey:O}):r.a.createElement(g.a,{wizardState:d,setWizardState:f}),[D,O,d,f,P]);return r.a.createElement(p.a,{titleText:t("VirtualTables.ConnectionReference.ChooseReferenceTitle"),subtitleText:t("VirtualTables.ConnectionReference.ChooseReferenceSubtitle")},r.a.createElement(s.a,{tokens:{childrenGap:20}},r.a.createElement(u.a,null,r.a.createElement(l.a,{componentRef:N,options:k,onChange:V,selectedKey:D})),r.a.createElement(u.a,null,L())))},f.a))},23484:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({connectionReferenceDropdown:{maxWidth:350}})},23485:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(11035),r=a.n(n),i=a(12329),o=a(12336),l=a(12061),c=a(12065),s=a(14563),u=a(14649),d=a(11203),m=a(17360),b=a(17259),v=a(17266),f=a(23486);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){C(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var y=function(e){return e.logicalName="connectionreferencelogicalname",e.displayName="connectionreferencedisplayname",e}(y||{}),h=Object(d.r)("PowerappsPortalEntities")(Object(c.a)(e=>{var{t:t,styles:a,theme:c,wizardState:d,setWizardState:f}=e,{allConnectionReferences:p,connectionReferenceParams:C,connectionReferenceLogicalNamePrefix:h}=d,S=Object(n.useRef)(null),T=null==C?void 0:C.displayName,O=null==C?void 0:C.logicalName,[E,D]=Object(n.useState)(!0),[j,N]=Object(n.useState)(!O||O===Object(m.b)(T)),[w,P]=Object(n.useState)({formResults:{[y.displayName]:T,[y.logicalName]:O}}),V=Object(n.useCallback)(e=>{if(0===(null==e?void 0:e.trim().length))return t("VirtualTables.ConnectionReference.Validation.Required")},[]),x=Object(n.useMemo)(()=>E?[]:[u.j(t("VirtualTables.ConnectionReference.Validation.Required")),u.e(v.e.displayNameMaxLength,()=>Object(b.c)(t("VirtualTables.ConnectionReference.Validation.MaxFieldLength"),v.e.displayNameMaxLength.toLocaleString())),V],[E]),k=Object(n.useMemo)(()=>null==p?void 0:p.map(e=>e.name),[p]),L=Object(n.useCallback)(e=>{if(null!=k&&k.includes(h+(null!=e?e:"")))return t("VirtualTables.ConnectionReference.Validation.UniqueName")},[h,k]),R=Object(n.useMemo)(()=>E?[]:[L,u.j(t("VirtualTables.ConnectionReference.Validation.Required")),u.i(/^[\w\d!\.\{\}]*$/,t("VirtualTables.ConnectionReference.Validation.InvalidCharacters")),u.e(v.e.logicalNameMaxLength,()=>Object(b.c)(t("VirtualTables.ConnectionReference.Validation.MaxFieldLength"),v.e.logicalNameMaxLength.toLocaleString()))],[E,L]),F=Object(n.useMemo)(()=>Object(l.a)()(a,{theme:c}),[a,c]),M=Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";P(e=>({formResults:g(g({},e.formResults),{},{[y.displayName]:t})})),D(!1)}),[]),A=Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";P(e=>({formResults:g(g({},e.formResults),{},{[y.logicalName]:t})})),t!==Object(m.b)(w.formResults[y.displayName])&&N(!1),D(!1)}),[w.formResults[y.displayName]]);return r.a.useEffect(()=>{var e=w.formResults[y.displayName];if(j&&e){var t,a=Object(m.b)(e);null===(t=S.current)||void 0===t||t.setValue(a),P(e=>({formResults:g(g({},e.formResults),{},{[y.logicalName]:a})}))}},[j,w.formResults[y.displayName]]),r.a.useEffect(()=>{var e=w.formResults[y.displayName],t=w.formResults[y.logicalName],a=!!e&&x.every(t=>!t(e)),n=!!t&&R.every(e=>!e(t));f(r=>g(g({},r),{},{connectionReferenceParamsAreValid:a&&n,connectionReferenceParams:{displayName:e,logicalName:t}}))},[w.formResults,x,R]),r.a.createElement(s.Form,{showErrorsWhenPristine:!0},r.a.createElement(i.a,{tokens:{childrenGap:10}},r.a.createElement(o.a,null,r.a.createElement(s.FormTextInput,{textFieldProps:{className:F.displayNameField,label:t("VirtualTables.ConnectionReference.DisplayName"),ariaLabel:t("VirtualTables.ConnectionReference.DisplayName"),required:!0,onChange:M},inputKey:y.displayName,value:w.formResults[y.displayName],validators:x,debounceInterval:10})),r.a.createElement(o.a,null,r.a.createElement(s.FormTextInput,{textFieldProps:{className:F.logicalNameField,label:t("VirtualTables.ConnectionReference.LogicalName"),ariaLabel:t("VirtualTables.ConnectionReference.LogicalName"),prefix:h,required:!0,onChange:A},componentRef:S,inputKey:y.logicalName,value:w.formResults[y.logicalName],validators:R,debounceInterval:10}))))},f.a))},23486:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({displayNameField:{maxWidth:350},logicalNameField:{maxWidth:350}})},23487:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(11035),r=a.n(n),i=a(12336),o=a(12329),l=a(11203),c=a(12061),s=a(14610),u=a(14620),d=a(12065),m=a(12707),b=a(23488),v=a(23489),f=a(23490),p=a(11205),g=a(15544),C=a(17467),y=a(17464),h=a(17488),S=a(23475),T=a(17266),O=a(17348),E=a(17360);function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){N(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var w=Object(l.r)("PowerappsPortalEntities")(Object(d.a)(e=>{var t,a,d,b,{t:D,styles:N,theme:w,wizardState:P,setWizardState:V}=e,x=Object(n.useMemo)(()=>Object(c.a)()(N,{theme:w}),[N,w]),k=r.a.useMemo(()=>Object(l.g)(),[]),L=!P.primaryFieldCandidates||!P.primaryKeyCandidates,{loading:R,errorMessage:F,candidate:M}=Object(v.a)({connectionId:P.connectionSelected.name,connectorId:P.connectionSelected.apiId,dataSet:P.datasetSelected.id,tableId:P.selectedTableExternalId},g.a,D("Common.Request.Failed"),!!L);Object(n.useEffect)(()=>{if(void 0!==M)if(Object(f.d)(M.tableId)){var[e,t]=Object(f.c)(M.schemaName);V(a=>j(j({},a),{},{primaryKeyCandidates:[M.primaryKey],primaryFieldCandidates:[M.primaryField],virtualTableColumns:M.virtualTableColumns.map(f.g),primaryKeyName:M.primaryKey,primaryFieldName:M.primaryField,selectedTableExternalName:M.displayName,selectedTablePluralName:M.pluralName,selectedTableSchemaName:t,errorMessage:"",loadingOrSavingState:{showLoading:!1,message:""},areColumnsDisplayNamesValid:new Array(M.virtualTableColumns.length).fill(!0),areColumnsSchemaNamesValid:new Array(M.virtualTableColumns.length).fill(!0),tableAlreadyExists:!0,tableAlreadyExistsMessageDismissed:!1,customizationPrefixExistingTable:e+"_"}))}else{var a,n,r,i,o,l;if((null===(a=M.primaryKeyCandidates)||void 0===a?void 0:a.length)<1)V(e=>j(j({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:D("VirtualTables.Configure.ErrorPrimaryKey"),loadingOrSavingState:{showLoading:!1,message:""}})),Object(p.O)(g.a,{eventName:C.n.PrimaryKeyError,eventData:{message:"Table does not have primary key",value:null===(i=M.primaryKeyCandidates)||void 0===i?void 0:i.length,connectionId:null===(o=P.connectionSelected)||void 0===o?void 0:o.id,connectionApiId:null===(l=P.connectionSelected)||void 0===l?void 0:l.apiId}});else if((null===(n=M.primaryFieldCandidates)||void 0===n?void 0:n.length)<1){var c,s,u;V(e=>j(j({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:D("VirtualTables.Configure.ErrorPrimaryField"),loadingOrSavingState:{showLoading:!1,message:""}})),Object(p.O)(g.a,{eventName:C.n.PrimaryFieldError,eventData:{message:"Table does not have primary field candidates",value:null===(c=M.primaryFieldCandidates)||void 0===c?void 0:c.length,connectionId:null===(s=P.connectionSelected)||void 0===s?void 0:s.id,connectionApiId:null===(u=P.connectionSelected)||void 0===u?void 0:u.apiId}})}else if(null!==(r=M.virtualTableColumns)&&void 0!==r&&r.length)V(e=>j(j({},e),{},{primaryKeyCandidates:M.primaryKeyCandidates,primaryFieldCandidates:M.primaryFieldCandidates,virtualTableColumns:M.virtualTableColumns.map(f.g),primaryKeyName:M.primaryKeyCandidates[0],primaryFieldName:M.primaryFieldCandidates[0],selectedTableExternalName:e.selectedTableOriginalExternalName,selectedTablePluralName:e.selectedTableOriginalPluralName,selectedTableSchemaName:Object(E.b)(e.selectedTableOriginalExternalName),errorMessage:"",loadingOrSavingState:{showLoading:!1,message:""},areColumnsDisplayNamesValid:new Array(M.virtualTableColumns.length).fill(!0),areColumnsSchemaNamesValid:new Array(M.virtualTableColumns.length).fill(!0),tableAlreadyExists:!1,tableAlreadyExistsMessageDismissed:!1}));else{var d,m,b;V(e=>j(j({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:D("VirtualTables.Configure.ErrorColumns"),loadingOrSavingState:{showLoading:!1,message:""}})),Object(p.O)(g.a,{eventName:C.n.ColumnsError,eventData:{message:"Table does not have columns",value:null===(d=M.virtualTableColumns)||void 0===d?void 0:d.length,connectionId:null===(m=P.connectionSelected)||void 0===m?void 0:m.id,connectionApiId:null===(b=P.connectionSelected)||void 0===b?void 0:b.apiId}})}}},[M]),Object(n.useEffect)(()=>{F&&V(e=>j(j({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:F,loadingOrSavingState:{showLoading:!1,message:""}}))},[F]),Object(n.useEffect)(()=>{(R||""===P.customizationPrefix)&&V(e=>j(j({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:"",loadingOrSavingState:{showLoading:!0,message:D("VirtualTables.LoadingRequiredFields")}}))},[R,P.customizationPrefix]);var A=()=>!(R||P.loadingOrSavingState.showLoading||F),I=r.a.useMemo(()=>P.virtualTableColumns&&P.primaryKeyName?Object(f.b)(P.virtualTableColumns,P.primaryKeyName):-1,[P.virtualTableColumns,P.primaryKeyName]),z=r.a.useMemo(()=>P.virtualTableColumns&&P.primaryFieldName?Object(f.b)(P.virtualTableColumns,P.primaryFieldName):-1,[P.virtualTableColumns,P.primaryFieldName]),U=A()?P.tableAlreadyExists?P.customizationPrefixExistingTable:P.customizationPrefix:void 0,W=Object(n.useCallback)((e,t,a)=>{var n="";if(t!==a)if(Object(f.d)(e)){var r=Object(y.f)(h.m,U+e,D("Entities.FormMessage.MustStartWithLetterOrUnderscoreAndContinue"));n=Object(f.d)(r)?r:Object(f.e)(e,t,P.virtualTableColumns,a,D("VirtualTables.Configure.UniqueName"))}else n=D("VirtualTables.Configure.MustHaveValue");return P.areColumnsSchemaNamesValid[t]!==!n&&V(e=>j(j({},e),{},{areColumnsSchemaNamesValid:Object(f.j)(!n,t,e.areColumnsSchemaNamesValid)})),n},[D,P.areColumnsSchemaNamesValid,P.primaryKeyName]);return r.a.createElement(S.a,{titleText:D("VirtualTables.Steps.ConfigureTable"),subtitleText:D("VirtualTables.Configure.Configure")},r.a.createElement(o.a,{horizontal:!0,wrap:!0,tokens:{childrenGap:12}},r.a.createElement(i.a,{grow:1,basis:250,style:{marginBottom:15}},r.a.createElement(s.a,{autoFocus:!0,label:D("VirtualTables.Configure.DisplayName"),ariaLabel:D("VirtualTables.Configure.DisplayName"),maxLength:T.g.entityDisplayNameMax,required:!0,value:A()?P.selectedTableExternalName:"",onChange:(e,t)=>{V(e=>j(j({},e),{},{selectedTableExternalName:t||"",selectedTablePluralName:Object(y.c)(k,null!=t?t:"")})),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"displayNameTable"}})},onGetErrorMessage:e=>!A()||Object(f.d)(e)?"":D("VirtualTables.Configure.MustHaveValue"),onNotifyValidationResult:(e,t)=>{V(t=>j(j({},t),{},{isTableDisplayNameValid:!e}))}})),r.a.createElement(i.a,{grow:1,basis:250,style:{marginBottom:15}},r.a.createElement(s.a,{label:D("VirtualTables.Configure.PluralName"),ariaLabel:D("VirtualTables.Configure.PluralName"),required:!0,maxLength:T.g.entityPluralNameMax,value:A()?P.selectedTablePluralName:"",onChange:(e,t)=>{V(e=>j(j({},e),{},{selectedTablePluralName:t||""})),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"pluralNameTable"}})},onGetErrorMessage:e=>!A()||Object(f.d)(e)?"":D("VirtualTables.Configure.MustHaveValue"),onNotifyValidationResult:(e,t)=>{V(t=>j(j({},t),{},{isTablePluralNameValid:!e}))}}))),r.a.createElement(o.a,{horizontal:!0,wrap:!0,tokens:{childrenGap:12}},r.a.createElement(i.a,{grow:1,basis:250,style:{marginBottom:15}},r.a.createElement(s.a,{label:D("VirtualTables.Configure.SchemaName"),ariaLabel:D("VirtualTables.Configure.SchemaName"),required:!0,disabled:P.tableAlreadyExists,prefix:U,value:A()?P.selectedTableSchemaName:"",onChange:(e,t)=>{V(e=>j(j({},e),{},{selectedTableSchemaName:t||""})),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"schemaNameTable"}})},onGetErrorMessage:e=>A()?Object(f.d)(e)?Object(y.f)(h.m,U+e,D("Entities.FormMessage.MustStartWithLetterOrUnderscoreAndContinue")):D("VirtualTables.Configure.MustHaveValue"):"",onNotifyValidationResult:(e,t)=>{V(t=>j(j({},t),{},{isTableSchemaNameValid:!e}))}})),r.a.createElement(i.a,{grow:1,basis:250},r.a.createElement(u.a,{label:D("VirtualTables.Configure.PrimaryField"),ariaLabel:D("VirtualTables.Configure.PrimaryField"),required:!0,disabled:!P.primaryFieldCandidates||(null===(t=P.primaryFieldCandidates)||void 0===t?void 0:t.length)<=1||P.tableAlreadyExists,selectedKey:P.primaryFieldName,options:A()?Object(f.f)(P.primaryFieldCandidates):[],onChange:(e,t)=>{V(e=>{var a;return j(j({},e),{},{primaryFieldName:null==t||null===(a=t.key)||void 0===a?void 0:a.toString()})}),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"primaryFieldTable"}})}}))),r.a.createElement(o.a,{horizontal:!0,wrap:!0,tokens:{childrenGap:12},style:{marginBottom:20}},r.a.createElement(i.a,{grow:1,basis:250},r.a.createElement(u.a,{label:D("VirtualTables.Configure.PrimaryKey"),ariaLabel:D("VirtualTables.Configure.PrimaryKey"),required:!0,disabled:!P.primaryKeyCandidates||(null===(a=P.primaryKeyCandidates)||void 0===a?void 0:a.length)<=1||P.tableAlreadyExists,selectedKey:P.primaryKeyName,options:A()?Object(f.f)(P.primaryKeyCandidates):[],onChange:(e,t)=>{V(e=>{var a;return j(j({},e),{},{primaryKeyName:null==t||null===(a=t.key)||void 0===a?void 0:a.toString()})}),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"primaryKeyTable"}})}})),r.a.createElement(i.a,{grow:1,basis:250},r.a.createElement(r.a.Fragment,null))),null!==(d=P.virtualTableColumns)&&void 0!==d&&d.length?r.a.createElement("hr",{className:x.divider}):r.a.createElement(r.a.Fragment,null),A()?r.a.createElement(o.a,{style:{marginTop:25},tokens:{childrenGap:8}},r.a.Children.toArray(null===(b=P.virtualTableColumns)||void 0===b?void 0:b.map((e,t)=>{return a=e,u=(n=t)===(l=I),d=n===z,b=(c=0===n)?D("VirtualTables.Configure.ExternalColumn"):"".concat(D("VirtualTables.Configure.ExternalColumn")," ").concat(a.externalName),v=u?O.i:a.schemaName,y=A()?P.tableAlreadyExists&&d?P.customizationPrefixExistingTable:P.customizationPrefix:void 0,r.a.createElement(i.a,null,r.a.createElement(o.a,{horizontal:!0,wrap:!0,tokens:{childrenGap:8}},r.a.createElement(i.a,{grow:1,basis:150},r.a.createElement(s.a,{tabindex:-1,readOnly:!0,label:c?D("VirtualTables.Configure.ExternalColumn"):void 0,ariaLabel:b,borderless:!0,value:a.externalName})),r.a.createElement(i.a,{grow:1,basis:150},r.a.createElement(s.a,{required:c,label:c?D("VirtualTables.Configure.DisplayName"):void 0,ariaLabel:D("VirtualTables.Configure.DisplayName"),maxLength:T.d.displayNameMax,defaultValue:a.displayName,onChange:(e,t)=>{V(e=>j(j({},e),{},{virtualTableColumns:Object(f.h)(null!=t?t:"",n,e.virtualTableColumns)})),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"displayNameColumn",currentindex:n,isPrimaryKey:u,isPrimaryField:d}})},onGetErrorMessage:e=>Object(f.d)(e)?"":D("VirtualTables.Configure.MustHaveValue"),onNotifyValidationResult:(e,t)=>{P.areColumnsDisplayNamesValid[n]!==!e&&V(t=>j(j({},t),{},{areColumnsDisplayNamesValid:Object(f.j)(!e,n,t.areColumnsDisplayNamesValid)}))}})),r.a.createElement(i.a,{grow:1,basis:150},r.a.createElement(s.a,{key:P.primaryKeyName,onRenderLabel:()=>c?r.a.createElement(m.a,{"aria-label":"".concat(D("VirtualTables.Configure.SchemaName")," ").concat(y),required:!0,id:"schema-name-configure-virtual-table"},D("VirtualTables.Configure.SchemaName")):null,"aria-labelledby":"schema-name-configure-virtual-table",maxLength:T.d.schemaNameMax,prefix:y,defaultValue:v,readOnly:u,disabled:u||P.tableAlreadyExists&&d,onChange:(e,t)=>{V(e=>j(j({},e),{},{virtualTableColumns:Object(f.i)(null!=t?t:"",n,e.virtualTableColumns)})),Object(p.O)(g.a,{eventName:C.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"schemaNameColumn",currentindex:n,isPrimaryKey:u,isPrimaryField:d}})},errorMessage:W(P.virtualTableColumns[n].schemaName,n,l)})),r.a.createElement(i.a,{grow:.5,basis:30},r.a.createElement(r.a.Fragment,null))));var a,n,l,c,u,d,b,v,y}))):r.a.createElement(r.a.Fragment,null))},b.a))},23488:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>{var t,a=null==e?void 0:e.theme;return{divider:{height:1,width:"100%",backgroundColor:"".concat((null==a||null===(t=a.palette)||void 0===t?void 0:t.neutralLight)||"#EDEBE9"),borderBottomWidth:0,borderTopWidth:0}}}},23489:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(11035),r=a(13029),i=a(11205),o=a(15530),l=a(12304),c=a(11818),s=a(15517),u=a(15514),d=a(15531),m=a(15529);function b(e,t,a,n,r,i,o){try{var l=e[i](o),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function v(e,t,a,v){var f,p,g=r.g.getVirtualTableCandidate,[C,y]=Object(n.useState)(),[h,S]=Object(n.useState)(""),{isInitialLoading:T,data:O}=Object(l.a)({queryKey:["powerapps-ui-common","VirtualTableCandidate",e.connectionId,e.connectorId,e.dataSet,e.tableId],queryFn:(f=function*(){var t,a,n,r,o,l,b,v,f,p,g,C,y,h,S,T,O={connection_id:e.connectionId,connector_id:e.connectorId,dataset_value:e.dataSet,table_id:e.tableId};switch(Object(s.c)(O.connector_id)){case u.b.SqlServer:null!=e.dataSet&&""!==e.dataSet||(O.dataset_value="default,default");break;case u.b.SharePoint:O.dataset_value=encodeURIComponent(encodeURIComponent(O.dataset_value))}var E={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",team:i.j.PowerappsPortal,data:O},D="".concat(m.a,"msdyn_get_required_fields"),j=yield Object(c.f)(D,E);return{tableId:null!==(t=null==j||null===(a=j.data)||void 0===a?void 0:a.table_id)&&void 0!==t?t:"",displayName:null!==(n=null==j||null===(r=j.data)||void 0===r?void 0:r.table_display_name)&&void 0!==n?n:"",pluralName:null!==(o=null==j||null===(l=j.data)||void 0===l?void 0:l.table_plural_name)&&void 0!==o?o:"",schemaName:null!==(b=null==j||null===(v=j.data)||void 0===v?void 0:v.table_schema_name)&&void 0!==b?b:"",primaryKey:null!==(f=null==j||null===(p=j.data)||void 0===p?void 0:p.table_primary_key)&&void 0!==f?f:"",primaryField:null!==(g=null==j||null===(C=j.data)||void 0===C?void 0:C.table_primary_field)&&void 0!==g?g:"",primaryKeyCandidates:null==j||null===(y=j.data)||void 0===y?void 0:y.eligible_primary_keys,primaryFieldCandidates:null==j||null===(h=j.data)||void 0===h?void 0:h.eligible_primary_fields,virtualTableColumns:(null==j||null===(S=j.data)||void 0===S||null===(T=S.virtual_table_column_candidates)||void 0===T?void 0:T.map(d.a))||[]}},p=function(){var e=this,t=arguments;return new Promise((function(a,n){var r=f.apply(e,t);function i(e){b(r,a,n,i,o,"next",e)}function o(e){b(r,a,n,i,o,"throw",e)}i(void 0)}))},function(){return p.apply(this,arguments)}),enabled:v,onSuccess:e=>{var t,a,n;S(""),null==C||C.complete({TableId:null==e?void 0:e.tableId,PrimaryKeyCount:null==e||null===(t=e.primaryKeyCandidates)||void 0===t?void 0:t.length,PrimaryFieldCount:null==e||null===(a=e.primaryFieldCandidates)||void 0===a?void 0:a.length,ColumnsCount:null==e||null===(n=e.virtualTableColumns)||void 0===n?void 0:n.length})},onError:e=>{var t=Object(o.f)(e,a);S(t),null==C||C.failure({errorMsg:t,clientError:null==e?void 0:e.message})},staleTime:0,cacheTime:0});return Object(n.useEffect)(()=>{T&&(S(""),y(Object(r.j)(t,g,r.d.DataExperience,r.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium)))},[T]),{loading:T,errorMessage:h,candidate:O}}},23490:function(e,t,a){"use strict";a.d(t,"f",(function(){return d})),a.d(t,"g",(function(){return m})),a.d(t,"d",(function(){return b})),a.d(t,"h",(function(){return v})),a.d(t,"i",(function(){return f})),a.d(t,"j",(function(){return p})),a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return C})),a.d(t,"e",(function(){return y})),a.d(t,"c",(function(){return h}));var n=a(17348),r=a(17360),i=["__typename"];function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=e=>({key:e,text:e}),d=e=>void 0!==e?e.map(u):[],m=e=>{var{__typename:t}=e,a=s(e,i);return l(l({},a),{},{schemaName:Object(r.b)(a.schemaName)})},b=e=>void 0!==e&&e.trim().length>0,v=(e,t,a)=>(a[t].displayName=e,a),f=(e,t,a)=>(a[t].schemaName=e,a),p=(e,t,a)=>(a[t]=e,a),g=e=>!!e&&e.every(e=>!0===e),C=(e,t)=>e.findindex(e=>e.externalName===t),y=(e,t,a,r,i)=>void 0===a||t===r?"":e===n.i||a.some((a,n)=>t!==n&&r!==n&&a.schemaName===e)?i:"",h=e=>null==e?void 0:e.split(/_(.*)/)},23491:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(11035),r=a.n(n),i=a(11203),o=a(11205),l=a(12092),c=a(12065),s=a(23489),u=a(15528),d=a(23492),m=a(15544),b=a(12457),v=a(17467),f=a(23475),p=a(23493),g=a(23498),C=a(15514),y=a(23490),h=a(23479),S=a(23436),T=a(23481);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){D(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Object(l.ib)({icons:{arrowReset:r.a.createElement("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M3.85355 0.646447C4.04882 0.841709 4.04882 1.15829 3.85355 1.35355L2.20711 3H9C12.3137 3 15 5.68629 15 9C15 12.3137 12.3137 15 9 15C5.68629 15 3 12.3137 3 9C3 8.72386 3.22386 8.5 3.5 8.5C3.77614 8.5 4 8.72386 4 9C4 11.7614 6.23858 14 9 14C11.7614 14 14 11.7614 14 9C14 6.23858 11.7614 4 9 4H2.20711L3.85355 5.64645C4.04882 5.84171 4.04882 6.15829 3.85355 6.35355C3.65829 6.54882 3.34171 6.54882 3.14645 6.35355L0.646447 3.85355C0.451184 3.65829 0.451184 3.34171 0.646447 3.14645L3.14645 0.646447C3.34171 0.451184 3.65829 0.451184 3.85355 0.646447Z",fill:"#212121"}))}});var j=Object(i.r)("PowerappsPortalEntities")(Object(c.a)(e=>{var t,a,i,l,c,d,O,D,j,N,{t:w,dismissPanel:P,wizardState:V,setWizardState:x,isCreateVirtualTableTriggered:k,setIsCreateVirtualTableTriggered:L,chooseDifferentList:R,editTableConfiguration:F}=e,{currentEnvironment:M}=Object(b.Q)(),A=(!V.primaryKeyName||!V.primaryFieldName)&&M,{loading:I,errorMessage:z,candidate:U}=Object(s.a)({connectionId:V.connectionSelected.name,connectorId:V.connectionSelected.apiId,dataSet:V.datasetSelected.id,tableId:V.selectedTableExternalId},m.a,w("Common.Request.Failed"),!!A),{virtualTableCreated:W,createVirtualTable:K,errorMessage:B,loading:q}=Object(u.a)(m.a,w("Common.Request.Failed"));Object(n.useEffect)(()=>{!I&&z&&x(e=>E(E({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:z,loadingOrSavingState:{showLoading:!1,message:""}}))},[z,I]),Object(n.useEffect)(()=>{if(A&&void 0!==U)if(Object(y.d)(U.tableId)){var[e,t]=Object(y.c)(U.schemaName);x(a=>E(E({},a),{},{primaryKeyCandidates:[U.primaryKey],primaryFieldCandidates:[U.primaryField],virtualTableColumns:U.virtualTableColumns.map(y.g),primaryKeyName:U.primaryKey,primaryFieldName:U.primaryField,selectedTableExternalName:U.displayName,selectedTablePluralName:U.pluralName,selectedTableSchemaName:t,errorMessage:"",loadingOrSavingState:{showLoading:!1,message:""},areColumnsDisplayNamesValid:new Array(U.virtualTableColumns.length).fill(!0),areColumnsSchemaNamesValid:new Array(U.virtualTableColumns.length).fill(!0),tableAlreadyExists:!0,tableAlreadyExistsMessageDismissed:!1,customizationPrefixExistingTable:e+"_"}))}else{var a,n,r,i,l,c;if((null===(a=U.primaryKeyCandidates)||void 0===a?void 0:a.length)<1)x(e=>E(E({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:w("VirtualTables.Configure.ErrorPrimaryKey"),loadingOrSavingState:{showLoading:!1,message:""}})),Object(o.O)(m.a,{eventName:v.n.PrimaryKeyError,eventData:{message:"Table does not have primary key",value:null===(i=U.primaryKeyCandidates)||void 0===i?void 0:i.length,connectionId:null===(l=V.connectionSelected)||void 0===l?void 0:l.id,connectionApiId:null===(c=V.connectionSelected)||void 0===c?void 0:c.apiId}});else if((null===(n=U.primaryFieldCandidates)||void 0===n?void 0:n.length)<1){var s,u,d;x(e=>E(E({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:w("VirtualTables.Configure.ErrorPrimaryField"),loadingOrSavingState:{showLoading:!1,message:""}})),Object(o.O)(m.a,{eventName:v.n.PrimaryFieldError,eventData:{message:"Table does not have primary field candidates",value:null===(s=U.primaryFieldCandidates)||void 0===s?void 0:s.length,connectionId:null===(u=V.connectionSelected)||void 0===u?void 0:u.id,connectionApiId:null===(d=V.connectionSelected)||void 0===d?void 0:d.apiId}})}else if(null!==(r=U.virtualTableColumns)&&void 0!==r&&r.length)x(e=>E(E({},e),{},{primaryKeyCandidates:U.primaryKeyCandidates,primaryFieldCandidates:U.primaryFieldCandidates,virtualTableColumns:U.virtualTableColumns.map(y.g),primaryKeyName:U.primaryKeyCandidates[0],primaryFieldName:U.primaryFieldCandidates[0],errorMessage:"",loadingOrSavingState:{showLoading:!1,message:""},areColumnsDisplayNamesValid:new Array(U.virtualTableColumns.length).fill(!0),areColumnsSchemaNamesValid:new Array(U.virtualTableColumns.length).fill(!0),tableAlreadyExists:!1,tableAlreadyExistsMessageDismissed:!1}));else{var b,f,p;x(e=>E(E({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:w("VirtualTables.Configure.ErrorColumns"),loadingOrSavingState:{showLoading:!1,message:""}})),Object(o.O)(m.a,{eventName:v.n.ColumnsError,eventData:{message:"Table does not have columns",value:null===(b=U.virtualTableColumns)||void 0===b?void 0:b.length,connectionId:null===(f=V.connectionSelected)||void 0===f?void 0:f.id,connectionApiId:null===(p=V.connectionSelected)||void 0===p?void 0:p.apiId}})}}},[U]),Object(n.useEffect)(()=>{if(!q&&B){var e=B.includes("modifyPermissionsForServicePrincipal, StatusCode: NotFound, please verify that connection")?w("VirtualTables.ReviewAndFinish.ProvisioningErrorMessage"):B;x(t=>E(E({},t),{},{errorMessage:e}))}},[B,q]),Object(n.useEffect)(()=>{q?x(e=>E(E({},e),{},{errorMessage:"",loadingOrSavingState:{showLoading:!0,message:w("VirtualTables.CreatingVirtualTable")}})):I?x(e=>E(E({},e),{},{primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,errorMessage:"",loadingOrSavingState:{showLoading:!0,message:w("VirtualTables.LoadingRequiredFields")}})):(x(e=>E(E({},e),{},{loadingOrSavingState:{showLoading:!1,message:""}})),L(!1))},[I,q]);var{enableEnvironmentVariablesForVirtualTables:H}=Object(S.h)();Object(n.useEffect)(()=>{if(k){var e,t,a;K({connectionId:V.connectionSelected.name,connectorId:V.connectionSelected.apiId,dataSet:V.datasetSelected.id,primaryField:V.primaryFieldName,primaryKey:V.primaryKeyName,externalName:V.selectedTableExternalId,displayName:V.selectedTableExternalName,connectionReferenceId:V.shouldCreateConnectionReference?"":V.connectionReferenceSelected.id,connectionReferenceDisplayName:V.shouldCreateConnectionReference?V.connectionReferenceParams.displayName:"",connectionReferenceLogicalName:V.shouldCreateConnectionReference?V.connectionReferenceParams.logicalName:"",currentSolutionId:V.solutionId,currentSolutionName:V.solutionName,pluralName:V.selectedTablePluralName,schemaName:V.selectedTableSchemaName,columns:V.virtualTableColumns,useEnvironmentVariables:H?V.useEnvironmentVariables:void 0});var n,r,i={isRefresh:V.tableAlreadyExists,solutionId:V.solutionId,connectionId:null===(e=V.connectionSelected)||void 0===e?void 0:e.id,connectionApiId:null===(t=V.connectionSelected)||void 0===t?void 0:t.apiId,shouldCreateConnectionReference:V.shouldCreateConnectionReference,connectionReferenceId:V.connectionReferenceSelected?V.connectionReferenceSelected.id:"",connectionReferenceDisplayName:V.connectionReferenceParams?V.connectionReferenceParams.displayName:"",connectionReferenceLogicalName:V.connectionReferenceParams?V.connectionReferenceParams.logicalName:""};if(Object(o.O)(m.a,{eventName:v.n.CreateVirtualTable,eventData:i}),null!=V&&null!==(a=V.alternativeCreateConnectionDialogDetails)&&void 0!==a&&a.logEvent)(null==V||null===(n=V.connectionSelected)||void 0===n?void 0:n.apiDisplayName)===C.a.MicrosoftFabric&&(i.connectionApiId=C.b.MicrosoftFabric),null==V||null===(r=V.alternativeCreateConnectionDialogDetails)||void 0===r||r.logEvent(v.b.CreateVirtualTable,i)}},[k]),Object(n.useEffect)(()=>{!W||q||B||P(!0,(null==W?void 0:W.tableId)||"")},[k,W,q,B]);var _={header:{titleText:"",subtitleText:w("VirtualTables.ReviewAndFinish.ExternalDataSourceSubtitle"),image:(null===(t=V.connectionSelected)||void 0===t?void 0:t.iconUri)||"",imageAltText:(null===(a=V.connectionSelected)||void 0===a?void 0:a.apiDisplayName)||""},content:{descriptionText:w("VirtualTables.ReviewAndFinish.ExternalDataSourceDescription"),dataLines:[]},footer:{}},G={header:{titleText:w("VirtualTables.ReviewAndFinish.DataverseTable.Title"),subtitleText:w("VirtualTables.ReviewAndFinish.DataverseTable.Subtitle"),image:g.a,imageAltText:w("VirtualTables.ReviewAndFinish.DataverseTable.Title")},content:{descriptionText:w("VirtualTables.ReviewAndFinish.DataverseTable.Description"),dataLines:[{label:w("VirtualTables.ReviewAndFinish.DataverseTable.DisplayName"),value:V.selectedTableExternalName||""},{label:w("VirtualTables.ReviewAndFinish.DataverseTable.PluralName"),value:V.selectedTablePluralName||""},{label:w("VirtualTables.ReviewAndFinish.DataverseTable.SchemaName"),value:(V.tableAlreadyExists?V.customizationPrefixExistingTable:V.customizationPrefix||"")+(V.selectedTableSchemaName||"")},{label:w("VirtualTables.ReviewAndFinish.DataverseTable.PrimaryColumn"),value:V.primaryFieldName||""},{label:w("VirtualTables.ReviewAndFinish.DataverseTable.NumberOfColumns"),value:(null===(i=V.virtualTableColumns)||void 0===i?void 0:i.length.toString())||""}]},footer:{buttons:{secondaryButton:{text:w("VirtualTables.ReviewAndFinish.DataverseTable.EditConfiguration"),iconProps:{iconName:"Edit"},onClick:F}}}};switch((null==V||null===(l=V.connectionSelected)||void 0===l?void 0:l.apiDisplayName)===C.a.MicrosoftFabric&&(V.connectionSelected.connectorType=C.b.MicrosoftFabric,V.connectionSelected.iconUri=T.a),null===(c=V.connectionSelected)||void 0===c?void 0:c.connectorType){case C.b.SharePoint:_.header.titleText=w("VirtualTables.ReviewAndFinish.Sharepoint.Title"),_.content.dataLines=[{label:w("VirtualTables.ReviewAndFinish.Sharepoint.Site"),value:(null===(d=V.datasetSelected)||void 0===d?void 0:d.id)||""},{label:w("VirtualTables.ReviewAndFinish.Sharepoint.List"),value:V.selectedTableOriginalExternalName||""}],_.footer={buttons:{secondaryButton:{text:w("VirtualTables.ReviewAndFinish.Sharepoint.ChooseDifferent"),iconProps:{iconName:"arrowReset"},onClick:R}}};break;case C.b.SqlServer:var Q=Object(h.b)(null===(O=V.datasetSelected)||void 0===O?void 0:O.id);_.header.titleText=w("VirtualTables.ReviewAndFinish.SQLServer.Title"),_.content.dataLines=[{label:w("VirtualTables.ReviewAndFinish.SQLServer.Server"),value:decodeURIComponent(null==Q?void 0:Q.serverName)||""},{label:w("VirtualTables.ReviewAndFinish.SQLServer.Database"),value:decodeURIComponent(null==Q?void 0:Q.databaseName)||""}],_.footer={buttons:{secondaryButton:{text:w("VirtualTables.ReviewAndFinish.SQLServer.ChooseDifferent"),iconProps:{iconName:"arrowReset"},onClick:R}}};break;case C.b.MicrosoftFabric:var Z=Object(h.d)(null==V?void 0:V.workspaceLakehouseDetails);_.header.titleText=w("VirtualTables.ReviewAndFinish.MicrosoftFabric.Title"),_.content.dataLines=[{label:w("VirtualTables.ReviewAndFinish.MicrosoftFabric.Workspace"),value:decodeURIComponent(null==Z?void 0:Z.workspace)||""},{label:w("VirtualTables.ReviewAndFinish.MicrosoftFabric.Lakehouse"),value:decodeURIComponent(null==Z?void 0:Z.lakehouse)||""}],_.footer={buttons:{secondaryButton:{text:w("VirtualTables.ReviewAndFinish.MicrosoftFabric.ChooseDifferent"),iconProps:{iconName:"arrowReset"},onClick:R}}};break;case C.b.SalesForce:_.header.titleText=w("VirtualTables.ReviewAndFinish.SalesForce.Title"),_.content.dataLines=[{label:w("VirtualTables.ReviewAndFinish.SalesForce.Table"),value:V.selectedTableExternalName||""},{label:w("VirtualTables.ReviewAndFinish.DataverseTable.NumberOfColumns"),value:(null===(D=V.virtualTableColumns)||void 0===D?void 0:D.length.toString())||""}],_.footer={buttons:{secondaryButton:{text:w("VirtualTables.ReviewAndFinish.SalesForce.ChooseDifferent"),iconProps:{iconName:"arrowReset"},onClick:R}}};break;case C.b.Oracle:_.header.titleText=w("VirtualTables.ReviewAndFinish.Oracle.Title"),_.content.dataLines=[{label:w("VirtualTables.ReviewAndFinish.Oracle.Server"),value:(null==V||null===(j=V.connectionSelected.connectionParameter)||void 0===j?void 0:j.server)||""},{label:w("VirtualTables.ReviewAndFinish.Oracle.Table"),value:V.selectedTableExternalName||""},{label:w("VirtualTables.ReviewAndFinish.DataverseTable.NumberOfColumns"),value:(null===(N=V.virtualTableColumns)||void 0===N?void 0:N.length.toString())||""}],_.footer={buttons:{secondaryButton:{text:w("VirtualTables.ReviewAndFinish.Oracle.ChooseDifferent"),iconProps:{iconName:"arrowReset"},onClick:R}}}}return r.a.createElement(f.a,{titleText:w("VirtualTables.Steps.ReviewAndFinish"),subtitleText:w("VirtualTables.ReviewAndFinish.ReviewAndFinishTitle"),styles:{mainContentArea:{marginTop:32,marginBottom:32}}},r.a.createElement(p.a,{leftDataCardProps:_,rightDataCardProps:G}))},d.a))},23492:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({})},23493:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(12061),r=a(12065),i=a(11035),o=a(23494),l=a(23495),c=a(23497),s=a(12092),u=a(12137),d=a(12329);function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}Object(s.ib)({icons:{arrow:i.createElement("svg",{width:"57",height:"8",viewBox:"0 0 57 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M56.3536 4.35356C56.5488 4.1583 56.5488 3.84171 56.3536 3.64645L53.1716 0.464471C52.9763 0.269209 52.6597 0.269209 52.4645 0.464471C52.2692 0.659733 52.2692 0.976315 52.4645 1.17158L55.2929 4L52.4645 6.82843C52.2692 7.02369 52.2692 7.34028 52.4645 7.53554C52.6597 7.7308 52.9763 7.7308 53.1716 7.53554L56.3536 4.35356ZM-4.37114e-08 4.5L56 4.5L56 3.5L4.37114e-08 3.5L-4.37114e-08 4.5Z",fill:"#A19F9D"}))}});var b=Object(n.a)(),v=Object(r.a)(e=>{var t=b(e.styles,{theme:e.theme}),{leftDataCardProps:a,rightDataCardProps:n}=e,r=i.useRef(null),[o,s]=i.useState(!1),v=Object(c.a)(r);i.useLayoutEffect(()=>{s(v<=720)},[v]);var f={root:{width:300},dataCardContentContainer:{minHeight:350}};return i.createElement("div",{className:o?t.rootNarrow:t.root,ref:r},i.createElement(l.a,m({styles:f},a)),i.createElement(d.a,{className:o?t.arrowRotated:"",horizontalAlign:"center",verticalAlign:"center",tokens:{padding:20}},i.createElement(u.a,{"aria-label":"arrow",iconName:"arrow"})),i.createElement(l.a,m({styles:f},n)))},o.a)},23494:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({root:{width:"100%",display:"flex",flexWrap:"wrap"},rootNarrow:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},arrowRotated:{marginTop:20,marginBottom:20,transform:"rotate(90deg)",transition:"transform 0.2s"}})},23495:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(12061),r=a(12065),i=a(12707),o=a(12329),l=a(11035),c=a(23496),s=a(14498),u=a(12139),d=Object(n.a)(),m=Object(r.a)(e=>{var t=d(e.styles,{theme:e.theme}),{header:a,content:n,footer:r}=e,c=l.createElement("div",{className:t.dataCardHeaderContainer},a.subtitleText&&l.createElement(i.a,{className:t.dataCardHeaderSubtitle},a.subtitleText),l.createElement(o.a,{horizontal:!0,horizontalAlign:"start",tokens:{childrenGap:8}},a.image&&l.createElement(u.a,{src:a.image,height:33,alt:a.imageAltText||void 0}),a.titleText&&l.createElement(i.a,{className:t.dataCardHeaderTitle},a.titleText))),m=l.createElement("div",{className:t.dataCardContentContainer},l.createElement("div",{className:t.dataCardContentDescription},n.descriptionText),n.dataLines.map(e=>l.createElement(l.Fragment,null,l.createElement(i.a,{className:t.dataCardContentDataLineLabel},e.label),l.createElement("div",{className:t.dataCardContentDataLineValue},e.value))));return l.createElement(s.RichCard,{styles:{root:t.root},renderHeader:()=>c,renderContentArea:()=>m,footerProps:r})},c.a)},23496:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>{var{palette:t}=e.theme;return{dataCardHeaderContainer:{padding:16,borderColor:(null==t?void 0:t.neutralLight)||"#EDEBE9",borderBottomWidth:1,borderBottomStyle:"solid"},dataCardHeaderTitle:{fontSize:14,fontWeight:600,lineHeight:20,color:(null==t?void 0:t.neutralPrimary)||"#323130"},dataCardHeaderSubtitle:{fontSize:14,fontWeight:400,lineHeight:20,color:(null==t?void 0:t.neutralSecondary)||"#605E5C"},dataCardContentContainer:{fontSize:14},dataCardContentDescription:{fontSize:12},dataCardContentDataLineLabel:{marginTop:10,fontWeight:600,color:(null==t?void 0:t.neutralPrimary)||"#323130"},dataCardContentDataLineValue:{fontWeight:400,color:(null==t?void 0:t.neutralSecondary)||"#605E5C",wordWrap:"break-word"}}}},23497:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(11035),r=a(13068),i=e=>{var[t,a]=n.useState(0),i=new r.a(e=>{var t,n=null===(t=e[0])||void 0===t?void 0:t.contentRect.width;n&&a(n)});return n.useEffect(()=>((null==e?void 0:e.current)&&i.observe(e.current),()=>{i.disconnect()}),[e]),t}},23499:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(11035),r=a.n(n),i=a(15514),o=a(23500),l=a(11205),c=a(17467),s=a(15544),u=e=>{var t,a,n,{wizardState:u,setWizardState:d,goToNextStep:m}=e,b=null===(t=u.connectionSelected)||void 0===t?void 0:t.connectorType;switch(b){case i.b.SharePoint:case i.b.SqlServer:case i.b.SalesForce:case i.b.Oracle:return r.a.createElement(o.a,{currentConnectionSelected:u.connectionSelected,triggerSearchOfCustomDataset:u.triggerSearchOfCustomDataset,customDatasetUrl:u.customDatasetUrl,datasets:u.datasets,currentDatasetIdSelected:null===(a=u.datasetSelected)||void 0===a?void 0:a.id,setWizardState:d,goToNextStep:m});default:return Object(l.M)(s.a,{eventName:c.n.VirtualTableError,eventData:{error:"The connector type does not have a valid component to select datasets",currentConnectionSelectedId:null===(n=u.connectionSelected)||void 0===n?void 0:n.id,connectorType:b}}),r.a.createElement(r.a.Fragment,null)}}},23500:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(11035),r=a.n(n),i=a(11203),o=a(11205),l=a(17467),c=a(15544),s=a(15533),u=a(16799),d=a(15514),m=a(23501),b=a(23505),v=a(23506),f=a(15523),p=a(23479);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var h=Object(i.r)("PowerappsPortalEntities")(e=>{var t,a,i,g,y,h,S,T,O,E,{t:D,currentConnectionSelected:j,triggerSearchOfCustomDataset:N,customDatasetUrl:w,datasets:P,currentDatasetIdSelected:V,setWizardState:x,goToNextStep:k}=e,[L,R]=Object(n.useState)(!1),F={connection:j},M=null==j?void 0:j.connectorType,A=M?Object(v.a)(D,M):void 0;switch(M){case d.b.SharePoint:E=F;break;case d.b.SqlServer:E=void 0;break;default:Object(o.M)(c.a,{eventName:l.n.VirtualTableError,eventData:{error:"The connector type is not in the list of available connections during the dataset selection",currentConnectionSelectedId:null==j?void 0:j.id,connectorType:M}})}var{data:I,isInitialLoading:z,error:U,refetch:W}=Object(s.c)(C(C({},E||F),{},{telemetryScope:c.a,options:{enabled:!!E,staleTime:1/0}})),{data:K,error:B,isInitialLoading:q,hasConnectionMismatch:H}=Object(s.e)(C(C({},E),{},{datasetUrl:w||"",telemetryScope:c.a,options:{enabled:!!N}}));r.a.useEffect(()=>{x(e=>C(C({},e),{},{datasets:(null==I?void 0:I.map(e=>Object(b.b)(e)))||[],refetchConnectionDataset:Object(p.e)(j)?void 0:W}))},[j,I,z,U]),r.a.useEffect(()=>{var e=!(!w||!N||!K||q||B);x(e=>C(C({},e),{},{loadingOrSavingState:{showLoading:q,message:D("VirtualTables.Connecting")}})),e&&(x(e=>C(C({},e),{},{tables:(null==K?void 0:K.map(e=>Object(b.d)(e)))||[],datasetSelected:{id:w||"",displayName:w||""},triggerSearchOfCustomDataset:!1})),k())},[K,q,B]);var _=Object(n.useCallback)(e=>{var t=B?(null==B?void 0:B.message)||D("Common.Request.Failed"):void 0;return L&&!Object(u.f)(e)&&(t=D("VirtualTables.ConnectionData.InvalidSite")),H&&(t=D("VirtualTables.ConnectionData.AccessDeniedForSelectedSite")),Object(f.d)(B,[400,401,403,404])&&(t=null==A?void 0:A.commonErrorMessageLabels.siteOrServerNotFound),t&&Object(o.M)(c.a,{eventName:l.n.VirtualTableError,eventData:{error:"Error message when the custom dataset entered by the user is not valid",connectorType:M,errorMessageShownToUser:t,backendError:B,tablesHasConnectionMismatch:H}}),t},[D,L,H,B]);return r.a.createElement(m.a,{connectionDataFilterSearchViews:Object(p.e)(j)?void 0:{items:(null==P?void 0:P.map(e=>Object(b.a)(e,j,V)))||[],itemsLoading:z,onItemClick:e=>{var t=Object(b.c)(e);x(e=>C(C({},e),{},{datasetSelected:t,customDatasetUrl:null==t?void 0:t.id,triggerSearchOfCustomDataset:!1})),R(!1)},label:null==A||null===(t=A.searchConnectionData)||void 0===t?void 0:t.label,emptyStatePrimaryMessage:(null==A||null===(a=A.searchConnectionData)||void 0===a?void 0:a.emptyStatePrimaryMessage)||"",emptyStateSecondaryMessage:(null==A||null===(i=A.searchConnectionData)||void 0===i?void 0:i.emptyStateSecondaryMessage)||"",clearSelection:L},mainContentTitle:null==A?void 0:A.mainContentTitle,mainContentSubTitle:null==A?void 0:A.mainContentSubTitle,searchConnectionTextFieldProps:(null==A?void 0:A.inputSearchData)&&{label:null==A||null===(g=A.inputSearchData)||void 0===g?void 0:g.label,ariaLabel:null==A||null===(y=A.inputSearchData)||void 0===y?void 0:y.label,disabled:q,value:w,onChange:(e,t)=>{x(e=>C(C({},e),{},{customDatasetUrl:t,validCustomDatasetUrl:!!t&&(null==t?void 0:t.length)>4&&Object(u.f)(t),triggerSearchOfCustomDataset:!1,datasetSelected:void 0})),R(!0)},errorMessage:_(w),validateOnLoad:!1},connectionDetailsTextFieldProps:(null==A?void 0:A.inputDetailData)&&{serverNameProps:{label:null==A||null===(h=A.inputDetailData)||void 0===h?void 0:h.serverLabel,ariaLabel:null==A||null===(S=A.inputDetailData)||void 0===S?void 0:S.serverLabel,required:!0,onChange:(e,t)=>{var a=V?"".concat(encodeURIComponent(null!=t?t:""),",").concat(Object(p.a)(V)):"".concat(encodeURIComponent(null!=t?t:""),",");x(e=>C(C({},e),{},{datasetSelected:{id:a,displayName:a}}))},defaultValue:V?Object(p.c)(V):"",autoFocus:!0},databaseNameProps:{label:null==A||null===(T=A.inputDetailData)||void 0===T?void 0:T.databaseLabel,ariaLabel:null==A||null===(O=A.inputDetailData)||void 0===O?void 0:O.databaseLabel,required:!0,onChange:(e,t)=>{var a=V?"".concat(Object(p.c)(V),",").concat(encodeURIComponent(null!=t?t:"")):",".concat(encodeURIComponent(null!=t?t:""));x(e=>C(C({},e),{},{datasetSelected:{id:a,displayName:a}}))},defaultValue:V?Object(p.a)(V):""}}})})},23501:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(11035),r=a.n(n),i=a(12061),o=a(12065),l=a(14610),c=a(13272),s=a(23502),u=a(23503),d=a(23475),m=a(12329),b=a(12336);function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var f=Object(o.a)(e=>{var{styles:t,theme:a,mainContentTitle:o,mainContentSubTitle:s,connectionDataFilterSearchViews:f,searchConnectionTextFieldProps:p,connectionDetailsTextFieldProps:g,stageCheckboxProps:C}=e,y=Object(n.useMemo)(()=>Object(i.a)()(t,{theme:a}),[t,a]),[h,S]=Object(n.useState)(void 0),[T,O]=Object(n.useState)(!(null==C||!C.checked));return r.a.useEffect(()=>{S(null==p?void 0:p.value)},[null==p?void 0:p.value]),r.a.createElement(d.a,{titleText:o,subtitleText:s},p&&r.a.createElement(l.a,v({maxLength:2047,autoFocus:!0,className:y.searchInput},p,{value:h,onChange:(e,t)=>{var a;S(t),null==p||null===(a=p.onChange)||void 0===a||a.call(p,e,t)}})),g&&r.a.createElement(m.a,{wrap:!0,tokens:{childrenGap:12}},r.a.createElement(b.a,null,r.a.createElement(l.a,g.serverNameProps)),r.a.createElement(b.a,null,r.a.createElement(l.a,g.databaseNameProps))),f&&r.a.createElement(u.a,{connectionDataFilterSearchViewsProps:f}),C&&r.a.createElement(c.a,v({},C,{checked:T,onChange:(e,t)=>{var a,n=t||!1;O(n),null==C||null===(a=C.onChange)||void 0===a||a.call(C,e,n)}})))},s.a)},23502:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({searchInput:{lineHeight:20}})},23503:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(11035),r=a.n(n),i=a(12061),o=a(12065),l=a(14821),c=a(14823),s=a(14819),u=a(12329),d=a(12336),m=a(13265),b=a(12707),v=a(11203),f=a(13326),p=a(23504),g=a(14558),C=a(11797),y=a(12139),h=a(12281),S=a(12187),T=Object(v.r)("PowerappsPortalEntities")(Object(o.a)(e=>{var{t:t,styles:a,theme:o,connectionDataFilterSearchViewsProps:v}=e,{ariaLabel:T,label:O,items:E,itemsLoading:D,onItemClick:j,emptyStatePrimaryMessage:N,emptyStateSecondaryMessage:w,clearSelection:P}=v,V=Object(n.useMemo)(()=>Object(i.a)()(a,{theme:o}),[a,o]),[x,k]=Object(n.useState)(""),L=Object(n.useCallback)(e=>{var t=e.id,a=(t===x||e.selected)&&!P;return r.a.createElement(h.a,{role:"option",title:e.text,className:V.buttonItem,"data-is-focusable":!0,onClick:()=>{j(e),k(t)},tabindex:0,checked:a,"aria-selected":a},r.a.createElement(u.a,{horizontal:!0,horizontalAlign:"start",grow:!0,tokens:{childrenGap:8},className:V.stack},!!e.iconUri&&r.a.createElement(d.a,{disableShrink:!0,"aria-hidden":!0},r.a.createElement(y.a,{className:V.itemImage,src:e.iconUri,width:26,height:26,alt:e.text})),r.a.createElement(d.a,{grow:!0,className:V.stack,"aria-hidden":!0},r.a.createElement("div",{className:V.itemText},e.text))))},[x,P,j]),R=Object(n.useCallback)(e=>r.a.createElement(l.a,{styles:{root:{padding:16}},customElementsGroup:[r.a.createElement("div",{key:"shimmerDiv".concat(e)},r.a.createElement(c.a,{shimmerElements:[{type:s.a.line,width:26,height:26},{type:s.a.gap,width:10,height:20}]}))]}),[]),F=Object(n.useCallback)((e,t)=>t?r.a.createElement(f.a,{message:e}):void 0,[]),M=Object(n.useCallback)((e,a)=>D?r.a.createElement("div",{className:V.listView},R("1"),R("2"),R("3")):null!=e&&e.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,null,r.a.createElement(C.a,{role:"listbox","aria-label":null!=T?T:O,"data-is-scrollable":"true",items:e,onRenderCell:e=>e?L(e):void 0,className:V.listView})),F(t("Common.DisplayingFilteredItemsCount",{count:null==e?void 0:e.length}),a)):r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{horizontal:!0,horizontalAlign:"center"},r.a.createElement(m.a,{primaryMessage:N,secondaryMessage:w,styles:Object(p.a)()})),F(t("Common.NoItemFound"),a)),[D,E,P,O,L]);return r.a.createElement(u.a,null,O&&r.a.createElement(b.a,{className:V.labelSearchItem},O),r.a.createElement(g.a,{strings:{searchBoxPlaceholder:t("Common.Search"),allItemsFilterItemText:t("Common.All"),searchBoxClearButtonTitle:t("Common.Clear")},items:E,shouldFilterItem:(e,t)=>((e,t)=>{var a;return!t||-1!==(null==e||null===(a=e.text)||void 0===a?void 0:a.toLowerCase().indexOf(t.toLowerCase()))})(e,t),views:[{key:"SearchConnectionData",text:t("VirtualTables.ConnectionData.ConnectionDataListView"),ariaLabel:t("VirtualTables.ConnectionData.ConnectionDataListView"),iconName:"List",onRenderView:(e,t)=>M(e,t)}],styles:Object(p.b)(e,O)}))},p.c))},23504:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(12092),r=e=>{var t,a=null==e?void 0:e.theme,r=null==a?void 0:a.palette;return{listView:{border:"1px solid ".concat((null==a||null===(t=a.palette)||void 0===t?void 0:t.neutralTertiary)||"#A19F9D"),paddingTop:8,paddingBottom:8,maxHeight:264,overflow:"auto"},buttonItem:{minHeight:49,border:0,backgroundColor:"transparent",textAlign:"left",width:"100%",selectors:{"&.is-checked":{backgroundColor:null==r?void 0:r.neutralLighter,[n.m]:{outline:"2px solid transparent"}}}},itemImage:{borderRadius:3},itemText:{fontWeight:400,fontSize:12,lineHeight:26,color:(null==r?void 0:r.neutralPrimary)||"#323130",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},labelSearchItem:{marginTop:32},stack:{overflow:"hidden"}}},i=(e,t)=>{var a=null==e?void 0:e.theme,n=null==a?void 0:a.palette;return{root:{marginBottom:11},filterSearchBox:{border:"1px solid ".concat((null==n?void 0:n.neutralTertiary)||"#A19F9D"),marginTop:t?8:0}}},o=()=>({root:{margin:30},primaryMessage:{fontWeight:600,fontSize:18,lineHeight:24,textAlign:"center"},secondaryMessage:{fontSize:14,lineHeight:20,textAlign:"center"}})},23505:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o}));var n=e=>({id:e.id,displayName:e.displayName||e.id}),r=e=>({id:e.id,displayName:e.displayName||e.id}),i=e=>{if(e)return{id:e.id,displayName:e.text}},o=(e,t,a)=>({id:e.id,text:e.displayName,iconUri:null==t?void 0:t.iconUri,iconTitle:null==t?void 0:t.apiDisplayName,selected:e.id===a})},23506:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(23507),r=(e,t)=>o(e,n.a.get(t)),i=(e,t)=>o(e,n.b.get(t)),o=(e,t)=>{var a,n,r;if(t)return{mainContentTitle:e(t.mainContentTitle),mainContentSubTitle:e(t.mainContentSubTitle),loadingText:t.loadingText?e(t.loadingText):"",searchConnectionData:t.searchConnectionData?{label:t.searchConnectionData.label?e(t.searchConnectionData.label):"",emptyStatePrimaryMessage:e(t.searchConnectionData.emptyStatePrimaryMessage),emptyStateSecondaryMessage:e(t.searchConnectionData.emptyStateSecondaryMessage)}:void 0,inputSearchData:t.inputSearchData?{label:e(t.inputSearchData.label)}:void 0,inputDetailData:t.inputDetailData?{serverLabel:e(t.inputDetailData.serverLabel),databaseLabel:e(t.inputDetailData.databaseLabel)}:void 0,configureTableCheckboxData:t.configureTableCheckboxData?{label:e(null===(a=t.configureTableCheckboxData)||void 0===a?void 0:a.label),ariaLabel:e(null===(n=t.configureTableCheckboxData)||void 0===n?void 0:n.ariaLabel)}:void 0,commonErrorMessageLabels:{siteOrServerNotFound:e(null===(r=t.commonErrorMessageLabels)||void 0===r?void 0:r.siteOrServerNotFound)}}}},23507:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(15514),r=new Map([[n.b.SharePoint,{mainContentTitle:"VirtualTables.ConnectionData.SharePoint.SharePointSiteTitle",mainContentSubTitle:"VirtualTables.ConnectionData.SharePoint.SharePointSiteSubTitle",loadingText:"VirtualTables.Connecting",searchConnectionData:{label:"VirtualTables.ConnectionData.RecentSites",emptyStatePrimaryMessage:"VirtualTables.ConnectionData.EmptySites",emptyStateSecondaryMessage:"VirtualTables.ConnectionData.EmptySitesList"},inputSearchData:{label:"VirtualTables.ConnectionData.SharePoint.SharePointUrl"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.SiteNotFound"}}],[n.b.SqlServer,{mainContentTitle:"VirtualTables.ConnectionData.SqlServer.SqlServerDetailsTitle",mainContentSubTitle:"VirtualTables.ConnectionData.SqlServer.SqlServerDetailsSubTitle",loadingText:"VirtualTables.Connecting",inputDetailData:{serverLabel:"VirtualTables.ConnectionData.SqlServer.SqlServerServerName",databaseLabel:"VirtualTables.ConnectionData.SqlServer.SqlServerDatabaseName"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.ServerNotFound"}}]]),i=new Map([[n.b.SharePoint,{mainContentTitle:"VirtualTables.ConnectionData.ChooseList",mainContentSubTitle:"VirtualTables.ConnectionData.SharePoint.ChooseSharePointList",configureTableCheckboxData:{label:"VirtualTables.Configure.ConfigureVirtualTable",ariaLabel:"VirtualTables.Configure.ConfigureVirtualTable"},searchConnectionData:{label:"VirtualTables.ConnectionData.SharePointListsAriaLabel",emptyStatePrimaryMessage:"VirtualTables.ConnectionData.EmptyLists",emptyStateSecondaryMessage:"VirtualTables.ConnectionData.EmptyListsSelection"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.SiteNotFound"}}],[n.b.SalesForce,{mainContentTitle:"VirtualTables.ConnectionData.SalesForce.SalesForceTitle",mainContentSubTitle:"VirtualTables.ConnectionData.SalesForce.SalesForceSubTitle",configureTableCheckboxData:{label:"VirtualTables.Configure.ConfigureVirtualTable",ariaLabel:"VirtualTables.Configure.ConfigureVirtualTable"},searchConnectionData:{label:"VirtualTables.ConnectionData.ChooseTable",emptyStatePrimaryMessage:"VirtualTables.ConnectionData.EmptyLists",emptyStateSecondaryMessage:"VirtualTables.ConnectionData.EmptyListsSelection"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.ServerNotFound"}}],[n.b.Oracle,{mainContentTitle:"VirtualTables.ConnectionData.Oracle.OracleTitle",mainContentSubTitle:"VirtualTables.ConnectionData.Oracle.OracleSubTitle",configureTableCheckboxData:{label:"VirtualTables.Configure.ConfigureVirtualTable",ariaLabel:"VirtualTables.Configure.ConfigureVirtualTable"},searchConnectionData:{label:"VirtualTables.ConnectionData.ChooseTable",emptyStatePrimaryMessage:"VirtualTables.ConnectionData.EmptyLists",emptyStateSecondaryMessage:"VirtualTables.ConnectionData.EmptyListsSelection"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.ServerNotFound"}}],[n.b.SqlServer,{mainContentTitle:"VirtualTables.ConnectionData.ChooseTable",mainContentSubTitle:"VirtualTables.ConnectionData.SqlServer.ChooseSqlTable",configureTableCheckboxData:{label:"VirtualTables.Configure.ConfigureVirtualTable",ariaLabel:"VirtualTables.Configure.ConfigureVirtualTable"},searchConnectionData:{label:"VirtualTables.ConnectionData.SqlServerAriaLabel",emptyStatePrimaryMessage:"VirtualTables.ConnectionData.SqlServer.EmptyTables",emptyStateSecondaryMessage:"VirtualTables.ConnectionData.SqlServer.EmptyTablesSelection"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.ServerNotFound"}}],[n.b.MicrosoftFabric,{mainContentTitle:"VirtualTables.ConnectionData.ChooseTable",mainContentSubTitle:"VirtualTables.ConnectionData.SqlServer.ChooseSqlTable",configureTableCheckboxData:{label:"VirtualTables.Configure.ConfigureVirtualTable",ariaLabel:"VirtualTables.Configure.ConfigureVirtualTable"},searchConnectionData:{label:"VirtualTables.ConnectionData.FabricServerAriaLabel",emptyStatePrimaryMessage:"VirtualTables.ConnectionData.SqlServer.EmptyTables",emptyStateSecondaryMessage:"VirtualTables.ConnectionData.SqlServer.EmptyTablesSelection"},commonErrorMessageLabels:{siteOrServerNotFound:"VirtualTables.ConnectionData.ServerNotFound"}}]])},23508:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(11035),r=a.n(n),i=a(15514),o=a(23509),l=e=>{var t,a,{wizardState:n,setWizardState:l}=e;switch(null===(t=n.connectionSelected)||void 0===t?void 0:t.connectorType){case i.b.SharePoint:case i.b.SqlServer:case i.b.SalesForce:case i.b.Oracle:case i.b.MicrosoftFabric:return r.a.createElement(o.a,{tables:n.tables,currentTableIdSelected:null==n?void 0:n.selectedTableExternalId,datasetIdSelected:null===(a=n.datasetSelected)||void 0===a?void 0:a.id,configureTable:n.configureTable,currentConnectionSelected:n.connectionSelected,setWizardState:l});default:return r.a.createElement(r.a.Fragment,null)}}},23509:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(11035),r=a.n(n),i=a(11203),o=a(11205),l=a(17467),c=a(15544),s=a(15533),u=a(15514),d=a(23501),m=a(23505),b=a(23506),v=a(17464),f=a(17360),p=a(15523);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var h=Object(i.r)("PowerappsPortalEntities")(e=>{var t,a,n,g,y,h,{t:S,tables:T,currentTableIdSelected:O,datasetIdSelected:E,configureTable:D,currentConnectionSelected:j,setWizardState:N}=e,w=r.a.useMemo(()=>Object(i.g)(),[]),P={connection:j,datasetUrl:E,telemetryScope:c.a},V=(null==j?void 0:j.apiDisplayName)===u.a.MicrosoftFabric?u.b.MicrosoftFabric:null==j?void 0:j.connectorType,x=V?Object(b.b)(S,V):void 0;switch(V){case u.b.SharePoint:case u.b.SalesForce:case u.b.Oracle:h=P;break;case u.b.MicrosoftFabric:case u.b.SqlServer:h=C(C({},P),{},{isV2:!0});break;default:Object(o.M)(c.a,{eventName:l.n.VirtualTableError,eventData:{currentConnectionSelectedId:null==j?void 0:j.id,connectorType:V}})}var{data:k,isInitialLoading:L,error:R,refetch:F}=Object(s.e)(C(C({},h||P),{},{options:{enabled:!!h}})),M=r.a.useCallback(()=>{var e=R?(null==R?void 0:R.message)||S("Common.Request.Failed"):void 0;return Object(p.d)(R,[400,401,403,404])&&(e=null==x?void 0:x.commonErrorMessageLabels.siteOrServerNotFound),e&&Object(o.M)(c.a,{eventName:l.n.VirtualTableError,eventData:{error:"Error message when the server could not be contacted or did not respond",connectorType:V,errorMessageShownToUser:e,backendError:R}}),e},[S,R]);return r.a.useEffect(()=>{N(e=>C(C({},e),{},{tables:(null==k?void 0:k.map(e=>({id:e.id,displayName:e.displayName})))||[],errorMessage:M()||"",refetchConnectionTable:F}))},[j,k,L,M]),r.a.createElement(d.a,{connectionDataFilterSearchViews:{items:(null==T?void 0:T.map(e=>Object(m.a)(e,j,O)))||[],itemsLoading:L,onItemClick:e=>{N(t=>{var a,n;return C(C({},t),{},{selectedTableExternalId:e.id,selectedTableExternalName:e.text,selectedTableOriginalExternalName:e.text,selectedTableOriginalPluralName:Object(v.c)(w,null!==(a=e.text)&&void 0!==a?a:""),selectedTablePluralName:Object(v.c)(w,null!==(n=e.text)&&void 0!==n?n:""),selectedTableSchemaName:Object(f.b)(e.text)})})},ariaLabel:null==x||null===(t=x.searchConnectionData)||void 0===t?void 0:t.label,emptyStatePrimaryMessage:(null==x||null===(a=x.searchConnectionData)||void 0===a?void 0:a.emptyStatePrimaryMessage)||"",emptyStateSecondaryMessage:(null==x||null===(n=x.searchConnectionData)||void 0===n?void 0:n.emptyStateSecondaryMessage)||""},mainContentTitle:null==x?void 0:x.mainContentTitle,mainContentSubTitle:null==x?void 0:x.mainContentSubTitle,stageCheckboxProps:{label:null==x||null===(g=x.configureTableCheckboxData)||void 0===g?void 0:g.label,ariaLabel:null==x||null===(y=x.configureTableCheckboxData)||void 0===y?void 0:y.ariaLabel,checked:!!D,onChange:(e,t)=>{N(e=>C(C({},e),{},{configureTable:t||!1}))}}})})},23510:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(11035),r=a.n(n),i=a(11205),o=a(15544),l=a(23511),c=a(17467),s=a(15514),u=e=>{var t,a,n,u,d,m,b,{wizardState:v,setWizardState:f,goToNextStep:p}=e,g=null===(t=v.connectionSelected)||void 0===t?void 0:t.connectorType;return g===s.b.SqlServer||g===s.b.MicrosoftFabric?r.a.createElement(l.a,{currentConnectionSelected:v.connectionSelected,triggerSearchOfCustomDataset:v.triggerSearchOfCustomDataset,customDatasetUrl:v.customDatasetUrl,workspaceSelected:null===(n=v.workspaceLakehouseDetails)||void 0===n?void 0:n.workspaceSelected,workspaceSelectedKey:null===(u=v.workspaceLakehouseDetails)||void 0===u?void 0:u.workspaceSelectedKey,lakehouseSelected:null===(d=v.workspaceLakehouseDetails)||void 0===d?void 0:d.lakehouseSelected,lakehouseSelectedKey:null===(m=v.workspaceLakehouseDetails)||void 0===m?void 0:m.lakehouseSelectedKey,currentDatasetIdSelected:null===(b=v.datasetSelected)||void 0===b?void 0:b.id,setWizardState:f,goToNextStep:p}):(Object(i.M)(o.a,{eventName:c.n.VirtualTableError,eventData:{error:"The connector type does not have a valid component to select datasets",currentConnectionSelectedId:null===(a=v.connectionSelected)||void 0===a?void 0:a.id}}),r.a.createElement(r.a.Fragment,null))}},23511:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(11035),r=a.n(n),i=a(11203),o=a(12304),l=a(12520),c=a(12329),s=a(12336),u=a(14620),d=a(17452),m=a(17279),b=a(12457),v=a(15521),f=a(23512),p=a(17467),g=a(23475),C=a(17616),y=a(15514);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){T(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O=Object(i.r)("PowerappsPortalEntities")(e=>{var{setWizardState:t,workspaceSelected:a,workspaceSelectedKey:h,lakehouseSelected:T,lakehouseSelectedKey:O}=e,{t:E}=Object(i.s)("PowerappsPortalEntities"),[D,j]=Object(n.useState)(""),[N,w]=Object(n.useState)(""),{currentEnvironment:P}=Object(b.Q)(),[V,x]=Object(n.useState)([]),[k,L]=Object(n.useState)([]),R=(null==P?void 0:P.name)||"",F=Object(n.useRef)(null),M=Object(f.b)(R),A=Object(n.useCallback)((e,t,a,n,r,i)=>{var o=e||t||a;if(i)return{errorMessage:E("VirtualTables.Workspace.ErrorSQLConnection"),loadingMessage:E("VirtualTables.Workspace.LoadingSQLConnection"),isLoading:o};if(r)return{errorMessage:E("VirtualTables.Workspace.ErrorLakehouse"),loadingMessage:E("VirtualTables.Workspace.LoadingLakehouse"),isLoading:o};if(n)return{errorMessage:E("VirtualTables.Workspace.ErrorWorkspace"),loadingMessage:E("VirtualTables.Workspace.LoadingWorkspace"),isLoading:o};var l="";return e?l=E("VirtualTables.Workspace.LoadingWorkspace"):t?l=E("VirtualTables.Workspace.LoadingLakehouse"):a&&(l=E("VirtualTables.Workspace.LoadingSQLConnection")),{errorMessage:"",loadingMessage:l,isLoading:o}},[E]),{data:I,error:z,isInitialLoading:U}=Object(o.a)(["GET_WORKSPACE",M,"",""],v.c),{data:W,error:K,isInitialLoading:B}=Object(o.a)(["GET_LAKEHOUSE",M,(Object(f.a)(V,a)||"").toString(),""],v.a,{enabled:!!V.length&&!!a}),{data:q,error:H,isInitialLoading:_}=Object(o.a)(["GET_SQL_SERVER_DETAILS",M,(Object(f.a)(V,a)||"").toString(),(Object(f.a)(k,T)||"").toString(),Object(f.c)(k,T)],v.b,{enabled:!!k.length&&!!T});Object(n.useEffect)(()=>{var e;!U&&!z&&I&&null!=I&&I.data.length&&x(null==I||null===(e=I.data)||void 0===e?void 0:e.map(e=>({key:null==e?void 0:e.id,text:null==e?void 0:e.name})))},[I,z,U]),Object(n.useEffect)(()=>{var e;!B&&!K&&W&&null!=W&&W.data.length&&L(null==W||null===(e=W.data)||void 0===e?void 0:e.map(e=>S(S({},e),{},{key:null==e?void 0:e.id,text:null==e?void 0:e.displayName})))},[W,K,B]),Object(n.useEffect)(()=>{var e,t;!_&&!H&&q&&null!=q&&q.data?(j(null==q||null===(e=q.data)||void 0===e?void 0:e.tdsEndpoint),w(null==q||null===(t=q.data)||void 0===t?void 0:t.databaseName)):(j(""),w(""))},[q,H,_]),Object(n.useEffect)(()=>{var e="".concat(D,",").concat(N);t(t=>S(S({},t),{},{datasetSelected:{id:e,displayName:e}}))},[D,N,t]),Object(n.useEffect)(()=>{var{errorMessage:e,loadingMessage:a,isLoading:n}=A(U,B,_,z,K,H);t(t=>S(S({},t),{},{errorMessage:e,loadingOrSavingState:{showLoading:n,message:a}}))},[H,_,K,U,z,B,A,t]),Object(n.useEffect)(()=>{!W||null!=W&&W.data&&W.data.length||t(e=>S(S({},e),{},{errorMessage:E("VirtualTables.Workspace.NoLakehouse")})),!I||null!=I&&I.data&&null!=I&&I.data.length||t(e=>S(S({},e),{},{errorMessage:E("VirtualTables.Workspace.NoWorkspace")}))},[I,W,t,E]);return Object(n.useEffect)(()=>{Object(d.T)(d.h,{eventName:p.n.EditVirtualTableConfiguration,eventData:{connectionName:y.a.MicrosoftFabric}})},[]),Object(n.useEffect)(()=>{F.current&&F.current.focus(),t(e=>S(S({},e),{},{errorMessage:""}))},[t]),r.a.createElement(g.a,{titleText:E("VirtualTables.Workspace.Header"),styles:{mainContentArea:{maxWidth:"600px",marginTop:0}}},r.a.createElement("p",null,r.a.createElement(r.a.Fragment,null,E("VirtualTables.Workspace.Title"),r.a.createElement(l.a,{href:C.a.fabricVirtualTable,target:"_blank","aria-label":E("VirtualTables.Workspace.LearnMore")},E("VirtualTables.Workspace.LearnMore")))),r.a.createElement(c.a,{horizontal:!0,wrap:!0,tokens:{childrenGap:12},style:{marginBottom:20,marginTop:30}},r.a.createElement(s.a,{grow:1,basis:250},r.a.createElement(u.a,{label:E("VirtualTables.Workspace.Workspace"),ariaLabel:E("VirtualTables.Workspace.Workspace"),defaultSelectedKey:h,componentRef:F,required:!0,disabled:!1,options:V,onChange:(e,a)=>{L([]),t(e=>S(S({},e),{},{workspaceLakehouseDetails:S(S({},e.workspaceLakehouseDetails),{},{workspaceSelected:(null==a?void 0:a.text)||m.c.None,workspaceSelectedKey:(null==a?void 0:a.key)||m.c.None,lakehouseSelected:"",lakehouseSelectedKey:""}),errorMessage:""})),Object(d.T)(d.h,{eventName:p.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"fabric workspace"}})}}))),r.a.createElement(c.a,{horizontal:!0,wrap:!0,tokens:{childrenGap:12}},r.a.createElement(s.a,{grow:1,basis:250},r.a.createElement(u.a,{label:E("VirtualTables.Workspace.Lakehouse"),ariaLabel:E("VirtualTables.Workspace.Lakehouse"),defaultSelectedKey:O,required:!0,disabled:!1,options:k,onChange:(e,a)=>{t(e=>S(S({},e),{},{workspaceLakehouseDetails:S(S({},e.workspaceLakehouseDetails),{},{lakehouseSelected:(null==a?void 0:a.text)||m.c.None,lakehouseSelectedKey:(null==a?void 0:a.key)||m.c.None})})),Object(d.T)(d.h,{eventName:p.n.EditVirtualTableConfiguration,eventData:{fieldChanged:"fabric lakehouse"}})}}))))})},23512:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return i}));var n=e=>({baseUrl:"https://athena/environment/",environmentId:e}),r=(e,t)=>{if(e.length&&t){var a=e.find(e=>e.text.toLocaleLowerCase().includes(t.toLocaleLowerCase()));return null==a?void 0:a.key}},i=(e,t)=>{if(e.length&&t){var a=null==e?void 0:e.find(e=>null==e?void 0:e.displayName.toLocaleLowerCase().includes(t.toLocaleLowerCase()));return null==a?void 0:a.type}}},23513:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=(e,t)=>({loadingOrSavingState:{showLoading:!1,message:""},errorMessage:"",allApis:void 0,allConnections:void 0,connectionSelected:void 0,workspaceLakehouseDetails:void 0,allConnectionReferences:void 0,usableConnectionReferences:void 0,connectionReferenceSelected:void 0,connectionReferenceIdsInSolution:new Set,manuallyConfigureConnectionReference:!1,shouldCreateConnectionReference:!1,useEnvironmentVariables:!1,connectionReferenceLogicalNamePrefix:"new_",primaryKeyCandidates:void 0,primaryFieldCandidates:void 0,virtualTableColumns:void 0,primaryKeyName:void 0,primaryFieldName:void 0,customizationPrefix:void 0,solutionId:void 0,solutionName:void 0,selectedTableExternalId:void 0,selectedTableExternalName:void 0,selectedTableSchemaName:void 0,tableAlreadyExists:!1,tableAlreadyExistsMessageDismissed:!1,configureTable:!0,isTableDisplayNameValid:!1,isTablePluralNameValid:!1,isTableSchemaNameValid:!1,areColumnsDisplayNamesValid:void 0,areColumnsSchemaNamesValid:void 0,customizationPrefixExistingTable:void 0,useAlternativeCreateConnectionDialog:null!=e&&e,alternativeCreateConnectionRedirectUrl:void 0,alternativeCreateConnectionDialogDetails:null!=t?t:{title:void 0,bodyContent:void 0,primaryButtonText:void 0,cancelButtonText:void 0,primaryButtonAriaLabel:void 0,primaryButtonIconName:void 0,availableApiMessageFirst:void 0,availableApiMessageRest:void 0,availableApiMessageLink:void 0,availableApiMessageLinkText:void 0}})},23514:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(11035),r=a.n(n),i=a(11820),o=a(11205),l=a(23480),c=a(23515),s=a(15514),u=a(15521),d=a(15544),m=a(17042),b=a(23516),v=a(17467),f=a(12457),p=a(15510);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e,t,a){var[g,y]=Object(n.useState)(void 0),{oid:h}=Object(n.useContext)(i.a),{currentEnvironment:S}=Object(f.Q)(),{apis:T,loading:O,errorMessage:E}=Object(u.d)(d.a,e("Common.Request.Failed")),{data:D,isLoading:j,error:N,refetch:w}=Object(p.c)({environmentId:null==S?void 0:S.name},d.a,{unknownErrorType:e("Common.Request.Failed"),authorizationError:e("Common.Request.AuthorizationError"),authenticationError:e("Common.Request.AuthenticationError"),serverResponseCodeError:e("Common.Request.Failed")}),{connectionReferences:P,loading:V,errorMessage:x}=Object(b.a)({apiId:void 0,defaultErrorMessage:e("Common.Request.Failed"),authorizationError:e("Common.Request.AuthorizationError"),authenticationError:e("Common.Request.AuthenticationError")}),{solutionComponents:k,loading:L,errorMessage:R}=Object(m.a)({solutionId:null!=t?t:"",componentLogicalNames:["connectionreference"],telemetryScope:d.a,skip:!t});return Object(n.useEffect)(()=>{var e,t=(null==D||null===(e=D.map(e=>Object(l.b)(e)))||void 0===e?void 0:e.filter(e=>{return!(null==(t=e)||!t.connectorType||!c.a.includes(null==t?void 0:t.connectorType)||(null==t?void 0:t.connectorType)===s.b.SqlServer&&(null==t||null===(a=t.connectionParameter)||void 0===a?void 0:a.name)!==s.c.SQLAuth&&(null==t||null===(n=t.connectionParameter)||void 0===n?void 0:n.name)!==s.c.AAD&&(null==t||null===(r=t.connectionParameter)||void 0===r?void 0:r.name)!==s.c.WindowsAuth&&(null==t||null===(i=t.connectionParameter)||void 0===i?void 0:i.name)!==s.c.WindowsAuthNonShared)&&((e,t)=>!(null==t||!t.createdByUserId||t.createdByUserId!==e))(h,e);var t,a,n,r,i}))||[];y(t),a(e=>C(C({},e),{},{allConnections:t,refetchConnections:w}))},[D,h,w]),Object(n.useEffect)(()=>{a(e=>C(C({},e),{},{allApis:T}))},[T]),Object(n.useEffect)(()=>{a(t=>C(C({},t),{},{errorMessage:N||E||x||R||"",loadingOrSavingState:{showLoading:j||O||V||L||!1,message:j||O?e("VirtualTables.LoadingConnections"):V||L?e("VirtualTables.LoadingConnectionReferences"):""}}))},[N,j,E,O,x,V,R,L]),r.a.useEffect(()=>{P&&a(e=>C(C({},e),{},{allConnectionReferences:P}))},[P]),r.a.useEffect(()=>{k&&(Object(o.O)(d.a,{eventName:v.n.GetConnectionReferencesInSolution,eventData:{connectionReferencesInSolutionCount:k.length}}),a(e=>C(C({},e),{},{connectionReferenceIdsInSolution:new Set(null==k?void 0:k.map(e=>e.objectId))})))},[t,k]),{apis:T,connections:g,loading:j||O,errorMessage:N}}},23515:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(15514),r=[n.b.SharePoint,n.b.SqlServer,n.b.SalesForce,n.b.Oracle]},23516:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(11035),r=a(11205),i=a(15544),o=a(17467),l=a(23517),c=e=>{var{apiId:t,defaultErrorMessage:a,authorizationError:c,authenticationError:s}=e,[u,d]=Object(n.useState)({connectionReferences:void 0,loading:!1}),{connectionReferences:m,loading:b,errorMessage:v}=Object(l.a)({apiId:t},i.a,{unknownErrorType:a,authorizationError:c,authenticationError:s,serverResponseCodeError:a},!0);return Object(n.useEffect)(()=>{Object(r.O)(i.a,{eventName:o.d.GetConnectionReferences,eventData:{loading:b,errorMessage:v,apiId:t,connectionReferencesLength:null==m?void 0:m.length}}),d({loading:b,errorMessage:v,connectionReferences:m})},[m,t,b,v]),u}},23517:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(11818),r=a(12304),i=(a(12729),a(11205)),o=a(11035),l=(a(15530),a(13029)),c=a(23518),s=a(13846),u=a(12457);function d(e,t,a,n,r,i,o){try{var l=e[i](o),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){d(i,n,r,o,l,"next",e)}function l(e){d(i,n,r,o,l,"throw",e)}o(void 0)}))}}var b="https://cds-org/api/data/v9.0/connectionreferences";function v(e,t,a){var d,v,f=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],p=l.g.getConnectionReferences,[g,C]=Object(o.useState)(),[y,h]=Object(o.useState)(""),[S,T]=Object(o.useState)(void 0),O=e.apiId?"?$filter=connectorid eq '".concat(e.apiId,"'"):"",{currentEnvironment:E}=Object(u.Q)(),{isInitialLoading:D,isFetching:j}=Object(r.a)({queryKey:Object(s.b)("powerapps-ui-common","GetConnectionReferencesQuery",null==E?void 0:E.name,null!==(d=e.apiId)&&void 0!==d?d:"-"),queryFn:(v=m((function*(){var e,t,a=yield n.f.get(b+O);return(null==a||null===(e=a.data)||void 0===e||null===(t=e.value)||void 0===t?void 0:t.map(c.a))||[]})),function(){return v.apply(this,arguments)}),enabled:f,onSuccess:t=>{T(t),h(""),g&&g.complete({apiId:e&&e.apiId,count:null==t?void 0:t.length})},onError:e=>{T(void 0);var t=(null==e?void 0:e.message)||a.unknownErrorType;h(t),g&&g.failure({error:t,clientError:null==e?void 0:e.message})}});return Object(o.useEffect)(()=>{(D||j)&&(h(""),C(Object(l.j)(t,p,l.d.DataExperience,l.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium)))},[D,j]),{loading:D||j,errorMessage:y,connectionReferences:S}}},23518:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(13707),r=a.n(n),i=a(23519);function o(e){return r()({id:"connectionreferenceid",name:"connectionreferencelogicalname",displayName:"connectionreferencedisplayname",solutionId:"solutionid",connectorId:"connectorid",connectionId:"connectionid",description:"description",isManaged:"ismanaged"},e,i.a)}},23519:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));class n{constructor(e,t,a,n,r,i,o,l){this.id=e,this.name=t,this.displayName=a,this.solutionId=n,this.connectorId=r,this.connectionId=i,this.description=o,this.isManaged=l,this.id=e,this.name=t,this.displayName=a,this.solutionId=n,this.connectorId=r,this.connectionId=i,this.description=o,this.isManaged=l}}},23520:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(11035),r=a(15544),i=a(16797),o=a(11205),l=a(23473),c=a(12092),s=a(17467),u=a(23515),d=a(15517),m=a(17360),b=a(16799);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Object(c.ib)({icons:{quickFormat:n.createElement("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M3.50013 0C3.70014 0 3.88091 0.119198 3.9597 0.30304L6.84443 7.03407L6.09096 7.78754C6.07144 7.75971 6.05448 7.72945 6.04056 7.69696L5.31329 6H1.68697L0.959701 7.69696C0.850923 7.95077 0.556983 8.06835 0.303169 7.95957C0.0493537 7.85079 -0.0682221 7.55686 0.0405557 7.30304L3.04056 0.30304C3.11935 0.119198 3.30011 0 3.50013 0ZM4.88472 5L3.50013 1.7693L2.11554 5H4.88472ZM13.3118 5.19062C13.3143 5.12693 13.3156 5.06241 13.3156 4.99707C13.3156 3.17627 12.3595 2 10.8878 2C10.0929 2 9.38929 2.39209 9.07239 3.01514H9.00013V0.5C9.00013 0.223858 8.77627 0 8.50013 0C8.22399 0 8.00013 0.223858 8.00013 0.5V5.87837L9.00013 4.87837V4.48435C9.14904 3.45151 9.76229 2.83252 10.673 2.83252C11.5257 2.83252 12.0993 3.35921 12.2899 4.27206C12.4601 4.37475 12.6207 4.49953 12.7676 4.64642L13.3118 5.19062ZM8.50081 14C7.97293 14.1866 7.36148 14.0687 6.93919 13.6464L5.3534 12.0606C4.76762 11.4748 4.76762 10.5251 5.3534 9.93931L9.93919 5.35352C10.525 4.76774 11.4747 4.76774 12.0605 5.35352L13.6463 6.93931C14.2321 7.5251 14.2321 8.47484 13.6463 9.06063L10.3615 12.3454C10.3589 12.3481 10.3563 12.3509 10.3536 12.3536C10.3509 12.3563 10.3481 12.3589 10.3454 12.3615L9.70693 13H11.5C11.7761 13 12 13.2239 12 13.5C12 13.7761 11.7761 14 11.5 14H8.50081ZM9.2928 11.9999L6.99991 9.70702L6.06051 10.6464C5.86525 10.8417 5.86525 11.1583 6.06051 11.3535L7.6463 12.9393C7.84156 13.1346 8.15814 13.1346 8.3534 12.9393L9.2928 11.9999ZM9.99991 11.2928L12.9392 8.35352C13.1345 8.15826 13.1345 7.84168 12.9392 7.64642L11.3534 6.06063C11.1581 5.86537 10.8416 5.86537 10.6463 6.06063L7.70702 8.99991L9.99991 11.2928Z",fill:"#742774"}))}});var g=(e,t,a,n,i,c,u,d,b,v)=>{var p=y(e,i?()=>{i(),Object(o.O)(r.a,{eventName:s.n.RefreshConnections}),v&&v(s.n.RefreshConnections)}:void 0);switch(t){case l.a.selectConnection:return a?[C(e,a,n,d,b,v),p]:[p];case l.a.selectDataset:return c?[y(e,c?()=>{c(),Object(o.O)(r.a,{eventName:s.n.RefreshDatasets})}:void 0)]:[];case l.a.selectTable:return[y(e,u?()=>{u(),Object(o.O)(r.a,{eventName:s.n.RefreshTables})}:void 0)];case l.a.stageVirtualTable:return[h(e,()=>{n(e=>f(f({},e),{},{selectedTableExternalName:e.selectedTableExternalName?S(e.selectedTableExternalName):void 0,selectedTablePluralName:e.selectedTablePluralName?S(e.selectedTablePluralName):void 0,selectedTableSchemaName:e.selectedTableSchemaName?e.tableAlreadyExists?e.selectedTableSchemaName:Object(m.b)(S(e.selectedTableSchemaName)):void 0}))})];default:return[]}},C=(e,t,a,n,l,c)=>{var m=Object(b.e)();return{key:"newConnectionForVirtualTables",text:e("VirtualTables.Connection.NewConnection"),ariaLabel:e("VirtualTables.Connection.NewConnection"),iconProps:{iconName:"Add"},onClick:()=>{if(Object(o.O)(r.a,{eventName:s.n.CreateConnectionDialog,eventData:{openCreateConnectionDialog:!0}}),c&&c(s.n.CreateConnectionDialog,{openCreateConnectionDialog:!0}),n){var e=Object(i.C)(t,!0,1===u.a.length?Object(d.b)(u.a[0]):void 0);a(t=>f(f({},t),{},{useAlternativeCreateConnectionDialog:!0,alternativeCreateConnectionRedirectUrl:e})),l&&l(!0)}a(e=>f(f({},e),{},{openCreateConnectionDialog:!0}))},href:n?void 0:Object(i.o)(t,!0,1===u.a.length?Object(d.b)(u.a[0]):void 0,m),target:"_blank"}},y=(e,t)=>({key:"refreshCommandBarItemForVirtualTables",text:e("Common.Refresh"),ariaLabel:e("Common.Refresh"),iconProps:{iconName:"Refresh"},onClick:t}),h=(e,t)=>({key:"quickFormatCommandBarItemForVirtualTables",text:e("VirtualTables.Configure.QuickFormatNames"),ariaLabel:e("VirtualTables.Configure.QuickFormatNames"),iconProps:{iconName:"quickFormat"},title:e("VirtualTables.Configure.QuickFormatButtonTooltip"),onClick:t});function S(e){return null==e?void 0:e.substring(e.indexOf(".")+1)}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/191.25d6206e.chunk.js.map