/*! For license information please see homepage~powerportals-home.6249ba4f.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{24695:function(e,t,a){"use strict";a.r(t),a.d(t,"_PowerPortalsLandingPage",(function(){return H})),a.d(t,"PowerPortalsLandingPage",(function(){return z}));var n=a(14691),r=a(11203),c=a(11035),i=a.n(c),o=a(24696),s=a(13679),l=a(13690),u=a(12959),d=a(12457),m=a(13676),g=a(12734),E=a(13772),p=a(11066),v=a(12341),b=a(13420),f=a(14917),O=a(13226),h=a(13463),j=a(13667),y=a(11382),P=a(14914),S=a(15189),C=a(13695),I=a(13462),N=a(12741),w=a(14919),x=a(13849),T=a(11205),L=a(13791),M=a(15077),R=a(16258),_=a(12307),k=a(13774),A=a(15193),D=a(12712),X=a(14385),B=a(12960),V=a(15267);function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){G(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function G(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function W(e,t,a,n,r,c,i){try{var o=e[c](i),s=o.value}catch(l){return void a(l)}o.done?t(s):Promise.resolve(s).then(n,r)}function q(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function i(e){W(c,n,r,i,o,"next",e)}function o(e){W(c,n,r,i,o,"throw",e)}i(void 0)}))}}var H=e=>{var t,a=Object(w.a)(),r=Object(y.i)(),[p,U]=Object(c.useState)(!1),[G,W]=Object(c.useState)(!0),[H,z]=Object(c.useState)(),[K,Q]=Object(c.useState)(""),{currentEnvironment:J,isSuccess:Y}=Object(d.Q)(),{switchEnvironment:Z}=Object(d.V)(),{environments:$,refetch:ee,isSuccess:te}=Object(d.S)(),ae=a.get("environmentId")||a.get("environmentId".toLowerCase()),ne=a.get("ppages_source")||a.get("ppages_source".toLowerCase()),re=Object(V.f)(a),ce=Object(_.b)();Object(c.useEffect)(()=>{ee()},[ee]);var{powerPortalUserSettings:ie,hasLoaded:oe}=Object(D.c)();m.a.setDefaultEnvironmentLocation(null!==(t=null==J?void 0:J.location)&&void 0!==t?t:"unitednations");var se=Object(c.useCallback)(q((function*(){if(ae){var e={environmentId:ae},t=$.find(e=>e.name===ae);if(!t)try{t=yield Object(x.c)(g.a.getInstance(),ae,ce)}catch(i){Object(T.ab)(I.n,{eventName:"PowerPortalsLandingPage/switchToDefaultEnvironment/getEnvironmentDetails",eventData:F(F({},e),{},{name:"getEnvironmentDetailsError",message:"Error when fetching environment details"})})}if(Object(R.b)(t))return void z(t)}if(J){var a=$.find(e=>e.name===J.name);if(a&&Object(R.b)(a))return void z(a)}var n=$.find(e=>Object(R.b)(e));if(n)z(n);else{var r=$.find(e=>{var t;return(null==e||null===(t=e.properties)||void 0===t?void 0:t.environmentSku)===I.e.Developer});if(r)z(r);else{null!=ie&&ie.hasVisited5X5Experience||U(!0);var c=$.find(e=>e.properties.isDefault);z(c)}}})),[J,$,null==ie?void 0:ie.hasVisited5X5Experience,ae,ce]);return Object(c.useEffect)(()=>{!oe||null!=ie&&ie.hasVisited5X5Experience||g.a.getInstance().featureUsage(L.a.CREATE_EXPERIENCE_5X5,E.pc,{sourcePageName:ne})},[oe,null==ie?void 0:ie.hasVisited5X5Experience,ne]),Object(c.useEffect)(()=>{if(oe&&ne)if("websignup"!==ne)g.a.getInstance().info(null!=ie&&ie.hasVisited5X5Experience?E.bd:E.qc,"".concat(null!=ie&&ie.hasVisited5X5Experience?"Returning":"New"," user has been redirected from: ").concat(ne));else{var e="websignup"===ne&&ae?"Success":"Failure",t="marketingRedirectParam: ".concat(ne," environmentIdParam: ").concat(ae," marketingRedirectStatus: ").concat(e);g.a.getInstance().info(null!=ie&&ie.hasVisited5X5Experience?E.ic:E.hc,null!=ie&&ie.hasVisited5X5Experience?"Returning user has been redirected from Marketing. ".concat(t):t)}},[oe,ne,null==ie?void 0:ie.hasVisited5X5Experience,ae]),Object(c.useEffect)(()=>{oe&&null!=ie&&ie.hasVisited5X5Experience&&(C.a.dispatch("progressTracking","\r\n ".concat(Object(N.i)(),"|Started on 5x5")),window[I.t]||(window[I.t]=""),window[I.t]+="\r\n ".concat(Object(N.i)(),"|Started on 5x5"))},[oe,null==ie?void 0:ie.hasVisited5X5Experience]),Object(c.useEffect)(()=>{oe&&te&&se()},[se,oe,te]),Object(c.useEffect)(()=>{var e=function(){var e=q((function*(){var e,t=yield Object(u.b)();return Object(X.a)({payload:{tenantId:t,environmentId:null!==(e=H.name)&&void 0!==e?e:""},telemetryOptions:{telemetryScope:I.n},queryClient:B.a.getInstance()})}));return function(){return e.apply(this,arguments)}}();if(H&&"websignupalt"===ne)try{e()}catch(a){var t=Object(k.b)(a);t&&t.length>0&&Object(M.c)(t[0])&&g.a.getInstance().warn(E.C,"User does not have permission to create portals in tenants. Redirecting to home")}},[H,ne]),Object(c.useEffect)(()=>{if(H){var e="";e=null!=ie&&ie.hasVisited5X5Experience?re?"e/".concat(H.name,"/portals/dataToSite"):"environments/".concat(H.name,"/portals/home"):"/",(ae||re||ne)&&(e="".concat(e,"?").concat(a.toString())),Q(e)}},[H,null==ie?void 0:ie.hasVisited5X5Experience,ae,a,re]),Object(c.useEffect)(()=>{H&&K&&(Z(H,K),g.a.getInstance().info(E.nb,"Expecting selected Environment: ".concat(H.name)),W(!1))},[H,K,Z]),G?i.a.createElement(b.a,{size:v.a.large,labelPosition:"bottom",loadingText:"",showOverlay:!1,className:f.h.loaderCSS}):Y?i.a.createElement(A.a,{title:e.t("UniquePageTitles.Welcome")},i.a.createElement(s.b,null,i.a.createElement(l.b,null,i.a.createElement(S.a,null),i.a.createElement(P.b,{shouldCreateDevEnvironmentIfAllowed:p},i.a.createElement(n.a,{styles:{body:{padding:"0px"}},renderBody:()=>i.a.createElement(o.a,{key:null==J?void 0:J.name,userSettings:ie,shouldCreateDevEnvironment:p})}))))):i.a.createElement(O.a,{primaryLabel:e.t("NotAllowedTenantListMessage.PrimaryMessage"),secondaryLabel:e.t("NotAllowedTenantListMessage.SecondaryMessage"),buttonText:e.t("NotAllowedTenantListMessage.ButtonText"),onButtonClick:()=>r.push("/environments/".concat(null==J?void 0:J.name,"/home")),imageProps:{src:h.a.getPaths().errorScenario,styles:j.b,alt:e.t("ImageAltText.errorScenario")}})},z=Object(p.a)(H,[Object(r.r)("PowerPortalsHome")]);t.default=z},24696:function(e,t,a){"use strict";a.d(t,"a",(function(){return q}));var n=a(12280),r=a(12707),c=a(12520),i=a(12347),o=a(12734),s=a(12741),l=a(11820),u=a(11066),d=a(11203),m=a(11035),g=a.n(m),E=a(11382),p=a(14951),v=a(13462),b=a(13772),f=a(13791),O=a(13676),h=a(13679),j=a(14917),y=a(13421),P=a(13770),S=a(11435),C=a(14381),I=a(12600),N=a(14953),w=a.n(N),x=a(13463),T=a(13849),L=a(12307),M=a(12457),R=a(12735),_=a(24697),k=a(14894),A=a(15107),D=a(15267),X=a(14919),B=a(14382),V=a(13696),U=a(12339),F=a(12341);function G(e,t,a,n,r,c,i){try{var o=e[c](i),s=o.value}catch(l){return void a(l)}o.done?t(s):Promise.resolve(s).then(n,r)}function W(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function i(e){G(c,n,r,i,o,"next",e)}function o(e){G(c,n,r,i,o,"throw",e)}i(void 0)}))}}var q=Object(u.a)(e=>{var t,a=Object(E.i)(),i=Object(X.a)(),{state:l,dispatch:u}=Object(m.useContext)(h.a),{environmentClient:d,userSettings:N,shouldCreateDevEnvironment:G}=e,q=Object(C.a)(j.e),H=Object(C.a)(j.c),z=Object(C.a)(j.d);d&&O.a.setApolloClientEnvironment(d);var[K,Q]=Object(m.useState)(!1),{enableDevEnvironmentCreateExperience:J}=Object(I.oc)(),{brand:Y}=Object(y.a)(),{currentEnvironment:Z,refetch:$}=Object(M.Q)(),ee=V.a.getContextMap(),{isNL2SiteEnabled:te,isCopilot5x5Experience:ae,isPowerPagesCopilotConfigLoading:ne,isNewDataModelSupported:re,isNewDataModelSupportedLoading:ce}=Object(A.a)(v.k.COPILOT_CREATE_EXPERIENCE_5X5),ie=Object(m.useRef)(!1),[oe,se]=Object(m.useState)(!0),le=Object(m.useRef)(f.a.CREATE_EXPERIENCE_5X5);Object(m.useEffect)(()=>{ne||ce?(ie.current=!1,se(!0),le.current=f.a.CREATE_EXPERIENCE_5X5,ee.referrer=v.k.CREATE_EXPERIENCE_5X5,ee.currentSurface=v.k.CREATE_EXPERIENCE_5X5):ae&&re?(ie.current=!0,se(!1),le.current=f.a.COPILOT_CREATE_EXPERIENCE_5X5,ee.referrer=v.k.COPILOT_CREATE_EXPERIENCE_5X5,ee.currentSurface=v.k.COPILOT_CREATE_EXPERIENCE_5X5):(ie.current=!1,se(!0)),V.a.setContextMap(ee)},[ee,ae,re,ce,ne]);var[ue,de]=Object(B.a)(Z,Object(s.m)(Z),Object(s.n)(Z)),me=Object(m.useMemo)(()=>null==Z?void 0:Z.properties.isDefault,[null==Z?void 0:Z.properties.isDefault]),ge=oe?q:H,Ee=Object(L.b)(),{switchEnvironment:pe}=Object(M.V)(),{enableSharePointListToSite:ve}=Object(I.uc)(),be=Object(m.useMemo)(()=>Object(D.f)(i)&&ve,[ve,i]),fe=Object(m.useMemo)(()=>Object(D.c)(i),[i]);Object(m.useEffect)(()=>{o.a.getInstance().featureUsage(le.current,b.Vb)},[]);var Oe,he,je=function(){var e=W((function*(){var e;return o.a.getInstance().info(b.R,"Adding developer environment from 5x5 landing page"),Object(T.a)(Ee).then(function(){var t=W((function*(t){if(t){e=yield Object(T.c)(o.a.getInstance(),t,Ee);var n="/".concat(a.location.search);return pe(e,n),yield $(!0),o.a.getInstance().info(b.e,"Added new developer environment to picker ".concat(e.name)),o.a.getInstance().info(b.S,"Developer environment successfully created from 5x5 landing page"),Promise.resolve()}}));return function(e){return t.apply(this,arguments)}}()).catch(e=>(o.a.getInstance().info(b.Q,"Developer environment creation failure from 5x5 landing page."),ie.current?Promise.reject(e):Promise.resolve()))}));return function(){return e.apply(this,arguments)}}(),ye=Object(m.useCallback)(e=>{o.a.getInstance().featureUsage(le.current,b.Lb,{redirectFrom:"landingPage",redirectReason:e}),o.a.getInstance().getAnalyticsTracker(le.current).progressTracking("".concat(le.current,"_HOMEPAGE_REDIRECT")),o.a.getInstance().info("HOMEPAGE_REDIRECT_URL","/environments/".concat(null==Z?void 0:Z.name,"/portals/home")),a.push("/environments/".concat(null==Z?void 0:Z.name,"/portals/home"))},[null==Z?void 0:Z.name,a]),Pe=Object(m.useCallback)(W((function*(){o.a.getInstance().featureUsage(le.current,b.o,{stageName:"WELCOME_STAGE",stageStep:"0 of 3"}),N?!N||null!=N&&N.isWelcomeEmailSent||Object(P.d)(e.puid,O.a.getEnvironmentId()):o.a.getInstance().featureUsage(f.a.WELCOME_EMAIL,b.Kd,{userId:e.puid,message:"Failed to fetch user personalization settings"});try{G&&J&&(Q(!0),yield je(),Q(!1)),be?a.push({pathname:"/e/:environmentId/portals/dataToSite",state:{dataSourceDetails:fe}}):ie.current?a.push({pathname:"/e/:environmentId/portals/create",search:a.location.search,hash:k.a.roleAndIndustry,state:{isNL2SiteEnabled:te,isCopilot5x5Experience:ie.current}}):a.push({pathname:"/e/:environmentId/portals/create",search:a.location.search})}catch(t){ie.current&&ye("DEV_ENVIRONMENT_CREATION_FAILED")}window[v.t]+="\r\n ".concat(Object(s.i)(),"|Clicked on Get Started")})),[]),Se=Object(m.useCallback)(()=>{be?Pe():ie.current?ue||de||me?(u(Object(p.a)(!0)),Pe()):(o.a.getInstance().featureUsage(le.current,b.B,{source:"landingPage"}),ye("PORTAL_CREATION_PERMISSIONS_MISSING")):(u(Object(p.b)(!0)),Pe())},[u,Pe,ue,be,me,ye,de]);return ne||ce?g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:z.spinnerContainer},g.a.createElement(U.a,{size:F.a.large,className:z.loaderCSS}))):l.portalCreationLandingPageState.showLandingPage?g.a.createElement("div",{className:j.f.containerStyleProps},oe?K?(he={options:{loop:!0,autoplay:!0,speed:1,animationData:x.a.getPaths().environmentCreationGif,rendererSettings:{className:"".concat(j.f.bgBase," ").concat(j.f.gifOverlay),preserveAspectRatio:"xMaxYMax meet"}}},g.a.createElement(w.a,he)):(Oe=g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"".concat(j.f.bgBase," ").concat(j.f.bgBackdrop)}),g.a.createElement("div",{className:"".concat(j.f.bgBase," ").concat(j.f.bgOverlay)})),be||oe?Oe:g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"".concat(j.a.bgBase," ").concat(j.a.bgBackdrop)},g.a.createElement("div",{className:j.a.backgroundContainer},g.a.createElement("div",{className:j.a.animationContainer},g.a.createElement("div",{className:j.a.bgOverlay})))))):(()=>{var e={options:{loop:!0,autoplay:!1,speed:1,style:{marginRight:"auto"},animationData:x.a.getPaths().landingPageBusyGif,rendererSettings:{className:"".concat(j.a.gifOverlay),preserveAspectRatio:"xMaxYMax meet"}},width:"100%",height:"100%",isStopped:!K};return g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"".concat(j.a.bgBase," ").concat(j.a.bgBackdrop)},g.a.createElement("div",{className:j.a.backgroundContainer},g.a.createElement("div",{className:j.a.animationContainer},g.a.createElement(w.a,e)))))})(),g.a.createElement("div",{className:j.f.content},g.a.createElement("div",{className:j.b.favIconStyle}),g.a.createElement("div",{role:"presentation",className:ge.root},g.a.createElement("h1",{className:ge.primaryMessage},e.t("LandingPage.WelcomeMessage",{AppName:Y,UserName:null==e||null===(t=e.name)||void 0===t?void 0:t.split(" ")[0]})),be?g.a.createElement("p",{className:ge.secondaryMessage,[R.k]:_.a.secondaryMessage},e.t("LandingPage.DataToSite.SecondaryMessage",{DataType:Object(D.d)(null==fe?void 0:fe.dataType,e.t)})):oe?g.a.createElement("p",{className:ge.secondaryMessage,[R.k]:_.a.secondaryMessage},e.t("LandingPage.SecondaryMessage")):g.a.createElement(g.a.Fragment,null,g.a.createElement("p",{className:ge.secondaryMessage},e.t("LandingPage.CopilotSecondaryMessage")),g.a.createElement("p",{className:ge.secondaryMessage},e.t("LandingPage.SecondaryMessage"))),g.a.createElement(n.a,{text:e.t("LandingPage.ActionButtonText"),className:ge.button,disabled:K,onClick:W((function*(){Se()})),[R.k]:_.a.getStartedButton})),oe&&g.a.createElement(r.a,{className:j.g.actionButtonSecondaryMessage},e.t("LandingPage.ActionButtonSecondaryText")),K&&g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{role:"alert","aria-label":e.t("LandingPage.SettingUpEnvironmentText")},g.a.createElement(r.a,{className:ge.secondaryMessage},e.t("LandingPage.SettingUpEnvironmentText")))),g.a.createElement(r.a,{className:j.g.actionButtonSecondaryMessage},g.a.createElement(S.a,{t:e.t,i18nKey:"LandingPage.LandingPageTermCondition"},g.a.createElement(c.a,{underline:!0,href:v.w,target:"_blank"}))," ",(G&&J||(null==Z?void 0:Z.properties.environmentSku)===v.e.Developer)&&g.a.createElement(S.a,{t:e.t,i18nKey:"LandingPage.DeveloperPlanStatement"},g.a.createElement(c.a,{underline:!0,href:v.q,target:"_blank"}))),g.a.createElement(r.a,{className:j.g.actionButtonSecondaryMessage},g.a.createElement(c.a,{underline:!0,href:v.s,target:"_blank"},e.t("LandingPage.PrivacyStatement"))))):g.a.createElement(g.a.Fragment,null)},[l.d,Object(d.r)("PowerPortalsHome"),i.g])},24697:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={getStartedButton:"landing-page-primary-button",secondaryMessage:"landing-page-secondary-message"}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/homepage~powerportals-home.6249ba4f.chunk.js.map