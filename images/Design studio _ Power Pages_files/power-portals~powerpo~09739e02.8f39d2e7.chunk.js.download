/*! For license information please see power-portals~powerpo~09739e02.8f39d2e7.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{24358:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n(24359),r=n(11035),o=n(12304),c=n(11045),a=n(12600),u=n(12734),l=n(12740),s=n(11203),d=n(12703),m=n(12078),b=n(11820),v=n(13417),f=n(12741),p=n(24361);function y(e,t,n,i,r,o,c){try{var a=e[o](c),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(i,r)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function c(e){y(o,i,r,c,a,"next",e)}function a(e){y(o,i,r,c,a,"throw",e)}c(void 0)}))}}function g(e,t,n){var{tid:y,oid:g}=Object(r.useContext)(b.a),{enablePowerPagesNPSSurvey:I}=Object(a.ed)(),h=Object(c.k)(),S=Object(p.a)(g,y,n),O=Object(r.useRef)(null),_=Object(m.a)(O),P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u.a.getInstance().featureUsage(v.b.NPS_SURVEY,e,t)};Object(r.useEffect)(()=>{P(l.USE_NPS_SURVEY_HOOK_INIT)},[]),Object(r.useEffect)(()=>{Object(i.e)()},[_]);var{data:j}=Object(o.a)(["powerpages/loadSurveyScript"],E((function*(){return yield Object(f.u)(i.a.embedScriptUrl,i.a.embedScriptId),yield Object(f.v)(i.a.embedStyleUrl,i.a.embedLinkId),P(l.LOAD_CV_EMBEDS_SUCCESS),!0})),{enabled:Boolean(I&&!n&&S&&S.eligibility&&(S.uiType===i.b.CV||null===S.uiType))});Object(r.useEffect)(()=>{if(I&&e&&y&&null!=S&&S.eligibility&&void 0!==window[i.a.embedFunction]&&null===document.getElementById(i.a.popupDiv)&&j){P("".concat(l.RENDER_CV_FORM,"_TRUE"));try{Object(i.d)(y,e,h.location,"0.0.20240520.2-2405.2-prod",Object(s.g)(),Object(d.a)(),window.location.href,S.formsProEligibilityId,S.eligibilityEcsConfigId),Object(i.c)(t),Object(i.e)()}catch(o){n="Error trying to render CV form",r=o,u.a.getInstance().error(l.NPS_SURVEY_ERROR,n,r)}}else P("".concat(l.RENDER_CV_FORM,"_FALSE"),{ecsFlagEnabled:I,envIdTruthy:!!e,tidTruthy:!!y,userEligible:!(null==S||!S.eligibility),embedFunctionTruthy:!!window[i.a.embedFunction],surveyNotAlreadyRendered:null===document.getElementById(i.a.popupDiv)});var n,r},[y,e,S,I,h.location,t,_,j])}},24359:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));var i=n(24360),r=n.n(i),o={surveyName:"PowerPages-NPS",teamName:"PowerPages",triggerEventName:"visitHomepage",popupDiv:"MfpEmbed_Popup",overlayDiv:"mfpembed_overlayDiv",iconDiv:"mfpembed_iconDiv",crossButton:"MfpEmbed_CrossButton",iframe:"MfpEmbed_Popup_Iframe",height:460,heightBP:600,mobileHeight:480,mobileBreakpoint:640,formsProId:"v4j5cvGGr0GRqy180BHbRyuriZyTXitBrgQcfjK0plVUOE5POUVGTVRDUDI1SEVaOFVaV1RGM0k4Vy4u",embedFunction:"SurveyEmbed",renderFunction:"renderSurvey",embedScriptUrl:"https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/Embed.js",embedStyleUrl:"https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/Embed.css",embedScriptId:"cv-embed-script",embedLinkId:"cv-embed-link",script:'function renderSurvey(TenantId, ObjectId, EnvironmentId, Geo, ProductVersion, Culture, DeviceType, Referrer){var se = new SurveyEmbed("v4j5cvGGr0GRqy180BHbRyuriZyTXitBrgQcfjK0plVUOE5POUVGTVRDUDI1SEVaOFVaV1RGM0k4Vy4u","https://customervoice.microsoft.com/","https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/","true");var context = {"TenantId": TenantId,"UserId": UserId,"EnvironmentId": EnvironmentId, "Geo": Geo, "ProductVersion": ProductVersion, "Culture": Culture, "DeviceType": DeviceType, "Referrer": Referrer};se.renderPopup(context);}'};function c(e,t,n,i,r,c,a,u,l){var s={TenantId:e,EnvironmentId:t,Geo:n,ProductVersion:i,Culture:r,DeviceType:c,UrlReferrer:a,FormsProEligibilityId:u,EligibilityEcsConfigId:l};new window[o.embedFunction]("v4j5cvGGr0GRqy180BHbRyuriZyTXitBrgQcfjK0plVUOE5POUVGTVRDUDI1SEVaOFVaV1RGM0k4Vy4u","https://customervoice.microsoft.com/","https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/?width=700px","true").renderPopup(s)}function a(){var e=document.getElementById(o.popupDiv);e&&(window.innerHeight<=o.heightBP?(e.style.maxWidth="80%",e.style.height="90%"):window.innerWidth<=o.mobileBreakpoint?(e.style.maxWidth="290px",e.style.height="".concat(o.mobileHeight,"px")):(e.style.maxWidth="420px",e.style.height="".concat(o.height,"px")))}function u(e){var t=document.getElementById(o.iconDiv);t&&(t.style.width="21px",t.style.height="21px",t.style.border="0px",t.style.right="6px",t.style.top="6px",t.style.position="absolute",t.style.marginRight="0",t.style.marginTop="0",t.style.fontStyle="normal",t.style.borderRadius="50%",t.style.borderColor="white");var n=document.getElementById(o.crossButton);n&&(n.setAttribute("src",r.a),n.style.width="14px",n.style.height="14px",n.style.boxSizing="unset",n.style.cursor="pointer");var i=document.getElementById(o.iframe);i&&(i.style.borderRadius="2px",i.addEventListener("load",()=>{i.focus(),i.setAttribute("tabindex","1")}),i.hasAttribute("title")||i.setAttribute("title",e("PortalHome.NPSSurveyTitle")),i.hasAttribute("aria-label")||i.setAttribute("aria-label",e("PortalHome.NPSSurveyTitle")));var c=document.getElementById(o.crossButton),a=document.getElementById(o.popupDiv);c&&(c.setAttribute("tabindex","1"),c.hasAttribute("alt")||c.setAttribute("alt",e("PortalHome.CloseSurvey")),c.addEventListener("focusout",()=>{a.focus(),i.focus()}),c.addEventListener("keypress",()=>{c.click()}))}var l=function(e){return e.SDK="SDK",e.CV="CV",e}({})},24360:function(e,t,n){e.exports=n.p+"static/media/cancel.a3ac4b60.svg"},24361:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(12304),r=n(12740),o=n(12734),c=n(24359),a=n(24362);function u(e,t,n,i,r,o,c){try{var a=e[o](c),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(i,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function c(e){u(o,i,r,c,a,"next",e)}function a(e){u(o,i,r,c,a,"throw",e)}c(void 0)}))}}function s(e,t,n){return Object(i.a)(["eligibility"],l((function*(){return Object(a.a)(c.a.surveyName,c.a.triggerEventName,c.a.teamName,t,e)})),{enabled:!n,retry:!1,onError:e=>((e,t)=>{o.a.getInstance().error(r.NPS_SURVEY_ERROR,e,t)})("Error during CES call",e)}).data}},24362:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(11818),r=n(12411);function o(e,t,n,i,r,o,c){try{var a=e[o](c),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(i,r)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var c=e.apply(t,n);function a(e){o(c,i,r,a,u,"next",e)}function u(e){o(c,i,r,a,u,"throw",e)}a(void 0)}))}}function a(e,t,n,i,r){return u.apply(this,arguments)}function u(){return(u=c((function*(e,t,n,r,o){var c="".concat("https://ces/api/v1","/").concat(n,"/Eligibilities/").concat(e,"?userId=").concat(o,"&eventName=").concat(t,"&tenantId=").concat(r),a=yield i.f.post(c);return a?l(a.data):null}))).apply(this,arguments)}function l(e){return Object(r.mapKeys)(e,(e,t)=>Object(r.camelCase)(t))}},24501:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n(11035),r=n.n(i),o=n(11819),c=n(11045),a=n(12705),u=n(11203),l=n(24502),s=n(12307),d=n(12457),m=n(24639),b=n(12734),v=n(12740),f=n(13417),p=n(24359),y=n(24361),E=n(12600),g=n(13421);function I(e,t,n,i,r,o,c){try{var a=e[o](c),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(i,r)}var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object({NODE_ENV:"production",PUBLIC_URL:"",CI:!0,APP:"powerpages-microsoft-com",LOCALES_HASH:"XDT_CZcwhr25",AAD_INSTANCE:{high:"https://login.microsoftonline.us/",dod:"https://login.microsoftonline.us/",mooncake:"https://login.chinacloudapi.cn/",ex:"https://login.microsoftonline.eaglex.ic.gov/",rx:"https://login.microsoftonline.microsoft.scloud/"},SETTINGS_FALLBACK_REGION:{},BUILD_COMMIT_ID:"acb1e176f7c9a8266fd1bc3ec52d279471f99ad2",BUILD_NAME:"0.0.20240520.2-2405.2-prod",BUILD_BRANCH:"2405.2",BUILD_DATE_TIME:"Mon, 20 May 2024 20:51:46 GMT",BUILD_SHELL_VERSION:"1.0.0",_UNSAFE_DONT_USE_BUILD_MODULE_TYPE:"module"}).JEST_WORKER_ID||b.a.getInstance().featureUsage(f.b.NPS_SURVEY,e,t)},S=()=>{var{enablePowerPagesNPSSurvey:e}=Object(E.ed)(),{tid:t,oid:n}=Object(o.o)(),[b,f]=Object(i.useState)(!1),[S,O]=Object(i.useState)(null),{region:_,location:P}=Object(c.k)(),j=Object(s.b)(),R=Object(y.a)(n,t),{brand:T}=Object(g.a)(),C=Object(a.a)(),{currentEnvironment:D}=Object(d.Q)();h(v.CES_CALL_CHECKING_ELIGIBILITY),Object(i.useEffect)(()=>{(null==R?void 0:R.uiType)===p.b.SDK&&h(v.NPS_SURVEY_SDK_INIT)}),Object(i.useEffect)(()=>{var e=()=>{h(v.NPS_SURVEY_SDK_RENDER_SUCCESS)};if(null!=R&&R.eligibility&&"undefined"!=typeof window)return window.addEventListener("survey-ui-load",e),()=>{window.removeEventListener("survey-ui-load",e)}},[R]),Object(i.useEffect)(()=>{f(null==R?void 0:R.eligibility),null!=R&&R.eligibility&&h(v.CES_CALL_USER_ELIGIBILITY_TRUE,{responseHasFormsProId:!!R.formsProEligibilityId,responseHasEcsConfigId:!!R.eligibilityEcsConfigId})},[R]);var w=Object(i.useCallback)(()=>{j.invalidateQueries({queryKey:["eligibility"]})},[j]);Object(i.useEffect)(()=>{(function(){var e,t=(e=function*(){var e=yield Object(o.f)("https://microsoft.onmicrosoft.com/cessurvey");O(e.accessToken)},function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function c(e){I(o,i,r,c,a,"next",e)}function a(e){I(o,i,r,c,a,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}})()()},[]);var N=Object(i.useMemo)(()=>({teamName:p.a.teamName,surveyName:p.a.surveyName,userId:n,tenantId:t,locale:Object(u.g)(),environment:"test"===_||"preprod"===_?l.a.INT:l.a.PROD,region:"eu"===Object(c.b)()?l.b.Europe:l.b.World,template:l.d.NPS,uiType:l.e.Modal,accessToken:S?{getAccessTokenAsync:()=>Promise.resolve(S)}:void 0,stringPlaceholders:{appName:T},theme:{accentBaseColor:C.palette.themePrimary},productContext:[null!=R&&R.eligibilityEcsConfigId?{key:"EligibilityEcsConfigId",value:R.eligibilityEcsConfigId}:{key:"EligibilityEcsConfigId",value:void 0},P?{key:"Geo",value:P}:{key:"Geo",value:void 0},null!=D&&D.name?{key:"EnvironmentId",value:D.name}:{key:"EnvironmentId",value:void 0},{key:"ProductVersion",value:"0.0.20240520.2-2405.2-prod"}],callbackFunctions:{onDisconnect:w}}),[n,t,S,_,T,C,null==R?void 0:R.eligibilityEcsConfigId,P,D,w]),U=Object(i.useMemo)(()=>({ecsFlag:e,eligibility:b,accessToken:S,uiType:(null==R?void 0:R.uiType)===p.b.SDK}),[e,b,S,null==R?void 0:R.uiType]),V=Object.values(U).every(e=>e);return r.a.createElement(r.a.Fragment,null,V&&r.a.createElement(m.a,{config:N}))}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/power-portals~powerpo~09739e02.8f39d2e7.chunk.js.map