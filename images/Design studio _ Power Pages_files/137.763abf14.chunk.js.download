(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{18673:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(12065),r=n(18674),s=n(18655),a=Object(i.a)(r.a,s.b,void 0,{scope:"DocumentCardPreview"})},18674:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(11190),r=n(11035),s=n(12133),a=n(12139),c=n(12520),o=n(12061),l=n(11798),u=n(11812),d=Object(o.a)(),h=function(e){function t(t){var n=e.call(this,t)||this;return n._renderPreviewList=function(e){var t=n.props,s=t.getOverflowDocumentCountText,o=t.maxDisplayCount,l=void 0===o?3:o,u=e.length-l,d=u?s?s(u):"+"+u:null,h=e.slice(0,l).map((function(e,t){return r.createElement("li",{key:t},r.createElement(a.a,{className:n._classNames.fileListIcon,src:e.iconSrc,role:"presentation",alt:"",width:"16px",height:"16px"}),r.createElement(c.a,Object(i.a)({className:n._classNames.fileListLink,href:e.url},e.linkProps),e.name))}));return r.createElement("div",null,r.createElement("ul",{className:n._classNames.fileList},h),d&&r.createElement("span",{className:n._classNames.fileListOverflowText},d))},Object(l.a)(n),n}return Object(i.h)(t,e),t.prototype.render=function(){var e,t,n=this.props,i=n.previewImages,s=n.styles,a=n.theme,c=n.className,o=i.length>1;return this._classNames=d(s,{theme:a,className:c,isFileList:o}),i.length>1?t=this._renderPreviewList(i):1===i.length&&(t=this._renderPreviewImage(i[0]),i[0].accentColor&&(e={borderBottomColor:i[0].accentColor})),r.createElement("div",{className:this._classNames.root,style:e},t)},t.prototype._renderPreviewImage=function(e){var t=e.width,n=e.height,c=e.imageFit,o=e.previewIconProps,l=e.previewIconContainerClass;if(o)return r.createElement("div",{className:Object(u.a)(this._classNames.previewIcon,l),style:{width:t,height:n}},r.createElement(s.a,Object(i.a)({},o)));var d,h=r.createElement(a.a,{width:t,height:n,imageFit:c,src:e.previewImageSrc,role:"presentation",alt:""});return e.iconSrc&&(d=r.createElement(a.a,{className:this._classNames.icon,src:e.iconSrc,role:"presentation",alt:""})),r.createElement("div",null,h,d)},t}(r.Component)},18678:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(12065),r=n(18679),s=n(18654),a=Object(i.a)(r.a,s.b,void 0,{scope:"DocumentCardTitle"})},18679:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(11190),r=n(11035),s=n(12061),a=n(11801),c=n(11802),o=n(11798),l=n(18650),u=Object(s.a)(),d=function(e){function t(t){var n=e.call(this,t)||this;return n._titleElement=r.createRef(),n._truncateTitle=function(){n._needMeasurement&&n._async.requestAnimationFrame(n._truncateWhenInAnimation)},n._truncateWhenInAnimation=function(){var e=n.props.title,t=n._titleElement.current;if(t){var i=getComputedStyle(t);if(i.width&&i.lineHeight&&i.height){var r=t.clientWidth,s=t.scrollWidth;n._clientWidth=r;var a=Math.floor((parseInt(i.height,10)+5)/parseInt(i.lineHeight,10));t.style.whiteSpace="";var c=s/(parseInt(i.width,10)*a);if(c>1){var o=e.length/c-3;return n.setState({truncatedTitleFirstPiece:e.slice(0,o/2),truncatedTitleSecondPiece:e.slice(e.length-o/2)})}}}},n._shrinkTitle=function(){var e=n.state,t=e.truncatedTitleFirstPiece,i=e.truncatedTitleSecondPiece;if(t&&i){var r=n._titleElement.current;if(!r)return;(r.scrollHeight>r.clientHeight+5||r.scrollWidth>r.clientWidth)&&n.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:i.slice(1)})}},Object(o.a)(n),n._async=new a.a(n),n._events=new c.a(n),n._clientWidth=void 0,n.state={truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0},n}return Object(i.h)(t,e),t.prototype.componentDidUpdate=function(e){var t=this;this.props.title!==e.title&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0}),e.shouldTruncate!==this.props.shouldTruncate?this.props.shouldTruncate?(this._truncateTitle(),this._async.requestAnimationFrame(this._shrinkTitle),this._events.on(window,"resize",this._updateTruncation)):this._events.off(window,"resize",this._updateTruncation):this._needMeasurement&&this._async.requestAnimationFrame((function(){t._truncateWhenInAnimation(),t._shrinkTitle()}))},t.prototype.componentDidMount=function(){this.props.shouldTruncate&&(this._truncateTitle(),this._events.on(window,"resize",this._updateTruncation))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this,t=this.props,n=t.title,i=t.shouldTruncate,s=t.showAsSecondaryTitle,a=t.styles,c=t.theme,o=t.className,d=this.state,h=d.truncatedTitleFirstPiece,m=d.truncatedTitleSecondPiece;return this._classNames=u(a,{theme:c,className:o,showAsSecondaryTitle:s}),i&&h&&m?r.createElement(l.b.Consumer,null,(function(t){var i=t.role,s=t.tabIndex;return r.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:n,tabIndex:s,role:i},h,"â€¦",m)})):r.createElement(l.b.Consumer,null,(function(t){var i=t.role,s=t.tabIndex;return r.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:n,tabIndex:s,role:i,style:e._needMeasurement?{whiteSpace:"nowrap"}:void 0},n)}))},Object.defineProperty(t.prototype,"_needMeasurement",{get:function(){return!!this.props.shouldTruncate&&void 0===this._clientWidth},enumerable:!1,configurable:!0}),t.prototype._updateTruncation=function(){var e=this;this._timerId||(this._timerId=this._async.setTimeout((function(){delete e._timerId,e._clientWidth=void 0,e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0})}),250))},t}(r.Component)}}]);