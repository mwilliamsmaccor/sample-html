/*! For license information please see 186.13876ed0.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[186],{23429:function(e,t,r){"use strict";r.d(t,"f",(function(){return w})),r.d(t,"b",(function(){return P})),r.d(t,"c",(function(){return S})),r.d(t,"a",(function(){return D})),r.d(t,"d",(function(){return R})),r.d(t,"e",(function(){return E}));var n=r(12462),o=r(13036),a=r(11818),c=r(11205),i=r(12457),u=r(12304),s=r(11035),l=r(12729),d=r(23430),b=r(23431),p=r(16619),f=r(23432),v=r(15523),m=r(13029);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t,r,n,o,a,c){try{var i=e[a](c),u=i.value}catch(s){return void r(s)}i.done?t(u):Promise.resolve(u).then(n,o)}function O(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function c(e){j(a,n,o,c,i,"next",e)}function i(e){j(a,n,o,c,i,"throw",e)}c(void 0)}))}}function w(e){var{environment:t,webResourceId:r,telemetryScope:n,webResourceNotFoundMessage:i}=e,s=Object(o.a)({eventScope:n,scenarioName:m.g.webResourceGraphQl,eventData:void 0,team:c.j.PowerappsPortal}),l=!!r&&!!t,{data:d,isInitialLoading:b}=Object(u.a)([r,null==t?void 0:t.name],O((function*(){var e={headers:{Prefer:'odata.include-annotations= "*"',"x-ms-environment-name":null==t?void 0:t.name},team:c.j.PowerappsPortal},n=yield a.f.get("https://cds-org/api/data/v9.0/webresourceset(".concat(r,")"),e);if(null==n||!n.data)throw new Error(i);return n.data})),{enabled:l,onSuccess:()=>null==s?void 0:s.complete(),onError:e=>null==s?void 0:s.failure(e)});return{data:d,isInitialLoading:b}}function P(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=m.g.getImageWebResources,{hasDataverse:l,currentEnvironment:d}=Object(i.Q)();n=n&&l;var b=Object(s.useRef)(),[v,y]=Object(s.useState)(""),{isInitialLoading:g,data:h}=Object(u.a)(["powerapps-ui-common","GetImageWebResourcesQuery",null==d?void 0:d.name,e],O((function*(){var t,r,n="?$filter=ishidden/Value eq false and (webresourcetype eq 5 or webresourcetype eq 6 or webresourcetype eq 7 or webresourcetype eq 10 or webresourcetype eq 11)&".concat(f.b),o=yield a.f.get(e?"".concat(f.a).concat(n):"".concat(f.c).concat(n));return(null==o||null===(t=o.data)||void 0===t||null===(r=t.value)||void 0===r?void 0:r.map(e=>Object(p.a)(e)))||[]})),{enabled:n,onSuccess:e=>{var t;null===(t=b.current)||void 0===t||t.complete({webResourceLength:null==e?void 0:e.length}),y(""),b.current=void 0},onError:e=>{var t;y((null==e?void 0:e.message)||r),null===(t=b.current)||void 0===t||t.failure({error:e}),b.current=void 0}});return Object(s.useEffect)(()=>{g&&(b.current=Object(m.j)(t,o,m.d.DataExperience,m.e.DataFetchHooks,c.j.PowerappsPortal,c.f.Medium))},[g,t,o]),{loading:g,errorMessage:v,webResources:h}}function S(e){var{telemetryScope:t,defaultErrorMessage:r,webResourceByTypeOptions:o,skip:s,team:l}=e,d=Object(m.j)(t,m.g.getWebResourcesByType,m.d.AppDesigner,m.e.DataFetchHooks,l,c.f.MediumHigh),{currentEnvironmentName:b}=Object(i.R)(),f=!s&&!!b,{isInitialLoading:y,data:g,error:h}=Object(u.a)([o.getContent,o.hasActiveOnly,o.hasUnpublished,o.pageSize,o.resourceType,o.searchString,b],O((function*(){var{getContent:e,resourceType:t,searchString:i,hasActiveOnly:u,hasUnpublished:s,pageSize:l}=o,d=l,b="webresourcetype eq ".concat(t);i&&(b+=" and (contains(name, '%".concat(i,"%') or contains(displayname, '%").concat(i,"%') or contains(description, '%").concat(i,"%'))")),u&&(b+=" and ishidden/Value eq false"),0===d||d||(d=50);var f="".concat(n.nb,"/webresourceset").concat(s?"/Microsoft.Dynamics.CRM.RetrieveUnpublishedMultiple()":""),v="$select=name,webresourcetype,displayname,description".concat(e?",content":""),m="".concat(f,"?$filter=").concat(b,"&").concat(v),y={headers:{Prefer:"".concat(n.b,"=").concat(l||5e3)},team:c.j.PowerappsPortal},g=yield a.f.get("https://cds-org/".concat(m),y);if(null==g||!g.data)throw new Error(null!=r?r:"no response for web resources");return g.data.value.map(e=>Object(p.a)(e))||[]})),{enabled:f,onSuccess:()=>null==d?void 0:d.complete(),onError:e=>null==d?void 0:d.failure(e)});return{loading:y,webResources:g,errorMessage:h?Object(v.c)(h,r):""}}function D(e,t){var r=m.g.createWebResource,[n,o]=Object(s.useState)(),[a,i]=Object(s.useState)(""),{mutateAsync:u,isLoading:b,data:p}=Object(l.a)(d.a,{onSuccess:()=>{n&&n.complete(),i("")},onError:e=>{i((null==e?void 0:e.message)||t),n&&n.failure({error:e})}});return Object(s.useEffect)(()=>{b&&o(Object(m.j)(e,r,m.d.FormDesigner,m.e.DataFetchHooks,c.j.FormDesigner,c.f.Medium))},[b]),{createWebResource:u,loading:b,errorMessage:a,webResourceCreated:p}}function R(e,t){var r=m.g.updateWebResource,[n,o]=Object(s.useState)(),[a,i]=Object(s.useState)(""),{mutateAsync:u,isLoading:b,data:p}=Object(l.a)(d.b,{onSuccess:()=>{n&&n.complete(),i("")},onError:e=>{i((null==e?void 0:e.message)||t),n&&n.failure({error:e})}});return Object(s.useEffect)(()=>{b&&o(Object(m.j)(e,r,m.d.FormDesigner,m.e.DataFetchHooks,c.j.FormDesigner,c.f.Medium))},[b]),{updateWebResource:u,loading:b,errorMessage:a,webResourceUpdated:p}}function E(e){var{variables:t,telemetryScope:r}=e,n=Object(o.a)({eventScope:r,scenarioName:m.g.webResourceImages,eventData:void 0,team:c.j.AppDesigner,teamPriority:c.f.Medium}),a=!!t,i=Object(m.h)(m.d.AppDesigner,m.e.DataFetchHooks),{data:s,isInitialLoading:l}=Object(u.a)([t],O((function*(){return yield Object(b.a)(t)})),{enabled:a,onSuccess:()=>null==n?void 0:n.complete(g({},i)),onError:e=>null==n?void 0:n.failure(g(g({},e),i))});return{data:s,isInitialLoading:l}}},23430:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return d}));var n=r(15771),o=r(12462),a=r(11818),c=r(16619);function i(e,t,r,n,o,a,c){try{var i=e[a](c),u=i.value}catch(s){return void r(s)}i.done?t(u):Promise.resolve(u).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function c(e){i(a,n,o,c,u,"next",e)}function u(e){i(a,n,o,c,u,"throw",e)}c(void 0)}))}}function s(e){return l.apply(this,arguments)}function l(){return(l=u((function*(e){var t,{webResource:r,solutionUniqueName:i,isPreferredSolutionFeatureEnabled:u}=e,s="".concat(o.h).concat(o.nb,"/webresourceset"),l=yield a.f.post(s,Object(c.b)(r),{headers:Object(n.c)(null!=i?i:"",!1,u)});return Object(c.a)(null!==(t=l.data)&&void 0!==t?t:{})}))).apply(this,arguments)}function d(e){return b.apply(this,arguments)}function b(){return(b=u((function*(e){var t,{webResource:r,solutionUniqueName:i,isPreferredSolutionFeatureEnabled:u}=e,s="".concat(o.h).concat(o.nb,"/webresourceset(").concat(r.id,")"),l=yield a.f.patch(s,Object(c.c)(r),{headers:Object(n.d)(null!=i?i:"",u)});return Object(c.a)(null!==(t=l.data)&&void 0!==t?t:{})}))).apply(this,arguments)}},23431:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11818),o=r(12462),a=r(11205),c=r(13828);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t,r,n,o,a,c){try{var i=e[a](c),u=i.value}catch(s){return void r(s)}i.done?t(u):Promise.resolve(u).then(n,o)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function c(e){l(a,n,o,c,i,"next",e)}function i(e){l(a,n,o,c,i,"throw",e)}c(void 0)}))}}function b(e){return p.apply(this,arguments)}function p(){return(p=d((function*(e){var t,{searchString:r,retrieveUnpublished:i}=e,s="ishidden/Value eq false and (webresourcetype eq 5 or webresourcetype eq 6 or webresourcetype eq 7 or webresourcetype eq 10 or webresourcetype eq 11)";r&&(s+=" and (contains(name, '%".concat(r,"%') or contains(displayname, '%").concat(r,"%') or contains(description, '%").concat(r,"%'))"));var l=e.pageSize||0;0===l||l||(l=50);var d="".concat(o.h).concat(o.nb,"/webresourceset").concat(i?"/Microsoft.Dynamics.CRM.RetrieveUnpublishedMultiple()":""),b="".concat(d,"?$filter=").concat(s),p={headers:u(u({},Object(c.e)()),{},{Prefer:"".concat(o.b,"=").concat(l||5e3)}),method:"get",team:a.j.PowerappsPortal},f=yield Object(n.f)(b,p);if(Array.isArray(null==f||null===(t=f.data)||void 0===t?void 0:t.value)){var v=f.data[o.c],m=!!v;return f.data.value.map(e=>u(u({},e),{},{hasNext:m,nextLink:v,displayname:e.displayname||e.name}))}return[]}))).apply(this,arguments)}},23432:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var n=r(15529),o="".concat(n.b).concat("webresourceset"),a="".concat(n.b).concat("webresourceset","/Microsoft.Dynamics.CRM.RetrieveUnpublishedMultiple()"),c="$select=webresourceid,name,displayname,content,webresourcetype,languagecode,description,iscustomizable,ismanaged,dependencyxml,silverlightversion,isenabledformobileclient,isavailableformobileoffline"}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/186.13876ed0.chunk.js.map