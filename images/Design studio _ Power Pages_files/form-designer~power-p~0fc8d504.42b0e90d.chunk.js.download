/*! For license information please see form-designer~power-p~0fc8d504.42b0e90d.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{16616:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var o=r(11205),i=r(16484),n=r(16498),a=r(16466),s=r(16486),l=r(16491),u=r(16617),c=r(16620);function p(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){p(n,o,i,a,s,"next",e)}function s(e){p(n,o,i,a,s,"throw",e)}a(void 0)}))}}class m{constructor(e,t,r,n,l){var p=this;this.sessionInfo=t,this.formEntityMetadataService=r,this.formType=n,this.fetchAllCustomControlsPromise=void 0,this.webResourceService=void 0,this.queryClient=void 0,this.environment=void 0,this.getAllCustomControls=d((function*(){try{return yield Object(c.a)({team:o.j.FormDesigner,telemetryScope:i.a,environment:p.environment,queryClient:p.queryClient})}catch(e){return Object(o.M)(i.a,{eventName:"".concat(i.d,"/getAllCustomControls"),eventData:{message:"getAllCustomControls failed"}},e),[]}})),this.localizeCustomControls=function(){var e=d((function*(e,t){var r=e.map(e=>e.getResxPathName()),o=yield p.webResourceService.getAllResxFiles(r,t);e.forEach(e=>{var t=o.get(e.getResxPathName());try{t&&e.localizeCustomControlMetadata(JSON.parse(t))}catch(r){}})}));return function(t,r){return e.apply(this,arguments)}}(),this.isControlSupported=(e,t)=>!!(!t.hasOfType(s.c.PowerBIReport)||e.length&&e.some(e=>"powerbireport"===e.logicalName))&&(!(this.formType===a.o.QuickCreate&&(!t.isBound()||t.hasDatasetConfiguration))&&!t.getCustomControlUnsupportedInfo().reason),this.webResourceService=new u.a(e),this.environment=l,this.queryClient=e}getCustomControlMetadata(e){var t=arguments,r=this;return d((function*(){var n=t.length>1&&void 0!==t[1]&&t[1],a=(yield r.fetchAllCustomControls()).get(e);return a?n&&(yield a.localize()):Object(o.O)(i.a,{eventName:"".concat(i.d,"/getCustomControlMetadata"),eventData:{message:"custom control manifest is not available for custom ".concat(e)}}),a}))()}getAllSupportedCustomControls(e){var t=this;return d((function*(){var[r,o]=yield Promise.all([t.fetchAllCustomControls(e),t.formEntityMetadataService.getAllTables()]);return[...r.values()].filter(e=>t.isControlSupported(o,e))}))()}getAllIncompatibleControlsMetadata(e,t,r,o,i){var n=this;return d((function*(){var[a,s]=yield Promise.all([n.fetchAllCustomControls(),n.formEntityMetadataService.getAllTables()]),l=new Map,u=new Set((e||[]).map(e=>e.toLowerCase()));for(var[c,p]of a){if(!n.isControlCompatible(p,s,t,r,o,i))n.isControlEnabled(p,u,c)||l.set(c,p)}return l}))()}getAllCompatibleControlsMetadata(e,t,r,o,i,a){var s=this;return d((function*(){var[l,u]=yield Promise.all([s.fetchAllCustomControls(),s.formEntityMetadataService.getAllTables()]),c=new Map,p=[],d=new Set((t||[]).map(e=>e.toLowerCase()));for(var[m,f]of l)if(s.isControlCompatible(f,u,r,o,i,a)){var y=s.isControlEnabled(f,d,m);y&&c.set(m,f),(n.a.enablePrefetchGetMoreComponentsLocalization||y)&&p.push(f)}return yield s.localizeCustomControls(p,e),c}))()}isControlEnabled(e,t,r){return e.isWhitelisted()||t.has(r.toLowerCase())}isControlCompatible(e,t,r,o,i,n){return!(r&&!e.isControlCompatibleWithFieldType(r,o,i))&&(!(n&&!e.compatibleDataTypes.some(e=>e===s.c.Grid))&&!!this.isControlSupported(t,e))}fetchAllCustomControls(e){var t=this;return d((function*(){return!e&&t.fetchAllCustomControlsPromise||(t.fetchAllCustomControlsPromise=new Promise(function(){var e=d((function*(e){var r=new Map,n=yield t.getAllCustomControls();n?n.forEach(e=>{var o=new l.b(t.webResourceService,t.sessionInfo,e);r.set(e.name,o)}):Object(o.M)(i.a,{eventName:"".concat(i.d,"/fetchAllCustomControls")},new Error("No response result for customcontrol graphQL call")),e(r)}));return function(t){return e.apply(this,arguments)}}())),t.fetchAllCustomControlsPromise}))()}}},16617:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r(11205),i=r(16484),n=r(16618);function a(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function s(e){a(n,o,i,s,l,"next",e)}function l(e){a(n,o,i,s,l,"throw",e)}s(void 0)}))}}class l{constructor(e){this.queryClient=e,this.webResources=new Map}getResxFile(e,t){var r=this;return s((function*(){if(r.webResources.has(e))return r.webResources.get(e);var a=yield Object(n.a)(r.queryClient,t,[e],i.a,o.j.FormDesigner);return a&&a.length>0?(r.webResources.set(e,a[0].contentJson),a[0].contentJson):(r.webResources[e]=null,null)}))()}getAllResxFiles(e,t){var r=this;return s((function*(){var a=e.filter(e=>e&&!r.webResources.has(e));if(a.length){var s=yield Object(n.a)(r.queryClient,t,a,i.a,o.j.FormDesigner);null==s||s.forEach(e=>r.webResources.set(e.displayName,e.contentJson))}var l=new Map;for(var u of e){var c,p=null!==(c=r.webResources.get(u))&&void 0!==c?c:null;l.set(u,p),r.webResources.has(u)||r.webResources.set(u,null)}return l}))()}}},16618:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var o=r(11818),i=r(11205),n=r(16619),a=r(15529),s=r(13029),l=r(12411);function u(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){u(n,o,i,a,s,"next",e)}function s(e){u(n,o,i,a,s,"throw",e)}a(void 0)}))}}function p(e,t,r,o,i){return d.apply(this,arguments)}function d(){return(d=c((function*(e,t,r,o,n){var a=Object(s.j)(o,s.g.getWebResourcesByDisplayNames,s.d.Common,s.e.DataQueryFn,n,i.f.Medium,{webResourcesCount:r.length});try{var l=yield e.fetchQuery({queryKey:[t,"getWebResourcesByDisplayNames",r],queryFn:()=>m(r,n)});return a.complete(),l}catch(u){throw a.failure({error:u}),u}}))).apply(this,arguments)}function m(e,t){return f.apply(this,arguments)}function f(){return(f=c((function*(e,t){var r=Object(l.chunk)(e,100),i={method:"get",team:t},s=r.map(e=>{var t="displayname eq '".concat(e.join("' or displayname eq '"),"'"),r="".concat(a.b,"/webresourceset?$filter=").concat(t,"&$select=contentjson,webresourceid,displayname");return Object(o.f)(r,i)});return(yield Promise.all(s)).reduce((e,t)=>{var r,o;return null!==(r=t.data)&&void 0!==r&&null!==(o=r.value)&&void 0!==o&&o.length&&(e=[...e,...t.data.value.map(e=>Object(n.a)(e))]),e},[])}))).apply(this,arguments)}},16620:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r(16621),i=r(11388),n=r(13029),a=r(13039);function s(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){s(n,o,i,a,l,"next",e)}function l(e){s(n,o,i,a,l,"throw",e)}a(void 0)}))}}function u(e){return[e,"getCustomControls"]}function c(e){return p.apply(this,arguments)}function p(){return(p=l((function*(e){var t,{queryClient:r,telemetryScope:s,team:c,environment:p}=e,d=Object(n.j)(s,n.g.getCustomControls,n.d.FormDesigner,n.e.DataQueryFn,c,i.a.Medium);try{var m=yield r.fetchQuery({queryKey:u(p.id),queryFn:(t=l((function*(){var e=yield Object(a.b)(p),t=yield e.fetchList("CustomControl",void 0,{expand:{createdby:{columns:["fullname"]}}});if(!t)return null;var r=t.data,i=[];return r.map(e=>{i.push(Object(o.a)(e))}),i})),function(){return t.apply(this,arguments)})});return d.complete(),null!=m?m:null}catch(g){var f,y,h,v=null!==(f=null===(y=g.response)||void 0===y||null===(h=y.data)||void 0===h?void 0:h.error)&&void 0!==f?f:g;throw d.failure({error:v}),v}}))).apply(this,arguments)}},16621:function(e,t,r){"use strict";function o(e){return{fullName:e.fullname||null}}function i(e){return{clientJson:e.clientjson,manifest:e.manifest,compatibleDataTypes:e.compatibledatatypes,customControlId:e.customcontrolid,customControlIdUnique:e.customcontrolidunique,name:e.name,supportedPlatform:e.supportedplatform||null,solutionId:e.solutionid||null,modifiedOn:e.modifiedon,createdBy:o(e.createdby)}}r.d(t,"a",(function(){return i}))},16712:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n}));var o=new Map([["BigInt","NumberField"],["BigInteger","NumberField"],["Boolean","CheckboxComposite"],["BooleanEnumeration","BulletedList"],["Customer","Contact"],["DateTime","DateTime"],["Decimal","Subscript"],["Double","CircleHalfFull"],["EntityName","Unknown"],["Enumeration","BulletedList"],["File","TextDocument"],["Image","Photo2"],["Integer","NumberField"],["Lookup","LookupEntities"],["Memo","TextBox"],["Money","Money"],["MultilineText","TextBox"],["MultiSelectEnumeration","BulletedList"],["Number","Subscript"],["Owner","Contact"],["Picklist","Dropdown"],["State","Dropdown"],["Status","Dropdown"],["String","TextField"],["Text","TextField"],["Uniqueidentifier","GUID"],["UniqueIdentifier","TextCallout"],["Virtual","Unknown"]]),i=e=>{var t;return null!==(t=o.get(e))&&void 0!==t?t:"Unknown"},n=(e,t)=>e?"Virtual"===e?a(t):e:t?a(t):void 0,a=e=>{switch(e){case"CustomerType":return"Customer";case"LookupType":return"Lookup";case"OwnerType":return"Owner";case"FileType":return"File";case"ImageType":return"Image";default:return}}},16714:function(e,t,r){"use strict";var o=r(16673);r.d(t,"a",(function(){return o.a}));r(16674),r(16715)},16715:function(e,t,r){},16802:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var o=r(16471),i=r(16486),n=r(16491),a=r(16466),s=r(16467),l=r(16477),u=r(16803),c=r(16806),p=r(16804),d=r(16807);class m{static getNewId(){return m.autoId++}constructor(e,t,r,o,i){this.cell=e,this.t=t,this.customControlMetadata=r,this.defaultControlId=i,this.customControlId=void 0,this.customControlName=void 0,this.displayName=void 0,this.formFactor=void 0,this.id=void 0,this.isNew=!1,this._mode=void 0,this._isDefault=void 0,this._availableOn=void 0,this.controlDisplayNames=void 0,this.configurationList=[],this.controlDisplayNames=Object(s.c)(t),this.id=m.getNewId(),this.initialize(r,o,i)}isDirty(){for(var e=0;e<this.configurationList.length;e++){var t=this.configurationList[e];if(t.propertyType===n.a.property){var r=t;if(void 0!==r.getModelPropertyValue()||null!==r.getModelPropertyValue())return r.getModelPropertyValue().isDirty}else if(t.propertyType===n.a.dataset){var o=t;if(o.value)return o.value.isDirty;for(var i=0;i<o.propertySetList.length;i++){var a=o.propertySetList[i];if(void 0!==a.getModelPropertyValue()||null!==a.getModelPropertyValue())return a.getModelPropertyValue().isDirty}}else if(t.propertyType===n.a.groups){return t.isDirty}}return this.isNew}get mode(){return this._mode}get isDefault(){return this._isDefault}get availableOn(){return this._availableOn}getConfigurations(){return this.configurationList}getConfigurationByName(e){return this.configurationList.find(t=>t.name===e)}createSerializer(){var e=new p.a;this._isDefault?e.attributeDictionary[a.g.id]=this.customControlId:e.attributeDictionary[a.g.Name]=this.customControlName,void 0!==this.formFactor&&this.formFactor in l.d&&(e.attributeDictionary[a.g.formFactor]=this.formFactor),e.elementDictionary[a.g.parameters]=[];for(var t=new p.a,r=0;!o.a.IsNullOrUndefined(this.configurationList)&&r<this.configurationList.length;r++){var s=this.configurationList[r],u=s.name,c=s.createSerializer();if(s.propertyType===n.a.property)c&&(c.content||Object.keys(c.elementDictionary).length>0)&&(o.a.IsNullOrUndefined(t.elementDictionary[u])&&(t.elementDictionary[u]=[]),t.elementDictionary[u].push(c));else if(s.propertyType===n.a.dataset)c&&(o.a.IsNullOrUndefined(t.elementDictionary[i.h.dataset])&&(t.elementDictionary[i.h.dataset]=[]),t.elementDictionary[i.h.dataset].push(c));else if(s.propertyType===n.a.groups&&c){var d=c.elementDictionary;for(var m in d)m&&(t.elementDictionary[m]=[],t.elementDictionary[m].push(d[m][0]))}}return e.elementDictionary[a.g.parameters].push(t),e}getCustomControlUnsupportedInfo(){var e;return null===(e=this.customControlMetadata)||void 0===e?void 0:e.getCustomControlUnsupportedInfo()}getFormFactorFromSerializer(e){if(e&&e.attributeDictionary&&e.attributeDictionary[a.g.formFactor])switch(parseInt(e.attributeDictionary[a.g.formFactor],10)){case 0:return l.d.Mobile;case 1:return l.d.Tablet;case 2:return l.d.Web;default:return}}initialize(e,t,r){this.isNew=!t,e?this.initFromControlMetadata(e):this.initDefaultCustomControlModel(r),t&&(this.initPropertyValuesFromForm(t),this.formFactor=this.getFormFactorFromSerializer(t))}initPropertyValuesFromForm(e){var t=this;if(e&&e.elementDictionary&&e.elementDictionary[a.g.parameters]&&e.elementDictionary[a.g.parameters].length>0)for(var r=e.elementDictionary[a.g.parameters][0],o=function(e){if(t.configurationList[e].propertyType===n.a.property){if(r.elementDictionary[t.configurationList[e].name]&&r.elementDictionary[t.configurationList[e].name].length>0){var o=r.elementDictionary[t.configurationList[e].name][0];t.configurationList[e].initFromBase(o)}}else if(t.configurationList[e].propertyType===n.a.dataset){var a,s=null===(a=r.elementDictionary[i.h.dataset])||void 0===a?void 0:a.find(r=>(null==r?void 0:r.attributeDictionary.name)===t.configurationList[e].name);s&&t.configurationList[e].initFromBase(s)}else t.configurationList[e].propertyType===n.a.groups&&t.configurationList[e].initFromBase(r)},s=0;s<this.configurationList.length;s++)o(s)}isEqualTo(e){var t=!1;if(this.customControlId===e.customControlId&&this.customControlName===e.customControlName&&this.configurationList.length===e.configurationList.length){t=!0;for(var r=0;r<this.configurationList.length;r++){if(!this.configurationList[r].isEqualTo(e.configurationList[r])){t=!1;break}}}return t}clone(){return new m(this.cell,this.t,this.customControlMetadata,this.createSerializer(),this.defaultControlId)}duplicateControl(){var e=this.clone();return e.formFactor=void 0,e.isNew=!0,e}initFromControlMetadata(e){this.customControlId=e.customControlId,this.customControlName=e.name,this.displayName=e.displayName,this._mode=i.e.Both,this._isDefault=!1,this.configurationList=this.getConfigurationsFromMetadata(e),this._availableOn=e.availableOn}getConfigurationsFromMetadata(e){for(var t=[],r=e.configurationNodes,o=!0,n=0;n<r.length;n++){var a=r[n];if(a.tagName===i.h.property){var s=new u.a(e.configurations.get(r[n].getAttribute(i.h.name)),this.cell,!1,e.name);(this.cell||s.usage===i.j.Input)&&t.push(s)}else if(a.tagName===i.h.dataset){var l=new c.a(e.configurations.get(r[n].getAttribute(i.h.name)),o?this.cell:void 0,o);t.push(l),o=!1}else if(a.tagName===i.h.groups){var p=new d.a(e.configurations.get(r[n].getAttribute(i.h.name)),this.cell);t.push(p)}}return t}initDefaultCustomControlModel(e){if(this.customControlId=e?e=e.toUpperCase():"",this.customControlId&&(this.removeBracesFromId(),this.displayName=this.controlDisplayNames[this.customControlId]),this._mode=i.e.Read,this._isDefault=!0,this.cell)if(e===s.a.SubgridControl){var t,r;(null===(t=this.cell)||void 0===t||null===(r=t.control)||void 0===r?void 0:r.getAllParameters().getKeys()).forEach(e=>{var t=new u.a(void 0,this.cell);t.initDefaultProperties(this.cell.control.dataFieldName,e),this.configurationList.push(t)})}else{var o=new u.a;o.initDefaultProperties(this.cell.control.dataFieldName),this.configurationList.push(o)}this._availableOn={[l.d.Mobile]:!0,[l.d.Tablet]:!0,[l.d.Web]:!0}}removeBracesFromId(){"{"===this.customControlId.substr(0,1)&&(this.customControlId=this.customControlId.substr(1,this.customControlId.length-2))}}m.autoId=0},16803:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var o=r(12411),i=r.n(o),n=r(16470),a=r(16471),s=r(16472),l=r(16486),u=r(16491),c=r(16466),p=r(16487),d=r(16804),m=r(16805);class f extends m.a{constructor(e,t,r,o){super(e),this.propertyInfo=e,this.parentCell=t,this.values=[],this.isDatasetProperty=!1,this.controlName=void 0,this._ofTypeGroup=void 0,this._usage=void 0,this._isHidden=void 0,this._isRequired=void 0,this._isPrimaryBound=void 0,this.value=void 0,this.getModelPropertyValue=()=>this.value,this.setModelPropertyValue=e=>{if(this.value=e,this._isPrimaryBound){var t,r=e.value;if(this.onDataFieldNameChanged(r),(null===(t=this.parentCell)||void 0===t?void 0:t.control)instanceof p.a&&this.isModelFormComponentValueProperty())this.parentCell.control.defaultViewId=e.additionalAttributes[c.g.DefaultViewId]?s.a.AddBraces(e.additionalAttributes[c.g.DefaultViewId].toUpperCase()):""}},this.isFieldCompatibleWithProperty=(e,t,r)=>u.b.isFieldCompatibleWithProperty(this.propertyInfo,e,t,r),this.getOfTypes=()=>this.propertyInfo.ofType?[this.propertyInfo.ofType]:this.propertyInfo.ofTypeGroup&&this.propertyInfo.ofTypeGroup.length?this.propertyInfo.ofTypeGroup:[],this.onDataFieldNameChanged=e=>{var t;null!==(t=this.parentCell)&&void 0!==t&&t.control&&(this.parentCell.control.dataFieldName=e)},this.propertyType=u.a.property,this.controlName=o,this.isDatasetProperty=r,this.propertyInfo&&this.initFromManifest(this.propertyInfo)}get ofTypeGroup(){return this._ofTypeGroup}get usage(){return this._usage}get isHidden(){return this._isHidden}get required(){return this._isRequired}get isPrimaryBound(){return this._isPrimaryBound}createSerializer(){var e,t,r,o=new d.a;if(!s.a.IsNullOrEmpty(null===(e=this.value)||void 0===e?void 0:e.ofType)&&!this.isModelFormComponentValueProperty()){var i=this.value.ofType;this.usage===l.j.Input&&this.value.bindToValueOnField&&(a.a.IsNullOrUndefined(this.value.additionalAttributes)||s.a.IsNullOrEmpty(this.value.additionalAttributes[l.a.OfTypeKey])||(i=this.value.additionalAttributes[l.a.OfTypeKey])),o.attributeDictionary[l.h.type]=i}(this._isPrimaryBound||(null===(t=this.value)||void 0===t?void 0:t.ofType)!==l.c.Enum&&!this.isStaticNonEnum()||(o.attributeDictionary[l.h.static]="true"),this.isStaticNonEnum()&&!this.isFormattedTypeValue())?o.content=null===(r=this.value)||void 0===r?void 0:r.value:o.content=this.getFormattedTypeValue(o);return o}isModelFormComponentValueProperty(){return this.isModelFormComponent()&&this.name===l.h.value}isModelFormComponentQuickFormsProperty(){return this.isModelFormComponent()&&this.name===l.b.QuickForms}isModelFormComponent(){return this.controlName===l.d.ModelFormControl}isFormattedTypeValue(){var e;return this.isModelFormComponentValueProperty()||this.isModelFormComponentQuickFormsProperty()||(null===(e=this.value)||void 0===e?void 0:e.ofType)===l.c.CardForm}getFormattedTypeValue(e){var t=this.value;if(t){if(t.value&&t.ofType===l.c.CardForm&&t.additionalAttributes&&t.additionalAttributes[l.a.EntityNameKey])return"".concat(t.value,":Card|").concat(t.additionalAttributes[l.a.EntityNameKey],"|").concat(n.a.EmptyGuid.ToString());if(this.isModelFormComponentValueProperty()){var r=t.additionalAttributes,o=r[c.g.DefaultViewId]?s.a.AddBraces(r[c.g.DefaultViewId].toUpperCase()):"",i=r[c.g.FilterRelationshipName]||s.a.EmptyString,a=r[c.g.DependentAttributeName]||s.a.EmptyString,u=r[c.g.DependentAttributeType]||s.a.EmptyString,p=r[c.g.AvailableViewIds]||s.a.EmptyString,m=s.a.IsStrictTrue(r[c.g.AllowFilterOff])?"true":"false",f=s.a.IsStrictTrue(r[c.g.DisableQuickFind])?"true":"false",y=s.a.IsStrictTrue(r[c.g.DisableViewPicker])?"true":"false",h=new d.a;h.content=t.value;var v=new d.a;v.content=o;var g=new d.a;g.content=i;var b=new d.a;b.content=a;var C=new d.a;C.content=u;var P=new d.a;P.content=p;var w=new d.a;w.content=m;var O=new d.a;O.content=f;var D=new d.a;return D.content=y,e.elementDictionary.BindAttribute=[],e.elementDictionary.BindAttribute.push(h),e.elementDictionary.DefaultViewId=[],e.elementDictionary.DefaultViewId.push(v),e.elementDictionary.FilterRelationshipName=[],e.elementDictionary.FilterRelationshipName.push(g),e.elementDictionary.DependentAttributeName=[],e.elementDictionary.DependentAttributeName.push(b),e.elementDictionary.DependentAttributeType=[],e.elementDictionary.DependentAttributeType.push(C),e.elementDictionary.AvailableViewIds=[],e.elementDictionary.AvailableViewIds.push(P),e.elementDictionary.AllowFilterOff=[],e.elementDictionary.AllowFilterOff.push(w),e.elementDictionary.DisableQuickFind=[],e.elementDictionary.DisableQuickFind.push(O),e.elementDictionary.DisableViewPicker=[],e.elementDictionary.DisableViewPicker.push(D),""}if(this.isModelFormComponentQuickFormsProperty()){var S="",k=t.additionalAttributes;if(k&&Object.keys(k).length>0)return Object.keys(k).forEach(e=>{var t=k[e];S+='<QuickFormId entityname="'.concat(e,'">').concat(t,"</QuickFormId>")}),"<QuickForms><QuickFormIds>".concat(S,"</QuickFormIds></QuickForms>")}else{if(!s.a.IsNullOrEmpty(t.value))return t.value;if(!s.a.IsNullOrEmpty(t.displayName))return t.displayName}}return s.a.EmptyString}isEqualTo(e){if(this.name===(null==e?void 0:e.name)){var t=!1;return this.value&&(t=i.a.isEqual(this.value,e.value)),t}return!1}initDefaultProperties(e,t){if(e){var r={name:c.g.datafieldname,value:e};this.name=c.g.datafieldname,this.displayName="",this.values=[r],this.value=r}else{var o,i;this.name=t;var n={name:t,value:null===(o=this.parentCell)||void 0===o||null===(i=o.control)||void 0===i?void 0:i.getParam(t)};this.value=n}}initFromBase(e){var t,r=e.attributeDictionary[c.g.Type];if(t=!e.attributeDictionary[c.g.static]||"true"!==e.attributeDictionary[c.g.static],this.value={name:s.a.EmptyString,value:e.content,ofType:r,bindToValueOnField:t,additionalAttributes:{}},this.value.ofType===l.c.CardForm)this.initCardFormValue(e);else if(this.isModelFormComponentValueProperty()){var o=e.elementDictionary.BindAttribute,i=e.elementDictionary.DefaultViewId,n=e.elementDictionary.FilterRelationshipName,u=e.elementDictionary.DependentAttributeName,p=e.elementDictionary.DependentAttributeType,d=e.elementDictionary.AvailableViewIds,m=e.elementDictionary.AllowFilterOff,f=e.elementDictionary.DisableQuickFind,y=e.elementDictionary.DisableViewPicker;this.value.value=(null==o?void 0:o.length)>0&&o[0].content?o[0].content:"",this.value.additionalAttributes[c.g.DefaultViewId]=(null==i?void 0:i.length)>0&&i[0].content?s.a.StripBraces(i[0].content):"",this.value.additionalAttributes[c.g.DisableViewPicker]=(null==y?void 0:y.length)>0?s.a.IsStrictTrue(y[0].content).toString():"false",this.value.additionalAttributes[c.g.DisableQuickFind]=(null==f?void 0:f.length)>0?s.a.IsStrictTrue(f[0].content).toString():"false",this.value.additionalAttributes[c.g.AllowFilterOff]=(null==m?void 0:m.length)>0?s.a.IsStrictTrue(m[0].content).toString():"false",this.value.additionalAttributes[c.g.FilterRelationshipName]=(null==n?void 0:n.length)>0&&n[0].content?n[0].content:"",this.value.additionalAttributes[c.g.DependentAttributeName]=(null==u?void 0:u.length)>0&&u[0].content?u[0].content:"",this.value.additionalAttributes[c.g.DependentAttributeType]=(null==p?void 0:p.length)>0&&p[0].content?p[0].content:"",this.value.additionalAttributes[c.g.AvailableViewIds]=(null==d?void 0:d.length)>0&&d[0].content?d[0].content:""}else if(this.isModelFormComponentQuickFormsProperty()){var h;if((null===(h=e.content)||void 0===h?void 0:h.length)>0)for(var v=a.a.ParseXml(e.content).getElementsByTagName("QuickFormId"),g=0;g<v.length;g++){var b=v[g],C=b.getAttribute(l.h.entityName),P=s.a.StripBraces(b.textContent);this.value.additionalAttributes[C]=P}}}initCardFormValue(e){if(null!=e&&e.content){this.value.additionalAttributes={};var t=e.content.split("|");3===t.length&&(this.value.additionalAttributes[l.a.EntityNameKey]=t[1]),this.value.value=t[0].split(":")[0]}}initFromManifest(e){var t,r,o;this.name=e.name,this.displayNameKey=e.displayNameKey,this.displayName=e.displayName,this.descriptionKey=e.descriptionKey,this.description=e.description,this._usage=e.usage,this._isPrimaryBound=e.isPrimary,this._isHidden=e.isHidden,this._isRequired=e.isRequired;var i=e.defaultValue;this._ofTypeGroup=e.ofTypeGroup;var n=null===(t=this.parentCell)||void 0===t||null===(r=t.control)||void 0===r?void 0:r.dataFieldName,s=this._isPrimaryBound&&!a.a.IsNullOrUndefined(n)?n:a.a.IsNullOrUndefined(i)?"":i;if(this.value={name:s,value:s,ofType:this.getDefaultPropertyOfType(e)||void 0,bindToValueOnField:!1,additionalAttributes:{}},this.values=e.enumValues,(null===(o=this.parentCell)||void 0===o?void 0:o.control)instanceof p.a&&this.isModelFormComponentValueProperty()){var l=this.parentCell.control;this.value.value=n,this.value.additionalAttributes[c.g.DefaultViewId]=l.defaultViewId,this.value.additionalAttributes[c.g.FilterRelationshipName]=l.filterRelationshipName,this.value.additionalAttributes[c.g.DependentAttributeName]=l.dependentAttributeName,this.value.additionalAttributes[c.g.DependentAttributeType]=l.dependentAttributeType,this.value.additionalAttributes[c.g.AllowFilterOff]=l.allowFilterOff.toString(),this.value.additionalAttributes[c.g.DisableQuickFind]=l.disableQuickFind.toString(),this.value.additionalAttributes[c.g.DisableViewPicker]=l.disableViewPicker.toString(),this.value.additionalAttributes[c.g.AvailableViewIds]=l.availableViewIds.toString()}}getDefaultPropertyOfType(e){var t=e.ofType,r=this.ofTypeGroup;return null==t&&r&&r.length>0?r[0]:t}isStaticNonEnum(){return this.usage===l.j.Input&&this.value.ofType!==l.c.Enum&&!this.value.bindToValueOnField}}},16804:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var o=r(16471),i=r(16488),n=r(16466),a=r(16490);class s{constructor(){this._attributeDictionary=void 0,this._elementDictionary=void 0,this._content=void 0,this._attributeDictionary={},this._elementDictionary={}}get attributeDictionary(){return this._attributeDictionary}set attributeDictionary(e){this._attributeDictionary=e}get elementDictionary(){return this._elementDictionary}set elementDictionary(e){this._elementDictionary=e}get content(){return this._content}set content(e){this._content=e}output(e){return this.populateAttributesToFormXmlObj(e),this.populateChildrenInFormXmlObj(e),e}buildCustomControlBaseModel(e){this.populateAttributes(e),this.populateChildElements(e)}clone(){var e=new s;return e.attributeDictionary=Object.assign({},this.attributeDictionary),e.elementDictionary=Object.assign({},this.elementDictionary),e.content=this.content,e}buildFormXmlObjFromCustomControlModel(e,t,r){var s;return s=t===n.f.customControl?new a.a(r):new i.c(t,r),o.a.IsNullOrUndefined(e)||(this.populateAttributesToFormXmlObj(s),this.populateChildrenInFormXmlObj(s)),s}populateAttributesToFormXmlObj(e){for(var t of Object.keys(this.attributeDictionary))if(t!==n.g.id)i.c.prototype.insertProperty.call(e,t,String(this.attributeDictionary[t]));else{var r=this.getIdAsString(this.attributeDictionary[n.g.id]);r="{"+r+"}",i.c.prototype.insertProperty.call(e,t,r)}}populateChildrenInFormXmlObj(e){if(!o.a.IsNullOrUndefined(this.content)){var t=new i.c("<"+this.content,e);i.c.prototype.insertChild.call(e,t)}for(var r of Object.keys(this.elementDictionary))for(var n of this.elementDictionary[r])i.c.prototype.insertChild.call(e,n.buildFormXmlObjFromCustomControlModel(n,r,e))}getIdAsString(e){return"{"===e.substr(0,1)?e.substr(1,e.length-2):e}populateAttributes(e){for(var t of e.getAllProperties())this.attributeDictionary[t.key]=t.value}populateChildElements(e){for(var t of e.getAllChildren()){var r=t.getNodeName();if(0!==r.indexOf("<")){o.a.IsNullOrUndefined(this.elementDictionary[r])&&(this.elementDictionary[r]=[]);var i=new s;i.buildCustomControlBaseModel(t),this.elementDictionary[r].push(i)}else this.content=t.getNodeName().substr(1)}}}},16805:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));class o{constructor(e){this.configuration=e,this.name="",this.propertyType=void 0,this.displayNameKey="",this.displayName="",this.descriptionKey="",this.description="",this.configuration&&(this.name=this.configuration.name,this.displayNameKey=this.configuration.displayNameKey,this.displayName=this.configuration.displayName,this.descriptionKey=this.configuration.descriptionKey,this.description=this.configuration.description)}}},16806:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var o=r(16486),i=r(16491),n=r(16804),a=r(16803),s=r(16466),l=r(16805),u=r(16472),c=r(16485);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f extends l.a{constructor(e,t,r){super(e),this.datasetInfo=e,this.parentCell=t,this.propertySetList=void 0,this.isPrimaryDataset=!1,this.value=void 0,this.isEditable=!1,this.cdsDatasetOptions=void 0,this.initialDatasetFetch=void 0,this.allowDefaultSelectedItems=void 0,this.isResettable=void 0,this.propertyType=i.a.dataset,this.isPrimaryDataset=r,this.datasetInfo&&this.initFromManifest(this.datasetInfo)}getModelPropertyValue(){return this.value}setModelPropertyValue(e){var t;if(this.value=e,this.isPrimaryDataset&&(null===(t=this.parentCell)||void 0===t?void 0:t.control)instanceof c.a){var r=this.parentCell.control;r.targetEntityType=e.targetEntityType,r.viewId=e.viewId,r.enableViewPicker=!!e.enableViewPicker,r.isUserView=!!e.isUserView}}getPropertySetByName(e){return this.propertySetList.find(t=>t.name===e)}isEqualTo(e){var t=!1;if(this.name===(null==e?void 0:e.name)){var r=e.propertySetList,o=this.propertySetList;if((null==r?void 0:r.length)===(null==o?void 0:o.length)){t=!0;for(var i=0;i<r.length;i++){var n=r[i],a=o[i];if(!(t=null==n?void 0:n.isEqualTo(a)))return!1}}return t}return!1}createSerializer(){var e;if(null!==(e=this.value)&&void 0!==e&&e.targetEntityType){var t,r,i,a=new n.a;a.attributeDictionary[o.h.name]=this.name;var l=new n.a;if(l.content=u.a.AddBraces(this.value.viewId),a.elementDictionary.ViewId=[l],null!==(t=this.value)&&void 0!==t&&t.targetEntityType){var c=new n.a;c.content=this.value.targetEntityType,a.elementDictionary.TargetEntityType=[c];var p=new n.a;p.content="false",a.elementDictionary.IsUserView=[p]}if(this.isEditable&&null!==(r=this.value.columnsDefaultView)&&void 0!==r&&r.cells&&Object.keys(this.value.columnsDefaultView.cells).length>0){var d=this.value.columnsDefaultView.cells,m=new n.a;m.elementDictionary.cell=[];var f=Object.keys(d);for(var y of f){var h,v=new n.a;v.attributeDictionary.entityName=d[y].entityName,v.attributeDictionary.viewId=u.a.AddBraces(this.value.columnsDefaultView.cells[y].viewId),v.attributeDictionary.attributeName=d[y].attributeName;var g=new n.a;g.content=u.a.AddBraces(null===(h=d[y].children)||void 0===h?void 0:h.defaultViewId),v.elementDictionary.DefaultViewId=[g],m.elementDictionary.cell.push(v)}a.elementDictionary.columnsDefaultView=[m]}if(this.isPrimaryDataset&&null!==(i=this.parentCell)&&void 0!==i&&i.control){var b=this.parentCell.control,C=b.getParam(s.g.enableViewPicker),P=new n.a;P.content=C,a.elementDictionary.EnableViewPicker=[P];var w=b.getParam(s.g.RelationshipName),O=new n.a;O.content=w,a.elementDictionary.RelationshipName=[O];var D=b.getParam(s.g.viewIds),S=new n.a;S.content=D,a.elementDictionary.FilteredViewIds=[S]}return this.propertySetList.forEach(e=>{var t;if(null!==(t=e.getModelPropertyValue())&&void 0!==t&&t.value){var r=new n.a;r.content=e.getModelPropertyValue().value,a.elementDictionary[e.name]=[r]}}),a}}initFromBase(e){var t,r,o,i,n,a,l,c=(null===(t=e.elementDictionary.TargetEntityType)||void 0===t?void 0:t.length)>0?e.elementDictionary.TargetEntityType[0].content:"",p=(null===(r=e.elementDictionary.ViewId)||void 0===r?void 0:r.length)>0?u.a.StripBraces(e.elementDictionary.ViewId[0].content).toLowerCase():"";this.value=d(d({targetEntityType:c,viewId:p,isDirty:!1},this.isEditable?{columnsDefaultView:{cells:{}}}:{}),{},{enableViewPicker:!(null===(o=this.parentCell)||void 0===o||!o.control||"true"!==this.parentCell.control.getParam(s.g.enableViewPicker)),isUserView:!(null===(i=this.parentCell)||void 0===i||!i.control||"true"!==this.parentCell.control.getParam(s.g.isUserView)),filteredViewIds:null!==(n=this.parentCell)&&void 0!==n&&n.control?null===(a=u.a.StripBraces(this.parentCell.control.getParam(s.g.viewIds)))||void 0===a?void 0:a.toLowerCase():void 0});var m,f,y,h=e.elementDictionary.columnsDefaultView;this.isEditable&&(null==h?void 0:h.length)>0&&(null===(l=h[0].elementDictionary.cell)||void 0===l?void 0:l.length)>0&&h[0].elementDictionary.cell.forEach(e=>{var t;m=e.attributeDictionary,f=m.attributeName,y=(null===(t=e.elementDictionary.DefaultViewId)||void 0===t?void 0:t.length)>0&&e.elementDictionary.DefaultViewId[0].content,this.value.columnsDefaultView.cells[f]={entityName:m.entityName,viewId:u.a.StripBraces(m.viewId).toLowerCase(),attributeName:f,children:{defaultViewId:u.a.StripBraces(y).toLowerCase()}}});for(var v=0;v<this.propertySetList.length;v++){var g,b=e.elementDictionary[null===(g=this.propertySetList[v])||void 0===g?void 0:g.name];b&&b[0]&&this.propertySetList[v].initFromBase(b[0])}}initFromManifest(e){var t;this.name=e.name,this.displayNameKey=e.displayNameKey,this.displayName=e.displayName,this.descriptionKey=e.descriptionKey,this.description=e.description;for(var r=[],o=e.manifestPropertySetsInfo,i=0;i<o.length;i++){var n=new a.a(o[i],this.parentCell,!0);r.push(n)}if(this.propertySetList=r,this.cdsDatasetOptions=e.cdsDatasetOptions,this.isEditable=e.isEditable,this.initialDatasetFetch=e.initialDatasetFetch,this.allowDefaultSelectedItems=e.allowDefaultSelectedItems,this.isResettable=e.isResettable,this.value={targetEntityType:"",viewId:"",isUserView:!1,enableViewPicker:!1},this.isPrimaryDataset&&(null===(t=this.parentCell)||void 0===t?void 0:t.control)instanceof c.a){var s=this.parentCell.control;this.value=d({targetEntityType:s.targetEntityType,viewId:s.viewId,isUserView:s.isUserView,enableViewPicker:s.enableViewPicker},e.isEditable?{columnsDefaultView:{cells:{}}}:{})}}}},16807:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r(16486),i=r(16491),n=r(16804),a=r(16805),s=r(16808);class l extends a.a{constructor(e,t){super(e),this.groupsInfo=e,this.parentCell=t,this.isRequired=void 0,this.groupSet=[],this.value=void 0,this.isDirty=void 0,this.propertyType=i.a.groups,this.groupsInfo&&this.initFromManifest(this.groupsInfo)}getModelPropertyValue(){return this.value}setModelPropertyValue(e){this.value=e,this.isDirty=!0}initFromManifest(e){this.name=e.name,this.displayNameKey=e.displayNameKey,this.displayName=e.displayName,this.descriptionKey=e.descriptionKey,this.description=e.description,this.isRequired=e.isRequired,this.groupSet=e.groupSet.map(e=>new s.a(e,this.parentCell)),this.value=new s.a(e.groupSet?e.groupSet[0]:{name:"",propertyType:i.a.group,groupConfigurableProperties:[]}),this.isDirty=!1}createSerializer(){var e=this.value;if(e){var t=new n.a;return t.elementDictionary[this.name]=[],t.elementDictionary[this.name].push(e.createSerializer()),e.groupConfigurableProperties.forEach(e=>{if(e.propertyType===i.a.dataset){var r=e.createSerializer();r&&(t.elementDictionary[o.h.dataset]=[],t.elementDictionary[o.h.dataset].push(r))}else if(e.propertyType===i.a.property){var n=e.createSerializer();n&&(t.elementDictionary[e.name]=[],t.elementDictionary[e.name].push(n))}}),t}}isEqualTo(e){var t=e;if(this.name===t.name&&this.value&&t.value&&this.value.name===t.value.name&&this.value.groupConfigurableProperties.length===t.value.groupConfigurableProperties.length){for(var r=0;r<t.value.groupConfigurableProperties.length;r++){var o=this.value.groupConfigurableProperties[r];if(o.propertyType===i.a.property){if(!1===o.isEqualTo(t.value.groupConfigurableProperties[r]))return!1}else if(o.propertyType===i.a.dataset){if(!1===o.isEqualTo(t.value.groupConfigurableProperties[r]))return!1}}return!0}return!1}initFromBase(e){var t=e.elementDictionary[this.name],r=this.groupSet.find(e=>e.name===t[0].content);this.value=r,null==r||r.groupConfigurableProperties.forEach(t=>{if(t.propertyType===i.a.property){var r=e.elementDictionary[t.name];r&&t.initFromBase(r[0])}else if(t.propertyType===i.a.dataset){var n=e.elementDictionary[o.h.dataset];n&&t.initFromBase(n[0])}})}}},16808:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var o=r(16486),i=r(16491),n=r(16804),a=r(16805),s=r(16806),l=r(16803);class u extends a.a{constructor(e,t){super(e),this.groupInfo=e,this.parentCell=t,this.groupConfigurableProperties=[],this.propertyType=i.a.group,this.groupInfo&&this.initFromManifest(this.groupInfo)}initFromManifest(e){this.name=e.name,this.displayNameKey=e.displayNameKey;for(var t=0;t<e.groupConfigurableProperties.length;t++){var r=e.groupConfigurableProperties[t];if(r.propertyType===i.a.dataset){var o=r;this.groupConfigurableProperties.push(new s.a(o,this.parentCell))}else if(r.propertyType===i.a.property){var n=r;this.groupConfigurableProperties.push(new l.a(n,this.parentCell))}}}createSerializer(){var e=new n.a;return e.attributeDictionary[o.h.isGroup]="true",e.attributeDictionary[o.h.static]="true",e.content=this.name,e}isEqualTo(e){return null}initFromBase(e){}}},16810:function(e,t,r){"use strict";r.d(t,"b",(function(){return w})),r.d(t,"c",(function(){return S})),r.d(t,"a",(function(){return k}));var o=r(14667),i=r(16912),n=r(16814),a=r(16701),s=r(16477),l=r(11205),u=r(11035),c=r(16811),p=r(16812),d=r(16813),m=r(16830),f=r(16831),y=r(16833),h=r(17038);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function P(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){C(n,o,i,a,s,"next",e)}function s(e){C(n,o,i,a,s,"throw",e)}a(void 0)}))}}var w="CustomControlConfigurer",O="choose",D="configure";function S(e,t){switch(e){case s.d.Mobile:return t("formFactors.mobile");case s.d.Tablet:return t("formFactors.tablet");case s.d.Web:return t("formFactors.web");default:return""}}class k extends u.Component{constructor(e){var t;super(e),t=this,this.initialStepKey=void 0,this.onDismissSubscription=void 0,this.getConfirmationProps=()=>({onDismiss:()=>{this.setState({showDiscardConfirmation:!1})},visible:this.state.showDiscardConfirmation,onCancel:this.onConfirmedDiscard,onSave:this.onSubmit,canSave:this.state.isValid,strings:{confirmationCancelAction:this.props.t("controls.controlConfigurer.discard"),confirmationQuestion:this.props.t("controls.controlConfigurer.saveChanges"),confirmationSaveAction:this.props.t("controls.controlConfigurer.save"),confirmationTitle:this.props.t("controls.controlConfigurer.saveChangesTitle")}}),this.onControlSelected=function(){var e=P((function*(e,r){var o,i,n=yield null===(o=(i=t.props.addProps).getControlModel)||void 0===o?void 0:o.call(i,e.id),a=t.getAvailableFormFactors(t.state.formFactors,n);t.setState({model:n,controlId:e.id,isDirty:!0,formFactors:a},()=>r.goTo(D))}));return function(t,r){return e.apply(this,arguments)}}(),this.handleControlEdit=e=>{e?this.setState({isDirty:!0,formFactors:e}):this.setState({isDirty:!0})},this.onValidate=e=>{this.setState({isValid:e})},this.onSubmit=()=>{var e,t;this.state.isValid&&(this.props.editProps?null===(e=(t=this.props.editProps).onSubmit)||void 0===e||e.call(t,Array.from(this.state.formFactors),this.state.model):this.props.addProps.onAdd(this.state.model,Array.from(this.state.formFactors)));this.props.dismiss()},this.onConfirmedDiscard=()=>{this.props.editProps&&this.props.editProps.onDiscard(),this.props.dismiss(),this.setState({showDiscardConfirmation:!1})},this.onDiscard=()=>{var e;!this.state.isDirty||null!==(e=this.props.controlOptions)&&void 0!==e&&e.hideDiscardConfirmation?this.props.dismiss():this.setState({showDiscardConfirmation:!0})},this.getShimmerStyles=e=>({shimmerWrapper:[{margin:"10px 20px"}]}),this.state={isLoading:!0,isValid:!1,isDirty:!1,formFactors:new Set,showDiscardConfirmation:!1,canGoBack:!1}}componentDidMount(){var e=this;return P((function*(){var t,r;if(e.props.editProps){var o,i,n=yield null===(o=(i=e.props.editProps).getControlModel)||void 0===o?void 0:o.call(i),a=e.getAvailableFormFactors(e.props.editProps.formFactors,n);e.initialStepKey=D,e.setState({model:e.props.editProps.keepIntermediateChanges?n:null==n?void 0:n.clone(),isValid:!1,isDirty:!1,formFactors:a,showDiscardConfirmation:!1,isLoading:!1})}else{if(!e.props.addProps)throw Error("Either edit props or add props must be provided.");e.initialStepKey=O,e.setState({isValid:!1,isDirty:!1,formFactors:new Set([s.d.Mobile,s.d.Web,s.d.Tablet]),showDiscardConfirmation:!1,isLoading:!1}),e.props.addProps.getControlsList?(e.props.addProps.getControlsList().then(t=>e.setState({controls:t})),e.setState({isLoading:!1})):Object(l.M)(p.a,{eventName:"".concat(w,"/componentDidMount")},new Error("No initialControlId provided and cannot find a getControlsList method to get controls"))}e.onDismissSubscription=null===(t=(r=e.props).onDismiss)||void 0===t?void 0:t.call(r,e.onDiscard)}))()}componentWillUnmount(){var e;null===(e=this.onDismissSubscription)||void 0===e||e.dispose()}render(){var e,t,r=this,{getDocumentType:s,getControlExclusionByDataTypeList:v,getBaseTelemetryDetails:b,getUsedComponents:C,getMetadataService:S,cacheKey:k,customControlDiscoveryService:T}=this.props;if(this.state.isLoading)return u.createElement(u.Fragment,null,u.createElement(n.a,{width:"87%",styles:this.getShimmerStyles}),u.createElement(n.a,{width:"87%",styles:this.getShimmerStyles}),u.createElement(n.a,{width:"87%",styles:this.getShimmerStyles}),u.createElement(n.a,{width:"87%",styles:this.getShimmerStyles}),u.createElement(n.a,{width:"87%",styles:this.getShimmerStyles}));var E=g(g({},Object(c.b)(this.state.canGoBack)),null===(e=this.props.controlOptions)||void 0===e||null===(t=e.customStyles)||void 0===t?void 0:t.controllerCustomStyle),F=function(){var e=P((function*(e){var t;if(null===(t=r.props.addProps)||void 0===t||t.onReopenCallout(),null!=e&&e.length){var o,i,n=e.map(e=>e.name);Object(m.a)(k,n);var a=e.map(e=>Object(f.c)(e,r.props.t));r.setState({controls:[...r.state.controls,...a]}),null===(o=(i=r.props).onPanelClose)||void 0===o||o.call(i,e),Object(l.O)(p.a,{eventName:"".concat(w,"/AddCustomControls"),eventData:{controls:e.map(e=>e.name)}})}}));return function(t){return e.apply(this,arguments)}}();return u.createElement(u.Fragment,null,u.createElement(a.a,this.getConfirmationProps()),u.createElement(o.a,{initialActiveViewKey:this.initialStepKey,showBackButton:!0,styles:E,backButtonAriaLabel:this.props.t("controls.backButtonAriaLabel")},e=>{var t,r,n,a,l,c,p=e.canGoBack();return this.state.canGoBack!==p&&this.setState({canGoBack:p}),[u.createElement(o.b,{key:O,viewKey:O,headerText:this.props.t("controls.addComponent")},u.createElement(i.a,{horizontal:!1,verticalAlign:"space-between",grow:1,style:{overflow:"hidden"}},u.createElement(i.a.Item,{grow:1},u.createElement(d.a,{controls:this.state.controls,onControlSelected:t=>{this.onControlSelected(t,e)}})),u.createElement(y.a,{getDocumentType:s,getControlExclusionByDataTypeList:v,getBaseTelemetryDetails:b,onPanelClose:F,getUsedComponents:C,customControlDiscoveryService:T}))),u.createElement(o.b,{key:D,viewKey:D,headerText:!(null!==(t=this.props.controlOptions)&&void 0!==t&&t.hideHeader)&&this.getComponentStepHeader(this.state.model),footerButtons:null!==(r=this.props.controlOptions)&&void 0!==r&&r.hideFooter?void 0:[{primary:!0,onClick:()=>{this.onSubmit()},text:this.props.t("controls.controlConfigurer.done"),disabled:!this.state.isValid},{primary:!1,onClick:()=>{this.onDiscard()},text:this.props.t("controls.controlConfigurer.cancel"),styles:null===(n=this.props.controlOptions)||void 0===n||null===(a=n.customStyles)||void 0===a?void 0:a.footerButtonsCustomStyle}]},u.createElement(h.a,{primaryBoundPropertyLocked:this.props.primaryBoundPropertyLocked,model:this.state.model,onEdit:this.handleControlEdit,formFactors:!(null!==(l=this.props.controlOptions)&&void 0!==l&&l.hideFormFactors)&&this.state.formFactors,classicDesignerLink:this.props.classicDesignerLink,t:this.props.t,getFields:this.props.getFields,getMetadataService:S,onValidate:this.onValidate,initialFormFactors:this.props.editProps?new Set(this.props.editProps.formFactors):void 0,isInsertion:null===(c=this.props.editProps)||void 0===c?void 0:c.isInsertion,sourceLocation:this.props.sourceLocation,controlOptions:this.props.controlOptions}))]}))}getComponentStepHeader(e){var t,r,o=this.props.addProps||null!==(t=this.props.editProps)&&void 0!==t&&t.isInsertion?this.props.t("controls.add"):this.props.t("controls.edit");if(e&&(e.displayName||null!==(r=e.customControlMetadata)&&void 0!==r&&r.customDisplayNameKey)){var i,n=null!==(i=e.customControlMetadata)&&void 0!==i&&i.customDisplayNameKey?this.props.t(e.customControlMetadata.customDisplayNameKey):e.displayName;return e.isDefault?this.props.t("controls.headerWithDefault",{actionType:o,controlName:n,isDefault:this.props.t("controls.default")}):this.props.t("controls.headerWithoutDefault",{actionType:o,controlName:n})}return this.props.t("controls.headerWithoutDefault",{actionType:o,controlName:this.props.t("controls.unknown")})}getAvailableFormFactors(e,t){var r=new Set;if(e)for(var o of e)t.availableOn[o]&&r.add(o);return r}}k.defaultProps={controlOptions:{hideHeader:!1,hideFormFactors:!1,hideFooter:!1,hideDiscardConfirmation:!1}}},16811:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var o=r(12092),i=Object(o.db)({calloutMessage:{fontSize:"14px",lineHeight:"20px",margin:"9px 0px 20px"},controlEditorRoot:{wordBreak:"break-word"},controlPropertyEditorRoot:{paddingBottom:13}}),n=e=>({root:{maxHeight:"96vh"},bodyContainer:{padding:"8px 24px",margin:0,fontSize:"16px",lineHeight:"20px"},headerContainer:e?{display:"flex",whiteSpace:"normal",overflow:"visible",paddingLeft:16,paddingBottom:8}:{whiteSpace:"normal",overflow:"visible",paddingBottom:8},headerText:{height:"max-content"}})},16812:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));var o="cds-control-customization",i="https://go.microsoft.com/fwlink/?linkid=2243732",n="https://go.microsoft.com/fwlink/?linkid=2197948",a="https://go.microsoft.com/fwlink/?linkid=2195544"},16813:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var o=r(16743),i=r(11066),n=r(11203),a=r(16814),s=r(11035),l=r.n(s);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends l.a.Component{constructor(){super(...arguments),this.getShimmerStyles=e=>({shimmerWrapper:[{margin:"10px 20px"}]})}render(){var e=l.a.createElement(l.a.Fragment,null,l.a.createElement(a.a,{width:"87%",styles:this.getShimmerStyles}),l.a.createElement(a.a,{width:"87%",styles:this.getShimmerStyles}),l.a.createElement(a.a,{width:"87%",styles:this.getShimmerStyles}),l.a.createElement(a.a,{width:"87%",styles:this.getShimmerStyles}),l.a.createElement(a.a,{width:"87%",styles:this.getShimmerStyles}));return this.props.controls?l.a.createElement(o.a,{components:this.props.controls.map(e=>c(c({},e),{},{onSelect:()=>{this.props.onControlSelected(e)}})),listContainerStyles:{height:"300px",overflowY:"auto"},strings:{noComponentsToDisplay:this.props.t("componentPicker.noComponentsToDisplay"),searchBoxPlaceholder:this.props.t("componentPicker.searchBoxPlaceholder"),searchBoxClearButtonTitle:this.props.t("componentPicker.searchBoxClearButtonTitle"),listAriaLabel:this.props.t("componentPicker.listAriaLabel"),moreCommandsAriaLabel:this.props.t("componentPicker.moreCommandsAriaLabel"),searchResultString:this.props.t("componentPicker.searchResultString")},allowDrag:!1}):e}}var m=Object(i.a)(d,[Object(n.r)("FormDesigner")])},16830:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return c}));var o=r(11206),i=r(16812),n=r(16831);function a(e){var t=new Set;try{window.localStorage&&(window.localStorage.getItem(e)||"").split(",").forEach(e=>{e&&t.add(e)})}catch(r){Object(o.v)(i.a,{eventName:"".concat("CustomControlCacheHelper","/getAllAddedCustomControlsFromLocalStorage"),eventData:{message:"Failed to get added custom controls from the localStorage cache."}},r)}return t}function s(e,t){try{if(window.localStorage&&null!=t&&t.length){var r=[...a(e)];t.forEach(e=>r.push(e)),window.localStorage.setItem(e,[...new Set(r)].join(","))}}catch(n){Object(o.v)(i.a,{eventName:"".concat("CustomControlCacheHelper","/addCustomControlsToLocalStorage"),eventData:{message:"Failed to add custom controls to localStorage cache."}},n)}}function l(e,t){s(e,[...Object(n.a)(t)])}function u(e,t){try{if(window.localStorage){var r=[...a(e)];r=r.filter(e=>e.toLowerCase()!==t.toLowerCase()),window.localStorage.setItem(e,r.join(","))}}catch(n){Object(o.v)(i.a,{eventName:"".concat("CustomControlCacheHelper","/removeCustomControlFromLocalStorage"),eventData:{message:"Failed to remove custom controls from local storage."}},n)}}function c(e,t){var r=a(e),o=Object(n.a)(t);for(var i of o)r.delete(i);return r}},16831:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c}));var o=r(16832),i=r(16466),n=r(16486),a=r(16491),s=r(16788);function l(e){var t=new Set;if(null!=e&&e.length)for(var r of e)for(var o of r.customControls){var n,a=null===(n=o.getAllProperties().find(e=>e.key===i.g.Name))||void 0===n?void 0:n.value;a&&t.add(a)}return t}function u(e,t){var r=e.imagePath,o=m(t),i=Object(a.d)(t),n=[{url:r},{label:t("controls.componentInfo.modes"),description:[o[e.mode]]},{label:t("controls.componentInfo.description"),description:[e.description]}],s=e.compatibleDataTypes.map(e=>i[e]).reduce((e,t,r)=>e+(0===r?"":", ")+t,"");return s.length&&n.push({label:s.length>1?t("controls.componentInfo.datatypes"):t("controls.componentInfo.datatype"),description:[s]}),n}function c(e,t){var r=u(e,t);return{id:e.name,label:e.customDisplayNameKey?t(e.customDisplayNameKey):e.displayName,iconName:d(e),categories:e.category||[i.b.more],info:{content:r,directionalHint:o.a.rightCenter,tooltipStyles:{root:{width:232}},rootStyles:{width:"100%"}}}}function p(e){switch(e){case n.c.SingleLineText:return s.b.get(s.a.SingleLineText).icon;case n.c.SingleLineURL:return s.b.get(s.a.Url).icon;case n.c.SingleLineTextArea:return s.b.get(s.a.TextArea).icon;case n.c.Enum:case n.c.TwoOptions:case n.c.Boolean:return s.b.get(s.a.YesOrNo).icon;case n.c.MultiSelectOptionSet:return s.b.get(s.a.Choice).icon;case n.c.WholeNone:return s.b.get(s.a.WholeNumber).icon;case n.c.Decimal:return s.b.get(s.a.Decimal).icon;case n.c.FP:return s.b.get(s.a.Float).icon;case n.c.Currency:return s.b.get(s.a.Currency).icon;case n.c.DateAndTimeDateAndTime:return s.b.get(s.a.DateAndTime).icon;case n.c.DateAndTimeDateOnly:return s.b.get(s.a.DateOnly).icon;case n.c.LookupSimple:return s.b.get(s.a.Lookup).icon;case n.c.LookupCustomer:case n.c.LookupOwner:return s.b.get(s.a.Customer).icon;case n.c.PowerBIReport:return"BarChart4";default:return"generic-component-svg"}}function d(e){if(e.icon)return e.icon;var t=e.compatibleDataTypes;return 0===t.length?p():t.find(e=>e===n.c.WholeNone)?p(n.c.WholeNone):t.find(e=>e===n.c.SingleLineText)?p(n.c.SingleLineText):p(t[0])}var m=e=>({[n.e.Read]:e("controls.componentInfo.componentModes.read"),[n.e.Edit]:e("controls.componentInfo.componentModes.edit"),[n.e.Both]:e("controls.componentInfo.componentModes.both"),[n.e.Container]:e("controls.componentInfo.componentModes.container"),[n.e.Unknown]:e("controls.componentInfo.componentModes.unknown")})},16833:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var o=r(11205),i=r(11035),n=r.n(i),a=r(16917),s=r(11203),l=r(16466),u=r(12092),c=r(16834),p=r(16982),d=r(16812),m=Object(u.Y)(),f=e=>{var{t:t}=Object(s.s)("FormDesigner"),{getControlExclusionByDataTypeList:r,getDocumentType:u,getUsedComponents:f,getBaseTelemetryDetails:y,onPanelClose:h,customControlDiscoveryService:v}=e,[g,b]=Object(i.useState)(!1),C=Object(i.useCallback)(()=>{b(!0),Object(o.X)(d.a,"".concat("GetMoreComponentsButton","/openPanel"),y())},[]);return u()!==l.o.QuickViewForm&&n.a.createElement(n.a.Fragment,null,n.a.createElement(a.a,{id:p.a,onClick:C,iconProps:{iconName:"FolderSearch"},text:t("componentPicker.getMoreComponents"),ariaLabel:t("componentPicker.getMoreComponents"),styles:{root:{borderTop:"1px solid",paddingLeft:16,borderTopColor:m.palette.neutralQuaternaryAlt}}}),g&&n.a.createElement(c.a,{getControlExclusionByDataTypeList:r,onPanelClose:e=>{h(e),b(!1),Object(o.X)(d.a,"".concat("GetMoreComponentsButton","/closePanel"),y())},getUsedComponents:f,customControlDiscoveryService:v}),n.a.createElement(p.b,null))}},16834:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r(11035),i=r(16835),n=r(16836),a=e=>{var{onPanelClose:t,getControlExclusionByDataTypeList:r,getUsedComponents:a,customControlDiscoveryService:s}=e,[l,u]=Object(o.useState)([]),c=Object(o.useCallback)(()=>a(),[]),{loading:p,data:d}=Object(i.a)(c,[]),m=Object(o.useCallback)(()=>r(),[]),{loading:f,data:y}=Object(i.a)(m,[]);return Object(o.useEffect)(()=>{var e=new Set;p||d.map(t=>{e.add(t)}),f||y.map(t=>{e.add(t)}),u([...e])},[p,f,d,y]),Object(o.useMemo)(()=>o.createElement(n.a,{controlsToExclude:l,customControlDiscoveryService:s,onPanelClose:t}),[l])}},16835:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return h}));var o=r(11035),i=r(13035),n=r(16498),a=r(16812),s=r(12457);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){p(n,o,i,a,s,"next",e)}function s(e){p(n,o,i,a,s,"throw",e)}a(void 0)}))}}var m=new Set(["MicrosoftCorporation","microsoftdynamics","msproj","microsoftfirstparty","dynamics365customerengagement","CoreHR","microsoftdynamics365mixedrealityworkplace","microsoftdynamics365electronicmedicalrecords","microsoftformspro","DynamicsMKT"]);function f(e,t,r){var[l,u]=Object(o.useState)(!1),[c,p]=Object(o.useState)(0),f=Object(o.useCallback)(()=>{l||(u(!0),p(c+1))},[l,c]),{status:v,data:g,error:b}=function(e,t,r){return h(Object(o.useCallback)(d((function*(){var o=new Set([...t.map(e=>e.toLowerCase())]);return(yield e.getAllSupportedCustomControls(!!r)).filter(e=>!o.has(e.name.toLowerCase()))})),[e,t,r]),[])}(t,r,c),{status:C,error:P}=function(e,t,r){var{currentEnvironmentName:i}=Object(s.R)();return h(Object(o.useCallback)(d((function*(){if(null!=e&&e.length){var r=e.map(e=>e.getResxPathName()),o=yield t.getAllResxFiles(r,i);e.forEach(e=>{var t=o.get(e.getResxPathName());t&&e.localizeCustomControlMetadata(JSON.parse(t))})}return!0})),[i,e,t]),!1,!r)}(g,t.webResourceService,v!==y.SUCCESS||n.a.enablePrefetchGetMoreComponentsLocalization&&0===c),{loading:w,solutions:O,errorMessage:D}=Object(i.g)(e,[...new Set((g||[]).filter(e=>{var t,r;return"SYSTEM"!==(null===(t=e.createdBy)||void 0===t||null===(r=t.fullName)||void 0===r?void 0:r.toUpperCase())}).map(e=>e.solutionId))],a.a,v!==y.SUCCESS),S=Object(o.useMemo)(()=>Math.max(v,C,w?y.LOADING:D?y.ERROR:y.SUCCESS),[v,C,w]),k=Object(o.useMemo)(()=>{if(S===y.SUCCESS){var e=(O||[]).reduce((e,t)=>(t.publisher&&(e[t.id]=t.publisher),e),{});return(g||[]).map(t=>{var r,o=e[t.solutionId],i=(null==o?void 0:o.uniqueName)||"",n=(null==o?void 0:o.friendlyName)||"",a="SYSTEM"===(null===(r=t.createdBy)||void 0===r?void 0:r.fullName)||m.has(i);return{controlMetadata:t,publisher:n,owner:a?"Microsoft":n,isFirstPartyControl:a}})}return[]},[S,g,O]);return Object(o.useEffect)(()=>{S!==y.SUCCESS&&S!==y.ERROR||u(!1)},[S]),{loading:S===y.LOADING||l,status:S,customControlData:k,error:b||P||D,onRefetch:f}}var y=function(e){return e[e.IDLE=1]="IDLE",e[e.SUCCESS=2]="SUCCESS",e[e.LOADING=3]="LOADING",e[e.ERROR=4]="ERROR",e}({});function h(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[i,n]=Object(o.useReducer)((e,t)=>u(u({},e),t),{data:t,status:y.IDLE}),a=Object(o.useCallback)(d((function*(){n({status:y.LOADING});try{var t=yield e();n({status:y.SUCCESS,data:t})}catch(r){n({status:y.ERROR,error:r})}})),[e]);return Object(o.useEffect)(()=>{r&&a()},[r,a]),u(u({},i),{},{execute:a,loading:i.status===y.LOADING})}},16836:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var o=r(11035),i=r.n(o),n=r(16835),a=r(13281),s=r(16970),l=r(16972),u=r(16912),c=r(16978),p=r(16979),d=r(16837),m=r(11204),f=r(12092),y=r(12456),h=r(16969);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e){var{controlsToExclude:t,onPanelClose:r,customControlDiscoveryService:v}=e,{t:b}=Object(m.f)("FormDesigner"),{environmentClient:C}=Object(y.d)(),{loading:P,customControlData:w,onRefetch:O}=Object(n.b)(C,v,t),[D,S]=Object(o.useState)(0),k=Object(o.useRef)(new a.a({onSelectionChanged:()=>S(k.getSelectedCount())})).current,T=Object(o.useCallback)(()=>{var e,t=k.getSelection();null!=t&&t.length&&(e=t.map(e=>e.controlMetadata)),r(e)},[r,w]),E=Object(o.useCallback)(()=>r(),[r]);return i.a.createElement(s.a,{isOpen:!0,type:l.a.largeFixed,headerText:b("componentPicker.getMoreComponents"),styles:g({commands:{backgroundColor:Object(f.Y)().palette.white}},h.a),closeButtonAriaLabel:b("dialogCloseButton"),isFooterAtBottom:!0,onRenderFooterContent:()=>i.a.createElement(u.a,{horizontal:!0,tokens:{childrenGap:5}},i.a.createElement(c.a,{disabled:!D,onClick:T,ariaLabel:b("componentPicker.getMore.add")},b("componentPicker.getMore.add")),i.a.createElement(p.a,{ariaLabel:b("dialogCancelButton"),onClick:E},b("dialogCancelButton"))),onDismiss:E},i.a.createElement(d.a,{data:w,selection:k,loading:P,onRefetch:O}))}},16837:function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return g}));var o=r(11035),i=r.n(o),n=r(11204),a=r(16912),s=r(16917),l=r(16962),u=r(16964),c=r(16893),p=r(16956),d=r(12092),m=r(16838),f=r(11205),y=r(16812),h=function(e){return e.ALL="All",e.MICROSOFT="Microsoft",e.OTHERS="Others",e}({}),v=Object(d.db)({labels:{paddingTop:10}});function g(e){var[t,r]=Object(o.useState)(""),[d,g]=Object(o.useState)(h.ALL),{t:b}=Object(n.f)("FormDesigner"),C=Object(o.useCallback)((e,t)=>r(t),[]),P=Object(o.useCallback)(()=>{Object(f.X)(y.a,"CustomControlPicker/Refresh"),e.onRefetch()},[e.onRefetch]);return i.a.createElement(a.a,null,i.a.createElement(a.a,{horizontal:!0,horizontalAlign:"space-between"},i.a.createElement(s.a,{iconProps:{iconName:"refresh"},text:b("componentPicker.getMore.refresh"),ariaLabel:b("componentPicker.getMore.refresh"),onClick:P}),i.a.createElement(p.a,{placeholder:b("componentPicker.searchBoxPlaceholder"),ariaLabel:b("componentPicker.searchBoxPlaceholder"),onChange:C})),i.a.createElement(l.a,{onLinkClick:e=>g(e.props.itemKey)},i.a.createElement(u.a,{headerText:b("componentPicker.getMore.all"),itemKey:h.ALL,ariaLabel:b("componentPicker.getMore.all")},i.a.createElement("div",{className:v.labels},b("componentPicker.getMore.allTabInfo"),i.a.createElement(c.a,{href:y.b,target:"_blank","aria-label":b("learnMoreLink")},b("learnMoreLink")))),i.a.createElement(u.a,{headerText:b("componentPicker.getMore.builtByMicrosoft"),itemKey:h.MICROSOFT,ariaLabel:b("componentPicker.getMore.builtByMicrosoft")},i.a.createElement("div",{className:v.labels},b("componentPicker.getMore.builtByMicrosoftInfo"))),i.a.createElement(u.a,{headerText:b("componentPicker.getMore.builtByOthers"),itemKey:h.OTHERS,ariaLabel:b("componentPicker.getMore.builtByOthers")},i.a.createElement("div",{className:v.labels},b("componentPicker.getMore.buildByOthersInfo")," ",i.a.createElement(c.a,{href:y.c,target:"_blank","aria-label":b("componentPicker.getMore.findMoreComponents")},b("componentPicker.getMore.findMoreComponents"))))),i.a.createElement(m.a,{data:e.data,loading:e.loading,selection:e.selection,searchText:t,selectedPivot:d}))}},16838:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var o=r(11035),i=r.n(o),n=r(13282),a=r(16837),s=r(13265),l=r(16842),u=r(11204),c=r(16747),p=r(16832),d=r(16839),m=r(16831),f=r(11203),y=function(e){return e.Component="component",e.Owner="owner",e.ModifiedOn="modifiedOn",e}(y||{});function h(e){var{data:t,loading:r,selection:f,searchText:h,selectedPivot:C}=e,{t:P}=Object(u.f)("FormDesigner"),w=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],[r,i]=Object(o.useState)(e),[n,a]=Object(o.useState)(t),s=Object(o.useCallback)((e,t)=>{var o=t.key;o===r?a(!n):i(o)},[n,r]);return{sortColumnKey:r,isSortAsc:n,onColumnClick:s}}(y.ModifiedOn,!1),O=Object(o.useMemo)(()=>function(e,t){return[{key:y.Component,name:e("componentPicker.getMore.component"),minWidth:300,isResizable:!0,onRender:t=>i.a.createElement(c.a,{content:Object(m.b)(t.controlMetadata,e),directionalHint:p.a.leftCenter,rootStyles:{width:"100%"},tooltipStyles:{root:{width:260}}},t.controlMetadata.displayName),isSorted:t.sortColumnKey===y.Component,isSortedDescending:!t.isSortAsc,onColumnClick:t.onColumnClick},{key:y.Owner,name:e("componentPicker.getMore.owner"),fieldName:"owner",minWidth:200,isResizable:!0,isSorted:t.sortColumnKey===y.Owner,isSortedDescending:!t.isSortAsc,onColumnClick:t.onColumnClick},{key:y.ModifiedOn,name:e("componentPicker.getMore.modified"),minWidth:200,isResizable:!0,onRender:e=>{var t;return null===(t=e.controlMetadata.modifiedOn)||void 0===t?void 0:t.toLocaleDateString()},isSorted:t.sortColumnKey===y.ModifiedOn,isSortedDescending:!t.isSortAsc,onColumnClick:t.onColumnClick}]}(P,w),[P,w]),D=Object(o.useMemo)(()=>[...t].sort(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];switch(e){case y.Component:return v(t);case y.Owner:return g(t);case y.ModifiedOn:default:return b(t)}}(w.sortColumnKey,w.isSortAsc)),[t,w.sortColumnKey,w.isSortAsc]),S=Object(o.useMemo)(()=>{var e=[...D];switch(C){case a.b.MICROSOFT:e=e.filter(e=>e.isFirstPartyControl);break;case a.b.OTHERS:e=e.filter(e=>!e.isFirstPartyControl);break;case a.b.ALL:}if(h){var t=h.toLowerCase();e=e.filter(e=>{var r,o;return(null===(r=e.controlMetadata.displayName)||void 0===r?void 0:r.toLowerCase().indexOf(t))>-1||(null===(o=e.controlMetadata.name)||void 0===o?void 0:o.toLowerCase().indexOf(t))>-1})}return e},[D,h,C]);return i.a.createElement(i.a.Fragment,null,!r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,{message:P("componentPicker.getMore.displayResults",{count:S.length})}),i.a.createElement(d.a,{message:P("componentPicker.getMore.selectionMessage",{count:f.getSelectedCount()})})),r||null!=S&&S.length?i.a.createElement(l.a,{columns:O,items:S,enableShimmer:r,selectionMode:n.d.multiple,getKey:e=>{var t;return null==e||null===(t=e.controlMetadata)||void 0===t?void 0:t.customControlId},selection:f,ariaLabelForGrid:P("componentPicker.getMore.ariaLabelForGrid"),ariaLabelForShimmer:P("componentPicker.getMore.ariaLabelForShimmer"),ariaLabelForSelectionColumn:P("componentPicker.getMore.ariaLabelForSelectionColumn"),ariaLabelForSelectAllCheckbox:P("componentPicker.getMore.ariaLabelForSelectAllCheckbox"),checkButtonAriaLabel:P(" componentPicker.getMore.checkButtonAriaLabel")}):i.a.createElement(s.a,{icon:"WebComponents",primaryMessage:P(h?"componentPicker.getMore.noMatchFound":"componentPicker.getMore.noComponents"),secondaryMessage:P("componentPicker.noComponentsToDisplay"),styles:{root:{paddingTop:50}}}))}function v(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(t,r)=>{var o,i=null===(o=t.controlMetadata.displayName)||void 0===o?void 0:o.localeCompare(r.controlMetadata.displayName,Object(f.g)());return e?i:-i}}function g(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(t,r)=>{var o,i=null===(o=t.owner)||void 0===o?void 0:o.localeCompare(r.owner,Object(f.g)());return e?i:-i}}function b(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(t,r)=>{var o=t.controlMetadata.modifiedOn>r.controlMetadata.modifiedOn?1:-1;return e?o:-o}}},16982:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return p}));var o=r(11035),i=r.n(o),n=r(16983),a=r(16832),s=r(16988),l=r(17036),u=r(11204),c="getMoreComponents";function p(){var e=Object(o.useRef)(Object(l.a)(s.a)).current,{t:t}=Object(u.f)("FormDesigner");return i.a.createElement(n.a,{tourKey:"getMoreComponentsTour",steps:[{type:"balloon",targetElement:"#".concat(c," .ms-Button-textContainer"),headline:t("tours.getMoreComponents.headline"),content:t("tours.getMoreComponents.content"),directionalHint:a.a.rightCenter}],strings:{subComponentStrings:{balloonStep:{footerText:void 0,nextStepButtonText:t("tours.getMoreComponents.doneButtonLabel")}}},balloonStepAs:e})}},17036:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var o=r(11035),i=r(17037),n=["stepInfo","disableHtmlInMarkdown"];function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){if(null==e)return{};var r,o,i=function(e,t){if(null==e)return{};var r,o,i={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function p(e){return t=>{var{stepInfo:r,disableHtmlInMarkdown:s}=t,u=c(t,n);return o.createElement(e,a({},u,{stepInfo:l(l({},r),{},{content:"string"==typeof r.content?o.createElement(i.a,{options:{disableParsingRawHTML:s,overrides:u.slots}},r.content):r.content})}))}}},17038:function(e,t,r){"use strict";r.d(t,"a",(function(){return D}));var o=r(16472),i=r(16664),n=r(16477),a=r(16893),s=r(11035),l=r(17039),u=r(17048),c=r(17050),p=r(16491),d=r(16486),m=r(11206),f=r(16466),y=r(16810),h=r(16812),v=r(16811);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function w(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function O(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){w(n,o,i,a,s,"next",e)}function s(e){w(n,o,i,a,s,"throw",e)}a(void 0)}))}}class D extends s.Component{constructor(){var e;super(...arguments),e=this,this.initEditorPropertyFromModel=(e,t,r,o)=>{var i;return{inputType:"custom",key:e.name,value:e.getModelPropertyValue(),validate:(i=O((function*(t){return e.required&&!t.value?"required":""})),function(e){return i.apply(this,arguments)}),onChanged:t=>{e.setModelPropertyValue(t)},onRender:i=>s.createElement("div",{className:v.a.controlPropertyEditorRoot},s.createElement(l.a,P({},i,{propertyModel:e,t:this.props.t,metadataService:t,boundObjects:r,getTypes:e.getOfTypes,primaryBoundPropertyLocked:this.props.primaryBoundPropertyLocked,parentDatasetModel:o,isPrimaryDatasetConfigurationSkipped:!1})))}},this.handlePropertyValueUpdate=O((function*(){e.props.onEdit(),e.props.onValidate(yield e.isValid())})),this.handleFormFactorUpdate=function(){var t=O((function*(t,r){var o=new Set(e.props.formFactors);r?o.add(t):o.delete(t),e.props.onEdit(o)}));return function(e,r){return t.apply(this,arguments)}}(),this.setDefaultValue=(e,t)=>{var r=e.groupSet.find(e=>e.displayNameKey===t);return e.setModelPropertyValue(r),t}}componentDidMount(){var e=this;return O((function*(){var t;e.props.onValidate(yield e.isValid()),e.canControlBeEdited()||null!==(t=e.props.model)&&void 0!==t&&t.isDefault||Object(m.y)(h.a,{eventName:"".concat(y.b,"/ControlEditors/ControlEditor/UnsupportedControl"),eventData:{message:"Custom control (".concat(e.props.model.customControlName,") is not supported"),unsupportedReason:p.c[e.props.model.getCustomControlUnsupportedInfo().reason],unsupportedReasonContext:e.props.model.getCustomControlUnsupportedInfo().context}})}))()}render(){return s.createElement("div",{className:v.a.controlEditorRoot},this.renderUnsupportedOrDefaultControlMessage(),s.createElement(i.b,this.getPropertySheetProps()))}isValid(){var e=this;return O((function*(){return""===(yield Object(i.d)(e.getPropertySheetProps(),e.props.t("errors.errorMessages.requiredPropertyError")))}))()}renderUnsupportedOrDefaultControlMessage(){if(this.props.model){var e=this.props.model.getConfigurations();if(this.props.model.isDefault||0===e.length)return s.createElement("div",{className:v.a.calloutMessage},this.props.t("controls.controlConfigurer.noPropertiesToConfigure"));if(!this.canControlBeEdited()){if(this.props.classicDesignerLink){var t=this.props.t("controls.controlConfigurer.onlyInClassic").split("<<<"),r=t[1].split(">>>");return s.createElement("div",{className:v.a.calloutMessage},t[0],s.createElement(a.a,{href:this.props.classicDesignerLink,target:"_blank"},r[0]),r[1])}var o=this.props.t("controls.controlConfigurer.notYetSupported");return s.createElement("div",{className:v.a.calloutMessage},o)}}return s.createElement(s.Fragment,null)}canControlBeEdited(){var e,t;if(null!==(e=this.props.model)&&void 0!==e&&e.isDefault)return!1;var r=null===(t=this.props.model.getCustomControlUnsupportedInfo())||void 0===t?void 0:t.reason;return!r||r===p.c.HiddenControl}getPropertySheetProps(){var e=[];return this.canControlBeEdited()&&e.push({key:"controlEditorProperties",properties:()=>this.propertiesProvider()}),this.props.formFactors&&e.push({key:"formfactor",properties:[this.getFormFactorProperty(n.d.Web),this.getFormFactorProperty(n.d.Mobile),this.getFormFactorProperty(n.d.Tablet)],label:this.props.t("controls.controlConfigurer.showControlOn"),showAsAccordion:!1}),{sections:e,allowInvalidOnChange:!0}}initFormComponentPropertyFromModel(e,t,r){var o,i,n=this,a=this.props.getFields(e.isPrimaryBound).filter(t=>e.isFieldCompatibleWithProperty(t.dataType,t.dataTypeFormat)&&t.isValidForForm);return{inputType:"custom",key:"FormComponentProperty",value:[e.getModelPropertyValue(),t.getModelPropertyValue()],onChanged:(i=O((function*(o){var i,[n,s]=o,l=n.value,u=null===(i=a.find(e=>e.name===l))||void 0===i?void 0:i.targets[0],c=yield r.getDefaultLookupViewForEntity(u),p=n;p.additionalAttributes[f.g.DefaultViewId]=c.id,e.setModelPropertyValue(p),t.setModelPropertyValue(s)})),function(e){return i.apply(this,arguments)}),validate:(o=O((function*(e){var t,[r,o]=e,i=r.value,s=null===(t=a.find(e=>e.name===i))||void 0===t?void 0:t.targets[0],l=o.additionalAttributes;return i&&s&&0!==Object.keys(l).length?"":n.props.t("errors.errorMessages.requiredPropertyError")})),function(e){return o.apply(this,arguments)}),onRender:o=>s.createElement("div",{className:v.a.controlPropertyEditorRoot},s.createElement(c.a,P({},o,{lookupModelValue:e.getModelPropertyValue(),quickFormsModelValue:t.getModelPropertyValue(),fields:a,metadataService:r,isInsertion:this.props.isInsertion})))}}propertiesProvider(){var e=this;return O((function*(){var t,r=[],o=e.props.model.getConfigurations(),i=e.props.getMetadataService(),n=!(null===(t=e.props.controlOptions)||void 0===t||!t.isPrimaryDatasetConfigurationSkipped);if(o.length)for(var a=0;a<o.length;a++){var s=o[a];if(s.propertyType===p.a.property){var l=s;if(l.isHidden&&!l.required)continue;var u=void 0,c=o[a+1];l.controlName===d.d.ModelFormControl&&l.name===d.h.value&&(null==c?void 0:c.name)===d.b.QuickForms?(u=e.initFormComponentPropertyFromModel(l,c,i),a+=1):u=yield e.getPropertyConfigurationRender(l,i),u&&r.push(u)}else if(s.propertyType===p.a.dataset){var m=s;r.push(e.getDatasetConfigurationRender(m,i,a,n))}else s.propertyType===p.a.groups&&r.push(...yield e.getGroupsConfigurationRender(s,i))}return r.map(t=>{return b(b({},t),{},{onChanged:(r=O((function*(r){yield t.onChanged(r),yield e.handlePropertyValueUpdate()})),function(e){return r.apply(this,arguments)})});var r})}))()}getPropertyConfigurationRender(e,t){var r=this;return O((function*(){var o,i,n,a=null===(o=(i=r.props).getFields)||void 0===o?void 0:o.call(i,e.isPrimaryBound);if(e.getOfTypes().some(e=>p.b.isColumnBoundDataType(e))&&a)n=r.getFilteredColumns(e,a).map(e=>({name:e.name,displayName:e.displayName,dataType:e.isPrimaryId?d.c.SingleLineText:p.b.mapFieldTypeToControlDataType(e.dataType,e.dataTypeFormat)[0]}));else if(e.getOfTypes().some(e=>e===d.c.CardForm)){var s,l=(null===(s=e.getModelPropertyValue())||void 0===s?void 0:s.additionalAttributes)&&e.getModelPropertyValue().additionalAttributes[d.a.EntityNameKey]||"";n=l?(yield t.getCardFormsForEntity(l)).map(e=>({name:e.id,displayName:e.name,dataType:d.c.CardForm})):[]}return r.initEditorPropertyFromModel(e,t,n)}))()}getDatasetConfigurationRender(e,t,r){var i,n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=this.props.model.getConfigurations();return{inputType:"custom",key:e.name,value:e.getModelPropertyValue(),required:!0,validate:(n=O((function*(t){if(!a||!e.isPrimaryDataset){if(""===t.targetEntityType||""===t.viewId)return"required";for(var r=e.propertySetList,o=0;o<r.length;o++){var i=r[o];if(i.required&&""===i.getModelPropertyValue().value)return"required"}}return""})),function(e){return n.apply(this,arguments)}),onChanged:(i=O((function*(r){var i=b({},r),n=r.targetEntityType;if(!i.viewId){var a=yield t.getDefaultPublicViewForEntity(n);a&&a.id&&(i.viewId=o.a.StripBraces(a.id.toUpperCase()))}e.setModelPropertyValue(i)})),function(e){return i.apply(this,arguments)}),onRender:o=>s.createElement("div",{className:v.a.controlPropertyEditorRoot},s.createElement(u.a,P({},o,{datasetModel:e,metadataService:t,t:this.props.t,isInsertion:this.props.isInsertion,sourceLocation:this.props.sourceLocation,configurablePropertyList:l,primaryBoundPropertyLocked:this.props.primaryBoundPropertyLocked,getFilteredColumns:this.getFilteredColumns,handlePropertyValueUpdate:this.handlePropertyValueUpdate,currentConfigurablePropertyListItemIndex:r,isPrimaryDatasetConfigurationSkipped:a})))}}getGroupsConfigurationRender(e,t){var r=this;return O((function*(){var o,i=[],n=e,a=r.getSourceOptionsFromModel(n),s=n.value?n.value.displayNameKey:r.setDefaultValue(n,a[0].key),l={inputType:"dropdown",key:"source-dropdown",options:a,label:n.displayName,required:n.isRequired,value:s,validate:(o=O((function*(e){return""===e?r.props.t("errors.errorMessages.requiredPropertyError"):""})),function(e){return o.apply(this,arguments)}),onChanged:e=>{var t=n.groupSet.find(t=>t.displayNameKey===e);n.setModelPropertyValue(t)}};i.push(l);var u=n.getModelPropertyValue().groupConfigurableProperties;if(u)for(var c=0;c<u.length;c++){var d=u[c];if(d.propertyType===p.a.dataset){var m=yield r.getDatasetConfigurationRender(d,t,c);m&&i.push(m)}else if(d.propertyType===p.a.property){var f=d,y=yield r.getPropertyConfigurationRender(f,t);y&&i.push(y)}}return i}))()}getSourceOptionsFromModel(e){return e.groupSet.map(e=>({key:e.displayNameKey,text:e.displayName}))}getFilteredColumns(e,t){var r=e.getOfTypes();return t.filter(t=>e.isFieldCompatibleWithProperty(t.dataType,t.dataTypeFormat,t.formatName)&&t.isValidForForm||t.isPrimaryId&&r.includes(d.c.SingleLineText))}isFormFactorDisabled(e){var t=Object(y.c)(e,this.props.t);if(this.props.model.isDefault){if(this.props.initialFormFactors&&this.props.initialFormFactors.has(e))return this.props.t("controls.controlConfigurer.disabledFormFactorInfo.Default")}else if(!this.props.model.availableOn[e])return this.props.t("controls.controlConfigurer.disabledFormFactorInfo.".concat(t));return""}getFormFactorProperty(e){var t=Object(y.c)(e,this.props.t),r=this.isFormFactorDisabled(e),o=""!==r;return{key:t,inputType:"checkbox",value:this.props.formFactors.has(e),label:t,disabled:o,onChanged:t=>this.handleFormFactorUpdate(e,t),info:o?{tooltipId:t,content:[r],infoIconAriaLabel:r}:void 0}}}},17039:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var o=r(16664),i=r(16486),n=r(16491),a=r(11035),s=r(17040),l=r(17041);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){d(n,o,i,a,s,"next",e)}function s(e){d(n,o,i,a,s,"throw",e)}a(void 0)}))}}class f extends a.Component{constructor(e){super(e),this.dataTypeDisplayName=void 0,this.dataTypeDisplayName=Object(n.d)(e.t)}render(){return a.createElement(o.b,this.getPropertySheetProps())}getPropertySheetProps(){var{name:e,displayName:t,description:r}=this.props.propertyModel;return{sections:[{key:e,label:t,properties:()=>this.getProperties(),showAsAccordion:!1,info:r?{tooltipId:e,content:[r],infoIconAriaLabel:t}:void 0}],allowInvalidOnChange:!0}}getProperties(){var e=this;return m((function*(){var t,r,o,{propertyModel:a,value:s}=e.props,l=[],u=!(null===(t=e.props.boundObjects)||void 0===t||!t.length),p=a.usage,d=s.value,m=s.ofType;switch(p){case i.j.Bound:l.push(e.getBoundUsageProperty());break;case i.j.Input:var f=s.additionalAttributes?s.additionalAttributes[i.a.EntityNameKey]:"",y=!!f;if(m===i.c.LookupSimple||m===i.c.LookupCustomer||m===i.c.LookupOwner||m===i.c.LookupPartyList||m===i.c.LookupRegarding){l.push(e.getBoundUsageProperty());break}n.b.isColumnBoundDataType(m)&&u?l.push({key:"bindToField-".concat(a.name),label:e.props.t("controls.controlConfigurer.bindToField"),inputType:"checkbox",value:e.props.value.bindToValueOnField,onChanged:t=>{e.onBindChanged(t)}}):e.isTableBoundDataType(m)&&(r=e.props.t("controls.controlConfigurer.objectPicker.headers.".concat(m)),o=e.props.t("controls.controlConfigurer.objectPicker.emptyStateObjectTypes.".concat(m)),l.push(yield e.getTablePicker(f))),s.bindToValueOnField||e.isTableBoundDataType(m)?l.push(c(c({},e.getObjectPicker(d,r,o,y)),{},{required:a.required})):l.push({key:"type"+a.name,label:e.props.t("controls.controlConfigurer.type"),inputType:"dropdown",disabled:1===e.props.getTypes().length,visible:!s.bindToValueOnField&&e.props.getTypes().length>1,value:m,options:e.props.getTypes().map(t=>({key:t,text:e.dataTypeDisplayName[t]})),onChanged:t=>e.onTypeChanged(t)},c(c({},e.getStaticPropertyOfType(a,m,d)),{},{required:a.required}));break;case i.j.Output:}return l}))()}isTableBoundDataType(e){return!n.b.isColumnBoundDataType(e)&&e!==i.c.Enum&&e!==i.c.PowerBIReport}getStaticPropertyOfType(e,t,r){switch(t){case i.c.SingleLineText:case i.c.SingleLineTextArea:case i.c.Multiple:case i.c.SingleLineURL:case i.c.SingleLineEmail:case i.c.SingleLinePhone:case i.c.SingleLineTickerSymbol:return this.getStaticTextProperty(e,t,r);case i.c.WholeNone:case i.c.WholeDuration:case i.c.Decimal:case i.c.FP:case i.c.Currency:return this.getStaticNumberProperty(t,r);case i.c.Enum:return this.getEnumProperty(e,r);case i.c.Boolean:case i.c.TwoOptions:return this.getStaticBooleanProperty(r);case i.c.PowerBIReport:return this.getPowerBIReportProperty(r);default:return this.getStaticReadonlyProperty(r)}}getBoundUsageProperty(){var e,{propertyModel:t,primaryBoundPropertyLocked:r,value:o,boundObjects:i}=this.props,n=o.value;if(t.isPrimaryBound&&r){var a=i.find(e=>e.name===n);e={key:"primaryBoundFieldProperty",inputType:"readonly",label:this.props.t("controls.controlConfigurer.fieldPicker"),value:a?a.displayName:n}}else e=this.getObjectPicker(n);return e.required=t.required,e}getPowerBIReportProperty(e){return{key:"pbireportpicker",inputType:"custom",onRender:()=>a.createElement(l.a,{onReportChange:e=>this.onValueChanged({value:e}),currentReport:e})}}getStaticTextProperty(e,t,r){var o,n=this,a=t===i.c.SingleLineTextArea||t===i.c.Multiple;return{label:this.props.t("controls.controlConfigurer.staticProperty"),inputType:"text",value:r||"",key:"staticValueProperty",multiline:a,onChanged:e=>{this.onValueChanged({value:e})},textFieldProps:{validateOnLoad:!1},validate:(o=m((function*(r){var o=r.length,a=t===i.c.SingleLineTextArea?2e3:t===i.c.Multiple?1048576:100;return o>a?n.props.t("pcfProperties.validationMessages.maxLength").replace("<<<propertyName>>>",e.displayName?e.displayName.toLowerCase():e.displayNameKey).replace("<<<maxValue>>>",a.toString()):""})),function(e){return o.apply(this,arguments)})}}getStaticNumberProperty(e,t){var r,o,n,a=0;switch(e){case i.c.WholeNone:a=0,r=-2147483648,o=2147483647;break;case i.c.Decimal:a=7,r=-922337203685477,o=922337203685477;break;case i.c.FP:a=5,r=-1e11,o=1e11;break;case i.c.Currency:a=4,r=-1e11,o=1e11;break;case i.c.WholeDuration:a=0,r=0,o=2147483647;break;default:throw Error("Unsupported type")}return{label:this.props.t("controls.controlConfigurer.staticProperty"),inputType:"text",value:t,key:"staticValueProperty",onChanged:e=>{var r=t,o=Number(e);""===e||isNaN(o)||(r=o.toFixed(a)),this.onValueChanged({value:r})},validate:(n=m((function*(e){var t=Number(e);return""===e||isNaN(t)||t<r||t>o?"Enter a value from ".concat(r.toFixed(a)," through ").concat(o.toFixed(a)):""})),function(e){return n.apply(this,arguments)}),textFieldProps:{validateOnLoad:!1}}}getStaticReadonlyProperty(e){return{key:"staticValueProperty",inputType:"readonly",label:this.props.t("controls.controlConfigurer.staticProperty"),value:e}}getStaticBooleanProperty(e){return{key:"staticValueProperty",inputType:"dropdown",label:this.props.t("controls.controlConfigurer.staticProperty"),value:e,options:[{key:"true",text:this.props.t("controls.componentConfigurer.booleanOptions.true")},{key:"false",text:this.props.t("controls.componentConfigurer.booleanOptions.false")}],onChanged:e=>{this.onValueChanged({value:e})}}}getObjectPicker(e,t,r,o){return{key:"".concat(this.props.propertyModel.name,"-selectedField"),inputType:"dropdown",label:t||this.props.t("controls.controlConfigurer.fieldPicker"),emptyStateText:r?this.props.t("controls.controlConfigurer.objectPicker.objectPickerEmptyState",{objectType:r}):this.props.t("controls.controlConfigurer.fieldPickerEmptyState"),disabled:this.isTableBoundDataType(this.props.value.ofType)?!o:!this.doesParentDatasetAllowPropertyConfiguration(),value:e,options:this.props.boundObjects.map(e=>({key:e.name,text:"".concat(e.displayName," (").concat(this.dataTypeDisplayName[e.dataType],")")})),onChanged:e=>this.onFieldChanged(e),allowEmptySelection:!0}}getTablePicker(e){var t=this;return m((function*(){var r=yield t.props.metadataService.getAllValidTables(),o=Object(s.a)(r);return{key:"".concat(t.props.propertyModel.name,"-selectedTable"),inputType:"dropdown",label:t.props.t("controls.controlConfigurer.tablePicker"),value:e,options:o,onChanged:e=>t.onTableChanged(e),allowEmptySelection:!0}}))()}onTableChanged(e){var t={name:"",value:""};e&&(t={name:"",value:"",additionalAttributes:{[i.a.EntityNameKey]:e}});this.onValueChanged(t)}getEnumProperty(e,t){return{key:"selectedEnumValue",inputType:"dropdown",label:"Value",value:t,options:e.values.map(e=>({key:e.value,text:"".concat(e.displayName||e.name||e.value)})),onChanged:e=>{this.onValueChanged({value:e})},allowEmptySelection:!1}}onFieldChanged(e){var t={name:"",value:""};e&&(t=c(c({},t),{},{value:e}),this.props.propertyModel.isPrimaryBound||(t.ofType=this.getBoundObject(e).dataType)),this.onValueChanged(t)}onBindChanged(e){if(e){var t=this.props.boundObjects.length?this.props.boundObjects[0]:void 0;this.onValueChanged({bindToValueOnField:e,value:t?t.name:"",ofType:t?t.dataType:this.props.value.ofType})}else this.onValueChanged({bindToValueOnField:e,value:""})}onTypeChanged(e){this.onValueChanged({ofType:e,value:""})}getBoundObject(e){if(this.props.boundObjects)return this.props.boundObjects.find(t=>t.name===e)}onValueChanged(e){this.props.onChanged(c(c({},this.props.value),e))}doesParentDatasetAllowPropertyConfiguration(){var{propertyModel:e,parentDatasetModel:t,isPrimaryDatasetConfigurationSkipped:r}=this.props;if(e.isDatasetProperty&&t){var o=t.getModelPropertyValue(),i=t.isPrimaryDataset;return!(i&&!r||!i)||!!o.targetEntityType&&!!o.viewId}return!0}}},17040:function(e,t,r){"use strict";function o(e){if(null==e||!e.length)return[];var t=e.reduce((e,t)=>(e[t.displayCollectionName]=(e[t.displayCollectionName]||0)+1,e),{});return e.map(e=>({key:e.logicalName,text:t[e.displayCollectionName]>1?"".concat(e.displayCollectionName," (").concat(e.logicalName,")"):"".concat(e.displayCollectionName),disabled:!i(e)}))}function i(e){return e.isVisibleInMobileClient||e.canModifyMobileClientVisibility}r.d(t,"a",(function(){return o}))},17041:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var o=r(11035),i=r.n(o),n=r(17042),a=r(12457),s=r(13190),l=r(16886),u=r(16888),c=r(17044),p=r(17046),d=r(11204),m=r(16667),f=r(12092),y=r(16812),h=Object(f.Y)(),v=Object(f.db)({root:{maxWidth:300}},{dropdownItem:{height:"auto"}},{dropdownOptionText:{overflow:"visible",whiteSpace:"normal"}},{emptyState:{textAlign:"center",margin:"20px 16px",padding:"0px 8px"},emptyStateText:{fontSize:f.k.size14,lineHeight:16,color:h.palette.neutralTertiary}});function g(e){var{onReportChange:t,currentReport:r}=e,{t:f}=Object(d.f)("FormDesigner"),{solutionComponents:h,loading:g,errorMessage:b}=Object(n.a)({solutionId:a.c,componentLogicalNames:[s.a.PowerBIReport.logicalName],telemetryScope:y.a}),C=Object(o.useMemo)(()=>null!=h&&h.length?h.map(e=>({key:e.uniqueName,text:e.displayName})):[],[h]);Object(o.useEffect)(()=>{null!=h&&h.length&&!r&&t(h[0].uniqueName)},[h]);var P=Object(o.useCallback)((e,r)=>{t(r.key)},[]);return g?i.a.createElement(l.a,{size:u.a.medium}):b?i.a.createElement(c.a,{messageBarType:p.a.error,isMultiline:!0},b):i.a.createElement(m.a,{id:"pbireport",key:"pbireport",label:f("controls.controlConfigurer.pbiReportPicker"),emptyStateText:f("controls.controlConfigurer.pbiReportEmptyState"),options:C,onChange:P,selectedKey:r,styles:v})}},17048:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var o=r(16677),i=r(16664),n=r(16486),a=r(16491),s=r(11035),l=r(17040),u=r(17039),c=r(17049);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function d(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){d(n,o,i,a,s,"next",e)}function s(e){d(n,o,i,a,s,"throw",e)}a(void 0)}))}}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){if(null==e)return{};var r,o,i=function(e,t){if(null==e)return{};var r,o,i={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}class b extends s.Component{constructor(e){var t;super(e),t=this,this.getLookupEditProperty=(e,t,r)=>{var i=[],n=0;return Object.values(e).forEach(e=>{var a,l,u=0===n?this.props.t("controls.controlConfigurer.lookupConfigurer.editLookupButtonLabel"):"",p=this.props.value,d=null===(a=p.columnsDefaultView)||void 0===a?void 0:a.cells[e.attributeName],m=null===(l=t.find(e=>e.key===d.attributeName))||void 0===l?void 0:l.text,f={inputType:"pill",key:"editLookupPill-".concat(e.attributeName),primaryText:m,onRenderEditContent:(e,i,n,a,l)=>s.createElement(o.b.Consumer,null,o=>{var u;return s.createElement(c.a,{editColumn:d,addedCells:null===(u=p.columnsDefaultView)||void 0===u?void 0:u.cells,availableColumns:t,targetTableViews:r,onSubmit:t=>{var r=d,o=p.columnsDefaultView.cells,i=r.attributeName,{[i]:n}=o,a=v(o,[i].map(g)),s=y({entityName:p.targetEntityType,viewId:p.viewId},t),l=y(y({},p),{},{columnsDefaultView:{cells:y(y({},a),{},{[t.attributeName]:s})}});this.onValueChanged(l),e()},dismiss:()=>{e(!0)},confirmationOpen:i,setConfirmationOpen:n,isDirty:a,setIsDirty:l})}),label:u,onDelete:()=>{var e=p.columnsDefaultView.cells,t=d.attributeName,{[t]:r}=e,o=v(e,[t].map(g)),i=y(y({},p),{},{columnsDefaultView:{cells:o}});this.onValueChanged(i)},propertyContainerStyles:{paddingBottom:8},sourceLocation:this.props.sourceLocation};i.push(f),n+=1}),i},this.onLookupValueAdded=e=>{var t,r=null===(t=this.props.value.columnsDefaultView)||void 0===t?void 0:t.cells,o=e.attributeName,i=y({entityName:this.props.value.targetEntityType,viewId:this.props.value.viewId},e),n=y(y({},this.props.value),{},{columnsDefaultView:{cells:y(y({},r),{},{[o]:i})}});this.onValueChanged(n)},this.getNestedDatasetProperties=function(){var e=m((function*(e){var r,o=[];if(null!=e&&null!==(r=e.propertySetList)&&void 0!==r&&r.length)for(var i=0;i<e.propertySetList.length;i++){var s=e.propertySetList[i];if(!s.isHidden||s.required){var l=e.value.targetEntityType,u=t.props.getFilteredColumns(s,yield t.props.metadataService.getAllEntityAttributes(l)).map(e=>({name:e.name,displayName:e.displayName,dataType:e.isPrimaryId?n.c.SingleLineText:a.b.mapFieldTypeToControlDataType(e.dataType,e.dataTypeFormat)[0]}));o.push(t.getPropertyForNestedDatasetProperties(s,t.props.configurablePropertyList.length-1===t.props.currentConfigurablePropertyListItemIndex+i+1,u,e))}}return o}));return function(t){return e.apply(this,arguments)}}(),this.getPropertyForNestedDatasetProperties=(e,r,o,i)=>{var n,a;return{inputType:"custom",key:e.name,value:e.getModelPropertyValue(),validate:(a=m((function*(t){return e.required&&!t.value?"required":""})),function(e){return a.apply(this,arguments)}),onChanged:(n=m((function*(r){e.setModelPropertyValue(r),yield t.props.handlePropertyValueUpdate()})),function(e){return n.apply(this,arguments)}),onRender:t=>s.createElement("div",{style:{paddingBottom:r?0:"13px"}},s.createElement(u.a,p({},t,{propertyModel:e,t:this.props.t,metadataService:this.props.metadataService,boundObjects:o,getTypes:e.getOfTypes,primaryBoundPropertyLocked:this.props.primaryBoundPropertyLocked,parentDatasetModel:i,isPrimaryDatasetConfigurationSkipped:this.props.isPrimaryDatasetConfigurationSkipped})))}}}render(){return s.createElement(i.b,this.getPropertySheetProps())}getPropertySheetProps(){var e=[];return this.isSkippedPrimaryDataset()&&this.props.datasetModel.isEditable||e.push({key:this.props.datasetModel.name,label:this.props.datasetModel.displayName,properties:()=>this.getProperties(),info:{tooltipId:this.props.datasetModel.name,content:[this.props.datasetModel.description],infoIconAriaLabel:this.props.datasetModel.displayName},showAsAccordion:!0}),{sections:e,allowInvalidOnChange:!0}}getProperties(){var e=this;return m((function*(){var t,r,o,{datasetModel:i,isInsertion:n,metadataService:a}=e.props,{value:s,isPrimaryDataset:u}=i,c=a.getAllValidTables(),p=[],d=[],m=[];if(!e.isSkippedPrimaryDataset()){if(r=s.targetEntityType,u&&n&&(p=yield c),r){var f=a.getAllPublicViewsByTable(r);[p,d]=yield Promise.all([c,f])}else p.length||(p=yield c);if(u&&!s.viewId)o=d.length>0?d[0]:void 0;else{var y=d.find(e=>{var t;return e.id===(null===(t=s.viewId)||void 0===t?void 0:t.toLowerCase())});o=y||void 0}var h=o?o.id:"",v=[],g={};e.props.datasetModel.isEditable&&(v=yield a.getLookupColumnsOnView(r,o),g=yield a.getTargetViewsMapForLookups(v));var b=Object(l.a)(p),C=d.map(e=>({key:e.id,text:e.name})),P=v.map(e=>({key:e.name,text:e.displayName}));if(m.push(e.getTablePicker(r,b)),m.push(e.getViewPicker(r,h,C)),e.props.datasetModel.isEditable){var w,O=null===(w=s.columnsDefaultView)||void 0===w?void 0:w.cells;O&&m.push(...e.getLookupEditProperty(O,P,g)),m.push(e.getLookupAdditionProperty(P,g))}}return(null===(t=i.propertySetList)||void 0===t?void 0:t.length)>0&&m.push(...yield e.getNestedDatasetProperties(i)),m}))()}isSkippedPrimaryDataset(){return this.props.datasetModel.isPrimaryDataset&&this.props.isPrimaryDatasetConfigurationSkipped}getTablePicker(e,t){var r=this.props.datasetModel.isPrimaryDataset,o=this.props.isPrimaryDatasetConfigurationSkipped;return{key:"selectedTable",inputType:"dropdown",disabled:!this.props.isInsertion&&r,label:this.props.t("controls.controlConfigurer.tablePicker"),value:e,options:t,onChanged:e=>this.onTableChanged(e,t),required:o?!r:r,allowEmptySelection:!0}}onTableChanged(e,t){var r=this;return m((function*(){var o={targetEntityType:"",viewId:"",isUserView:!1,enableViewPicker:!1};if(e){var i=t.find(t=>t.key===e).key,n=yield r.props.metadataService.getAllPublicViewsByTable(i),a=n.length>0?n[0]:void 0;o=y(y({targetEntityType:i,viewId:a?a.id:"",isUserView:r.props.value.isUserView,enableViewPicker:r.props.value.enableViewPicker},r.props.datasetModel.isEditable?{columnsDefaultView:{cells:{}}}:{}),{},{isDirty:!0})}r.onValueChanged(o)}))()}getViewPicker(e,t,r){var o=this.props.datasetModel.isPrimaryDataset,i=!!e;return{key:"selectedView",inputType:"dropdown",disabled:!this.props.isInsertion&&o&&i||!o&&!i,label:this.props.t("controls.controlConfigurer.viewPicker"),value:t,options:r,onChanged:e=>this.onViewChanged(e,r),required:o,emptyStateText:this.props.t("controls.controlConfigurer.viewPickerEmptyState"),allowEmptySelection:!0}}onViewChanged(e,t){var r=this;return m((function*(){var o={targetEntityType:"",viewId:"",isUserView:!1,enableViewPicker:!1};if(e){var i=t.find(t=>t.key===e).key;o=y(y({targetEntityType:r.props.value.targetEntityType,viewId:i,isUserView:r.props.value.isUserView,enableViewPicker:r.props.value.enableViewPicker},r.props.datasetModel.isEditable?{columnsDefaultView:{cells:{}}}:{}),{},{isDirty:!0})}r.onValueChanged(o)}))()}onValueChanged(e){var t=this;return m((function*(){yield t.props.onChanged(y(y({},t.props.value),e))}))()}getLookupAdditionProperty(e,t){var{value:r}=this.props;return{inputType:"action",key:"addLookupButton",label:this.props.t("controls.controlConfigurer.lookupConfigurer.addLookupButtonText"),onRenderEditContent:(i,n,a,l,u)=>s.createElement(o.b.Consumer,null,o=>{var p;return s.createElement(c.a,{addedCells:null===(p=r.columnsDefaultView)||void 0===p?void 0:p.cells,availableColumns:e,targetTableViews:t,onSubmit:this.onLookupValueAdded,dismiss:()=>{i(!0)},confirmationOpen:n,setConfirmationOpen:a,isDirty:l,setIsDirty:u})}),propertyContainerStyles:{paddingBottom:16},sourceLocation:this.props.sourceLocation}}}},17049:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r(14667),i=r(16701),n=r(16664),a=r(11066),s=r(11203),l=r(11035);class u extends l.PureComponent{constructor(e){super(e),this.getConfirmationProps=()=>({onDismiss:()=>{this.props.setConfirmationOpen(!1)},visible:this.props.confirmationOpen,onCancel:()=>{this.props.dismiss(!0),this.props.setConfirmationOpen(!1)},onSave:()=>this.onSubmit(),canSave:this.props.isDirty&&this.state.isValid,saveButtonProps:{disabled:!this.props.isDirty||!this.state.isValid},strings:{confirmationCancelAction:this.props.t("controls.controlConfigurer.discard"),confirmationQuestion:this.props.t("controls.controlConfigurer.saveChanges"),confirmationSaveAction:this.props.t("controls.controlConfigurer.save"),confirmationTitle:this.props.t("controls.controlConfigurer.saveChangesTitle")}}),this.state={isValid:!1,selectedLookupColumn:"",selectedDefaultView:""}}calculateVisibleColumnOptions(){return this.props.editColumn?this.props.availableColumns.filter(e=>!this.props.addedCells[e.key]||e.key===this.props.editColumn.attributeName):this.props.availableColumns.filter(e=>!this.props.addedCells[e.key])}componentDidMount(){var e;this.props.editColumn&&this.setState({selectedLookupColumn:this.props.editColumn.attributeName,selectedDefaultView:null===(e=this.props.editColumn.children)||void 0===e?void 0:e.defaultViewId})}render(){var e=this.getPropertySheet(),t=[{primary:!0,text:this.props.t("controls.controlConfigurer.lookupConfigurer.done.text"),ariaLabel:this.props.t("controls.controlConfigurer.lookupConfigurer.done.ariaLabel"),onClick:()=>this.onSubmit(),disabled:!this.state.isValid},{text:this.props.t("controls.controlConfigurer.lookupConfigurer.cancel.text"),ariaLabel:this.props.t("controls.controlConfigurer.lookupConfigurer.cancel.ariaLabel"),onClick:()=>{this.props.isDirty?this.props.setConfirmationOpen(!0):this.props.dismiss()}}];return l.createElement(l.Fragment,null,l.createElement(i.a,this.getConfirmationProps()),l.createElement(o.a,{initialActiveViewKey:"lookupconfiguration"},r=>{var i;return[l.createElement(o.b,{key:"lookupconfiguration",viewKey:"lookupconfiguration",headerText:null!==(i=this.props.editColumn)&&void 0!==i&&i.attributeName?this.props.t("controls.controlConfigurer.lookupConfigurer.editLookup"):this.props.t("controls.controlConfigurer.lookupConfigurer.addLookup"),footerButtons:t},l.createElement(n.b,e))]}))}getPropertySheet(){return{sections:[{key:"lookupConfigurerProperties",properties:[this.getLookupColumnsPicker(),this.getDefaultViewPicker()],label:""}]}}getLookupColumnsPicker(){var e=this.calculateVisibleColumnOptions();return{key:"lookupColumns",inputType:"dropdown",emptyStateText:this.props.t("controls.controlConfigurer.lookupConfigurer.noAvailableColumns"),label:this.props.t("controls.controlConfigurer.lookupConfigurer.availableColumns"),value:this.state.selectedLookupColumn,options:e,onChanged:e=>{this.handleLookupColumnChange(e)}}}handleLookupColumnChange(e){var t,r=this.props.targetTableViews[e].length>0?null===(t=this.props.targetTableViews[e][0])||void 0===t?void 0:t.id:"";this.setState({selectedLookupColumn:e,selectedDefaultView:r}),this.props.setIsDirty(!0),this.validate()}getDefaultViewPicker(){var e;return{key:"defaultview",inputType:"dropdown",disabled:!this.state.selectedLookupColumn,label:this.props.t("controls.controlConfigurer.lookupConfigurer.defaultView"),value:this.state.selectedDefaultView,options:null===(e=this.props.targetTableViews[this.state.selectedLookupColumn])||void 0===e?void 0:e.map(e=>({key:e.id,text:e.name})),onChanged:e=>this.handleDefaultViewChange(e)}}handleDefaultViewChange(e){this.setState({selectedDefaultView:e}),this.props.setIsDirty(!0),this.validate()}validate(){this.state.selectedLookupColumn&&this.state.selectedDefaultView?this.setState({isValid:!0}):this.setState({isValid:!1})}onSubmit(){if(this.state.isValid){var e={attributeName:this.state.selectedLookupColumn,children:{defaultViewId:this.state.selectedDefaultView}};this.setState({isValid:!1,selectedLookupColumn:"",selectedDefaultView:""}),this.props.onSubmit(e)}this.props.dismiss(!0)}}var c=Object(a.a)(u,[Object(s.r)("FormDesigner")])},17050:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var o=r(11204),i=r(11035),n=r.n(i),a=r(16665),s=r(16677),l=r(17051),u=r(17052),c=r(16466),p=r(16832),d=r(16812);function m(e,t){if(null==e)return{};var r,o,i=function(e,t){if(null==e)return{};var r,o,i={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){g(n,o,i,a,s,"next",e)}function s(e){g(n,o,i,a,s,"throw",e)}a(void 0)}))}}function C(e){var{t:t}=Object(o.f)("FormDesigner"),{fields:r,lookupModelValue:f,quickFormsModelValue:h,metadataService:g,onChanged:C}=e,P=f.value,w=h.additionalAttributes,O=Object(i.useMemo)(()=>{var e;return P?null===(e=r.find(e=>e.name===P))||void 0===e?void 0:e.targets:[]},[P]),D=new Set(Object.keys(w)),S=(null==O?void 0:O.length)>1,k=Object(i.useCallback)(function(){var e=b((function*(e){var t=y(y({},f),{},{name:"",value:e,additionalAttributes:{}}),r=y(y({},h),{},{name:"",value:"",additionalAttributes:{}});C([t,r])}));return function(t){return e.apply(this,arguments)}}(),[C,h,f]);function T(){return y(y({inputType:"action",key:"addFormButton",label:t("controls.controlConfigurer.formComponentEditor.emptyState.callToActionText"),onRenderEditContent:(e,t,r,o,i)=>n.a.createElement(s.b.Consumer,null,a=>n.a.createElement(l.a,{key:"relatedFormsAdditionButton",onChange:e=>{A(e)},availableRelatedTables:O,usedRelatedTables:D,initialValue:{tableName:"",formId:""},metadataService:g,dismiss:t=>{e(t)},confirmationOpen:t,setConfirmationOpen:r,isDirty:o,setIsDirty:i,isEdit:!1}))},P&&D.size>0?{propertyContainerStyles:{textAlign:"left"}}:{propertyContainerStyles:{textAlign:"center"}}),{},{required:!0})}function E(){return F.apply(this,arguments)}function F(){return(F=b((function*(){var e=[],r=yield g.getEntityDisplayNames(Object.keys(h.additionalAttributes)),o=Object.keys(h.additionalAttributes).map(function(){var e=b((function*(e){return g.getMainFormsForEntity(e)}));return function(t){return e.apply(this,arguments)}}()),i=(yield Promise.all(o)).reduce((e,t)=>e.concat(t),[]);return Object.keys(h.additionalAttributes).forEach((o,a)=>{var u,c=(null===(u=h.additionalAttributes[o])||void 0===u?void 0:u.length)>0?h.additionalAttributes[o].toLowerCase():"",b=i.find(e=>e.id.toLowerCase()===c).name,P=r.find(e=>e.logicalName===o).displayName,w={inputType:"pill",label:0===a?t("controls.controlConfigurer.formComponentEditor.polymorphicRelatedFormPicker"):"",key:"editFormPill-".concat(o,"-").concat(b),primaryText:"".concat(b),secondaryText:"Table: ".concat(P),onRenderEditContent:(e,t,r,i,a)=>n.a.createElement(s.b.Consumer,null,s=>n.a.createElement(l.a,{key:"EditFormPills-".concat(c),onChange:t=>{V(t),e()},initialValue:{tableName:o,formId:c},metadataService:g,availableRelatedTables:O,usedRelatedTables:D,dismiss:()=>{e(!0)},confirmationOpen:t,setConfirmationOpen:r,isDirty:i,setIsDirty:a,isEdit:!0})),onDelete:()=>{var e=h.additionalAttributes,{[o]:t}=e,r=m(e,[o].map(v)),i=y(y({},h),{},{additionalAttributes:r});C([f,i])},propertyContainerStyles:{marginBottom:8},required:!0,info:{tooltipId:"editFormPill-".concat(o,"-").concat(b,"-tooltip"),infoIconAriaLabel:t("controls.controlConfigurer.formComponentEditor.tooltips.polymorphicRelatedFormsPicker.relatedFormsLabel"),content:[t("controls.controlConfigurer.formComponentEditor.tooltips.polymorphicRelatedFormsPicker.relatedFormsLabel")],scope:"".concat(d.a),toggleOnClick:!1,directionalHint:p.a.topCenter}};e.push(w)}),e}))).apply(this,arguments)}function j(){return[{key:"polymorphicEmptyState",label:t("controls.controlConfigurer.formComponentEditor.polymorphicRelatedFormPicker"),inputType:"emptyState",required:!0,icon:{iconName:"TextDocument",styles:{root:{color:u.b.gray70,fontSize:46,lineHeight:"100%",marginTop:22,marginBottom:29}}},primaryMessage:t("controls.controlConfigurer.formComponentEditor.emptyState.primaryMessage"),secondaryMessage:t("controls.controlConfigurer.formComponentEditor.emptyState.secondaryMessage"),learnMoreLabel:t("learnMoreLink"),learnMoreProps:{href:d.d},maxWidth:300,info:{tooltipId:"polymorphicEmptyState-tooltip",infoIconAriaLabel:t("controls.controlConfigurer.formComponentEditor.tooltips.polymorphicRelatedFormsPicker.relatedFormsLabel"),content:[t("controls.controlConfigurer.formComponentEditor.tooltips.polymorphicRelatedFormsPicker.relatedFormsLabel")],scope:"".concat(d.a),toggleOnClick:!1,directionalHint:p.a.topCenter}},T()]}function N(){return M.apply(this,arguments)}function M(){return(M=b((function*(){return[...yield E(),T()]}))).apply(this,arguments)}function I(){var{isInsertion:o}=e;return{key:"lookupColumn",inputType:"dropdown",disabled:!o,label:t("controls.controlConfigurer.formComponentEditor.lookupColumnPicker"),value:P,options:r.map(e=>({key:e.name,text:e.displayName})),onChanged:e=>k(e),required:!0,info:{tooltipId:"lookupColumn-tooltip",infoIconAriaLabel:t("controls.controlConfigurer.formComponentEditor.tooltips.lookupColumn"),content:[t("controls.controlConfigurer.formComponentEditor.tooltips.lookupColumn")],scope:"".concat(d.a),toggleOnClick:!1,directionalHint:p.a.topCenter}}}function V(e){return L.apply(this,arguments)}function L(){return(L=b((function*(e){var t=Object.keys(e)[0],r=e[t],o=h.additionalAttributes,{[t]:i}=o,n=m(o,[t].map(v)),a=y(y({},h),{},{additionalAttributes:y(y({},n),{},{[t]:r})});C([f,a])}))).apply(this,arguments)}function A(e){return x.apply(this,arguments)}function x(){return(x=b((function*(e){var t=f.additionalAttributes,r=y(y({},f),{},{value:P,additionalAttributes:y(y({},t),{},{[c.g.DefaultViewId]:""})}),o=h.additionalAttributes,i=y(y({},h),{},{additionalAttributes:y(y({},o),e)});C([r,i])}))).apply(this,arguments)}function B(){return(B=b((function*(){var e=[I()];return S?P&&D.size>0?e.push(...yield N()):e.push(...j()):e.push({key:"inlineFormsPicker",inputType:"custom",visible:!!P,onRender:()=>{var e;return n.a.createElement(l.a,{key:"inlineFormsPicker",onChange:e=>{A(e)},initialValue:{tableName:O[0],formId:(null===(e=w[O[0]])||void 0===e?void 0:e.length)>0?w[O[0]].toLowerCase():""},availableRelatedTables:O,usedRelatedTables:D,metadataService:g,isEdit:!1})}}),e}))).apply(this,arguments)}return n.a.createElement(a.a,{sections:[{key:"formComponentEditor",label:"",properties:()=>function(){return B.apply(this,arguments)}(),showAsAccordion:!0}]})}},17051:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var o=r(11035),i=r.n(o),n=r(11204),a=r(16664),s=r(14498),l=r(16832),u=r(16812);function c(e,t,r,o,i,n,a){try{var s=e[n](a),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(o,i)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){c(n,o,i,a,s,"next",e)}function s(e){c(n,o,i,a,s,"throw",e)}a(void 0)}))}}function d(e){var{t:t}=Object(n.f)("FormDesigner"),{metadataService:r,initialValue:c,availableRelatedTables:d,usedRelatedTables:m,onChange:f,dismiss:y,setConfirmationOpen:h,isDirty:v,isEdit:g}=e,b=d.filter(e=>!m.has(e)),[C,P]=Object(o.useState)(c.tableName||b[0]||""),[w,O]=Object(o.useState)(c.formId||""),D=(null==d?void 0:d.length)>1,S=Object(o.useCallback)(e=>{P(e),O("")},[]),k=Object(o.useCallback)(e=>{(O(e),D)||f({[C]:e})},[]);function T(){return c.tableName?d.filter(e=>!m.has(e)||e===c.tableName):d.filter(e=>!m.has(e))}function E(e){return D?{key:"relatedTable",inputType:"dropdown",label:t("controls.controlConfigurer.formComponentEditor.relatedTableLabel"),value:C,options:e.map(e=>({key:e.logicalName,text:e.displayName})),onChanged:e=>S(e),required:!0,emptyStateText:t("controls.controlConfigurer.formComponentEditor.polymorphicRelatedFormPickerEmptyStateText"),info:{tooltipId:"relatedTable-tooltip",infoIconAriaLabel:t("controls.controlConfigurer.formComponentEditor.tooltips.polymorphicRelatedFormsPicker.relatedTable"),content:[t("controls.controlConfigurer.formComponentEditor.tooltips.polymorphicRelatedFormsPicker.relatedTable")],scope:"".concat(u.a),toggleOnClick:!1,directionalHint:l.a.topCenter}}:{key:"relatedTable",inputType:"readonly",label:t("controls.controlConfigurer.formComponentEditor.relatedTableLabel"),value:e[0].displayName,info:{tooltipId:"relatedTable-tooltip",infoIconAriaLabel:t("controls.controlConfigurer.formComponentEditor.tooltips.standardRelatedFormsPicker.relatedTable"),content:[t("controls.controlConfigurer.formComponentEditor.tooltips.standardRelatedFormsPicker.relatedTable")],scope:"".concat(u.a),toggleOnClick:!1,directionalHint:l.a.topCenter}}}function F(e){return{key:"relatedForm",inputType:"dropdown",label:t("controls.controlConfigurer.formComponentEditor.relatedFormPicker"),value:w,options:e.map(e=>({key:e.id.toLowerCase(),text:e.name})),onChanged:e=>{k(e)},required:!0,disabled:!C,info:{tooltipId:"relatedForm-tooltip",infoIconAriaLabel:t("controls.controlConfigurer.formComponentEditor.tooltips.relatedForm"),content:[t("controls.controlConfigurer.formComponentEditor.tooltips.relatedForm")],scope:"".concat(u.a),toggleOnClick:!1,directionalHint:l.a.topCenter}}}function j(){return(j=p((function*(){var e=T(),t=r.getEntityDisplayNames(e),o=r.getMainFormsForEntity(C),[i,n]=yield Promise.all([e.length?t:[],C?o:[]]),a=E(i),s=F(n);return yield Promise.all([a,s])}))).apply(this,arguments)}function N(){return{sections:[{key:"relatedFormsPicker",properties:()=>function(){return j.apply(this,arguments)}(),label:""}]}}if(D){var M=[{primary:!0,disabled:!C||!w,text:t(g?"controls.controlConfigurer.formComponentEditor.polymorphicCalloutSaveButton":"controls.controlConfigurer.formComponentEditor.polymorphicCalloutAddButton"),ariaLabel:t(g?"controls.controlConfigurer.formComponentEditor.polymorphicCalloutSaveButton":"controls.controlConfigurer.formComponentEditor.polymorphicCalloutAddButton"),onClick:()=>{f({[C]:w}),y(!0)}},{text:t("controls.controlConfigurer.formComponentEditor.polymorphicCalloutCancelButton"),ariaLabel:t("controls.controlConfigurer.formComponentEditor.polymorphicCalloutCancelButton"),onClick:()=>{v?h(!0):y(!0)}}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.NavigationController,{initialActiveViewKey:"formsPicker"},e=>[i.a.createElement(s.NavigationControllerView,{key:"formsPicker",viewKey:"formsPicker",headerText:t(g?"controls.controlConfigurer.formComponentEditor.polymorphicCalloutEditHeaderText":"controls.controlConfigurer.formComponentEditor.polymorphicCalloutAddHeaderText"),footerButtons:M},i.a.createElement(a.b,N()))]))}return i.a.createElement(a.b,N())}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/form-designer~power-p~0fc8d504.42b0e90d.chunk.js.map