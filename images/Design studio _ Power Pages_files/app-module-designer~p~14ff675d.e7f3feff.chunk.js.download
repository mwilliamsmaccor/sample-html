/*! For license information please see app-module-designer~p~14ff675d.e7f3feff.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{19438:function(e,t,r){"use strict";r.d(t,"b",(function(){return l}));var n=r(11056),o=r(11203),i=r(19439);r.d(t,"a",(function(){return i.a})),r.d(t,"c",(function(){return i.d}));var a=r(19440);r.d(t,"d",(function(){return a.a}));var s=r(19441);function c(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){c(i,n,o,a,s,"next",e)}function s(e){c(i,n,o,a,s,"throw",e)}a(void 0)}))}}r.d(t,"e",(function(){return s.a}));var l=Object(n.a)(u((function*(){var[e]=yield Promise.all([Promise.all([r.e(306),r.e(305),r.e(284)]).then(r.bind(null,33786)),Object(o.o)(["DataVerseCommentsPane"])]);return e.CommentsPaneWrapper})))},19439:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"f",(function(){return u}));var n=function(e){return e[e.Container=0]="Container",e[e.Thread=1]="Thread",e[e.Reply=2]="Reply",e}({}),o=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e}({}),i=function(e){return e.CreateThread="CreateThread",e.DeleteOrphanedComments="DeleteOrphanedComments",e.DeselectThread="DeselectThread",e}({}),a=function(e){return e[e.SolutionNotInstalled=0]="SolutionNotInstalled",e[e.UnknownCode=1]="UnknownCode",e[e.MissingPrivileges=2]="MissingPrivileges",e}({}),s=function(e){return e[e.Flow=0]="Flow",e[e.CanvasApp=1]="CanvasApp",e[e.BotComponent=2]="BotComponent",e[e.ModernAppDesigner=3]="ModernAppDesigner",e[e.Bot=4]="Bot",e[e.PowerPageSite=5]="PowerPageSite",e[e.Undefined=99]="Undefined",e}({}),c=function(e){return e[e.Active=1]="Active",e[e.Inactive=2]="Inactive",e}({}),u=function(e){return e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e}({})},19440:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.MissingWritePermission="MissingWritePermission",e.MissingReadPermission="MissingReadPermission",e.MissingAssignPermission="MissingAssignPermission",e.MissingDeletePermission="MissingDeletePermission",e.MissingCreatePermission="MissingCreatePermission",e.MentionedUserWithoutAccess="MentionedUserWithoutAccess",e.FeatureNotEnabled="FeatureNotEnabled",e.GenericError="GenericError",e}({})},19441:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.Success="Success",e.CannotGrantPermission="CannotGrantPermission",e.UserDoesNotExist="UserDoesNotExist",e.Failed="Failed",e}({})},21010:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(18261),o=r(13348),i=r(18265),a=r(12261),s=r(12142),c=r(12707),u=r(12187),l=r(12181),d=r(11797),p=r(12329),f=r(11035),v=r(14544),b=r(21011),m=r(21012),h=r(21015),g=r(21014);function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=e=>{var t,[r,O]=f.useState(!1),[P,j]=f.useState(void 0),C=f.useMemo(()=>e.presentUsers.map(e=>({personaName:e.displayName,imageUrl:e.imageUrl,data:e})),[e.presentUsers]),k=e.maxDisplayableUsers||3,E=Object(h.c)(e.styles),I=C.slice(k),D=e=>{O(e),N()};f.useEffect(()=>{0===I.length&&O(!1)},[null==I?void 0:I.length,O]);var T=f.useMemo(()=>C.slice(0,k).map(e=>S(S({},e),{},{onClick:b.b})),[C]),{isPersonaCoinCalloutVisible:x,facepilePersonaCoinOnClick:R,facepilePersonaCoinOnMouseEnter:U,facepilePersonaCoinOnMouseLeave:F,facepilePersonaCoinOnDismiss:A,clearPersonaCoinCallout:N}=w(),W=S(S({},Object(g.a)(S(S({},e),{},{styles:E}))),{},{styles:E}),L=(t,n)=>Object(b.a)(S(S({},W),{},{sizeInOverflow:e.sizeInOverflow,persona:t,showCallOut:!r&&x(t),onClick:e=>R(e,t),onMouseEnter:()=>U(t),onMouseLeave:()=>F(t),onDismiss:()=>A(t),closeCallOut:()=>N()}),n);return f.createElement(f.Fragment,null,f.createElement(n.a,{styles:Object(h.b)(e.size),className:E.root,personas:T,overflowPersonas:I,personaSize:null!==(t=e.size)&&void 0!==t?t:o.c.size24,maxDisplayablePersonas:k,onRenderPersona:L,onRenderPersonaCoin:L,overflowButtonProps:{title:"More users","aria-haspopup":!0,onClick:e=>{null==e||e.stopPropagation(),j(null==e?void 0:e.currentTarget),D(!r)}},overflowButtonType:i.a.descriptive}),I.length>0&&r&&f.createElement(a.a,{role:"dialog",isBeakVisible:!0,target:P,onDismiss:()=>D(!1),directionalHint:s.a.bottomCenter,setInitialFocus:!0,hideOverflow:!0,className:E.callout},f.createElement(c.a,{className:E.overflowListHeader},Object(v.a)(e.strings.presenceOverflowListTitle,I.length.toString())),f.createElement(u.a,{handleTabKey:l.b.all,isCircularNavigation:!0,className:E.overFlowListContent},f.createElement(d.a,{items:I,onRenderCell:t=>{var r;return f.createElement(p.a.Item,{className:E.overFlowListItem,styles:{root:h.a}},f.createElement(m.a,y({},W,{renderUserStatusCircle:!0,user:t.data,size:null!==(r=e.sizeInOverflow)&&void 0!==r?r:o.c.size24,onActionClick:t=>{var r;D(!1),null===(r=e.onActionClick)||void 0===r||r.call(e,t)}})))}}))))},w=()=>{var e=f.useRef(null),[t,r]=f.useState(null),[n,o]=f.useState(null),[i,a]=f.useState(null),s=()=>{r(null),o(null)};return{isPersonaCoinCalloutVisible:e=>n===e.data.alias||null===n&&t===e.data.alias,facepilePersonaCoinOnClick:(e,t)=>{null==e||e.stopPropagation(),i===t.data.alias?a(null):n===t.data.alias?s():o(t.data.alias)},facepilePersonaCoinOnMouseEnter:t=>{e.current&&clearTimeout(e.current),r(t.data.alias)},facepilePersonaCoinOnMouseLeave:n=>{e.current=setTimeout(()=>t===n.data.alias&&r(null),1e3)},facepilePersonaCoinOnDismiss:e=>{t===e.data.alias&&n!==e.data.alias||(a(e.data.alias),s())},clearPersonaCoinCallout:()=>{s(),a(null)}}}},21011:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return O}));var n=r(13348),o=r(13351),i=r(12329),a=r(12261),s=r(12142),c=r(12187),u=r(12181),l=r(12092),d=r(11035),p=r(21012),f=r(21013),v=r(21014);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=(e,t)=>{var{onRenderFacepileCoin:r}=e,n=e=>d.createElement(S,e,null==t?void 0:t(e.persona));return r?r(e,n):n(e)};function O(e){if(e.currentTarget){var t=e.currentTarget.querySelector(".".concat("baf-persona-outer-circle"));null==t||t.click()}}var S=e=>{var t=d.useRef(null),r=h(h({},Object(v.a)(e)),{},{renderUserStatusCircle:!1,size:n.c.size32,user:e.persona.data});return d.createElement(d.Fragment,null,d.createElement("div",{ref:t,onClick:e.onClick,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,className:Object(l.eb)(e.styles.facepilePersonaCoinContainer,"baf-persona-outer-circle",{borderColor:r.user.userStatus===f.b.Active?Object(o.a)({text:e.persona.personaName}):"transparent"})},d.createElement(i.a.Item,{className:Object(l.eb)(e.styles.facepilePersonaCoin,"baf-persona-inner-circle")},e.children)),e.showCallOut&&d.createElement(a.a,{onDismiss:e.onDismiss,hidden:!e.showCallOut,role:"dialog",target:t,isBeakVisible:!0,directionalHint:s.a.bottomCenter,className:e.styles.facepilePersonaCoinTooltip,onMouseOver:e.onMouseEnter,onMouseLeave:e.onMouseLeave,setInitialFocus:!0},d.createElement(c.a,{handleTabKey:u.b.all,isCircularNavigation:!0},d.createElement(p.a,b({},r,{expandPersonaActions:r.personaActionsExpandedByDefault,onActionClick:e.closeCallOut})))))}},21012:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(12329),o=r(12092),i=r(13351),a=r(13349),s=r(13346),c=r(13348),u=r(12137),l=r(13176),d=r(13174),p=r(13326),f=r(11035),v=r(21013);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=(e,t,r,s)=>{var c=e=>((e,t)=>f.createElement(n.a.Item,{className:Object(o.eb)("baf-persona-outer-circle",{borderColor:t?Object(i.a)({text:null==e?void 0:e.text}):"transparent"})},f.createElement(n.a.Item,{className:"baf-persona-inner-circle"},f.createElement(a.a,e))))(e,t);return s?s(m(m({},e),{},{user:r}),c):c(e)},y=e=>{var t,r=!!e.expandPersonaActions,[i,a]=f.useState(r),[b,m]=f.useState(void 0),h=!!e.user.location&&!!e.onGoToLocation,y=!!e.user.emailAddress,O=!!e.user.alias,S=!!e.onOpenContactCard,P=!e.hidePersonaActions&&(h||y||O),j=e.renderUserStatusCircle&&e.user.userStatus===v.b.Active,w="baf-tooltip-personCard-container".concat(i?" baf-tooltip-personCard-expanded":"");return f.createElement(f.Fragment,null,f.createElement(n.a,null,f.createElement(n.a,{"data-is-focusable":!0,role:"button","aria-expanded":i,tabindex:0,horizontal:!0,className:w,style:{justifyContent:"center",alignItems:"center"},onClick:()=>{var t;e.hidePersonaActions||(m(null===(t=e.personaActionsExpanded)||void 0===t?void 0:t.call(e,{open:!i,user:e.user})),a(!i))}},f.createElement(n.a.Item,{grow:1,styles:{root:{overflow:"hidden"}}},f.createElement(s.a,{styles:{primaryText:{fontWeight:o.l.semibold},root:{cursor:!e.hidePersonaActions&&"pointer"}},presence:e.user.personaPresence,imageUrl:e.user.imageUrl,text:e.user.displayName,showSecondaryText:!!e.user.userContext||!!e.user.userContextIcon,size:null!==(t=e.size)&&void 0!==t?t:c.c.size24,hidePersonaDetails:!1,onRenderPersonaCoin:t=>g(t,j,e.user,e.onRenderPersonaCardCoin),onRenderSecondaryText:()=>f.createElement(f.Fragment,null,f.createElement(n.a,{className:"baf-tooltip-personCard-secondaryText",tokens:{childrenGap:6},horizontal:!0},e.user.userContextIcon&&f.createElement(u.a,{iconName:e.user.userContextIcon}),e.user.userContext&&f.createElement(l.a,null,e.user.userContext)))})),P&&!r&&f.createElement(n.a.Item,{className:"baf-expand-button-container"},f.createElement(d.a,{"data-is-focusable":!1,iconProps:{iconName:i?"ChevronDown":"ChevronRight"},ariaLabel:"".concat(i?"close":"expand"," persona actions")}))),i&&h&&f.createElement(d.a,{className:"baf-action-button",iconProps:{iconName:e.hidePersonaActionIcons?"":"Go"},onClick:()=>{var t,r;null===(t=e.onGoToLocation)||void 0===t||t.call(e,e.user.location),null===(r=e.onActionClick)||void 0===r||r.call(e,v.a.GoToLocation)}},e.strings.goToLocationTitle),i&&y&&f.createElement(d.a,{className:"baf-action-button",iconProps:{iconName:e.hidePersonaActionIcons?"":"Mail"},onClick:()=>{var t;"function"==typeof e.onSendEmail?e.onSendEmail(e.user):window.open("mailto:".concat(e.user.emailAddress),"_blank"),null===(t=e.onActionClick)||void 0===t||t.call(e,v.a.SendEmail)}},e.strings.sendEmailTitle),i&&O&&f.createElement(d.a,{className:"baf-action-button",iconProps:{iconName:e.hidePersonaActionIcons?"":"Chat"},onClick:()=>{var t;"function"==typeof e.onOpenTeamsChat?e.onOpenTeamsChat(e.user):window.open("".concat("https://teams.cloud.microsoft/l/chat/0/0?users=").concat(e.user.alias)),null===(t=e.onActionClick)||void 0===t||t.call(e,v.a.ChatInTeams)}},e.strings.chatInTeamsTitle),i&&S&&f.createElement(d.a,{className:"baf-action-button",iconProps:{iconName:e.hidePersonaActionIcons?"":"ContactCard"},onClick:()=>{var t,r;null===(t=e.onOpenContactCard)||void 0===t||t.call(e,e.user),null===(r=e.onActionClick)||void 0===r||r.call(e,v.a.OpenContactCard)}},e.strings.openContactCard)),b&&f.createElement(p.a,{message:b}))}},21013:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}));var n=function(e){return e.Active="Active",e.Inactive="Inactive",e}({}),o=function(e){return e.GoToLocation="GoToLocation",e.SendEmail="SendEmail",e.ChatInTeams="ChatInTeams",e.OpenContactCard="OpenContactCard",e}({})},21014:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({onGoToLocation:e.onGoToLocation,onOpenContactCard:e.onOpenContactCard,onOpenTeamsChat:e.onOpenTeamsChat,onSendEmail:e.onSendEmail,onRenderFacepileCoin:e.onRenderFacepileCoin,onRenderPersonaCardCoin:e.onRenderPersonaCardCoin,strings:e.strings,hidePersonaActions:!!e.hidePersonaActions,hidePersonaActionIcons:!!e.hidePersonaActionIcons,personaActionsExpanded:e.personaActionsExpanded,personaActionsExpandedByDefault:!!e.personaActionsExpandedByDefault,styles:e.styles})},21015:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var n=r(13354),o=r(13348),i=r(12092),a=e=>{var t=Object(i.Y)();return Object(i.db)({root:[{margin:"auto",paddingRight:10,paddingLeft:10},null==e?void 0:e.root],facepilePersonaCoin:[{cursor:"pointer",".ms-Persona-details":{display:"none"}},null==e?void 0:e.facepilePersonaCoin],facepilePersonaCoinContainer:[null==e?void 0:e.facepilePersonaCoinContainer],facepilePersonaCoinTooltip:[{padding:12,width:300,".baf-tooltip-personCard-container":{padding:"12px 0 12px 8px",".ms-Persona-secondaryText":{color:t.palette.neutralSecondary,height:18},".ms-Persona-secondaryText span":{color:t.palette.neutralSecondary},".ms-Persona":{maxWidth:230}},".baf-tooltip-personCard-expanded":{marginBottom:8,paddingBottom:14,borderColor:t.palette.neutralLight,borderWidth:1,borderBottomStyle:"solid"},".baf-expand-button-container":{textAlign:"center",width:44},".baf-action-button":{height:28}},null==e?void 0:e.facepilePersonaCoinTooltip],callout:[{padding:"8px 12px 14px 8px",".ms-Callout-main ":{display:"flex",flexDirection:"column"}},null==e?void 0:e.callout],overFlowListContent:[{maxHeight:350,overflowX:"hidden",width:300,".baf-action-button":{height:28},".baf-tooltip-personCard-expanded":{marginBottom:8,paddingBottom:12,borderColor:t.palette.neutralLight,borderWidth:1,borderBottomStyle:"solid"}},null==e?void 0:e.overFlowListContent],overflowListHeader:[{padding:"12px 12px 10px 16px"},null==e?void 0:e.overFlowListContent],overFlowListItem:[{cursor:"default",padding:"6px 12px 12px 16px",boxSizing:"border-box",minHeight:42},null==e?void 0:e.overFlowListItem]})},s={".baf-persona-outer-circle":{borderRadius:"50%",borderWidth:2,borderStyle:"solid",".baf-persona-inner-circle":{borderRadius:"50%",border:"2px solid transparent"}}},c=e=>({member:s,itemButton:{"&:hover.ms-Button":{backgroundColor:"transparent"}},descriptiveOverflowButton:{height:n.e[null!=e?e:o.c.size24],width:n.e[null!=e?e:o.c.size24],margin:"4px 4px 4px 8px",border:"1px solid #e1dfdd"}})},21016:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11543),o=r.n(n),i=r(11035),a=e=>{var t=Object(i.useRef)(e);return e&&!o()(t.current,e)&&(t.current=e),t.current}},21017:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11543),o=r.n(n),i=r(11035),a=e=>{var t=Object(i.useRef)(e);return o()(t.current,e)||(t.current=e),t.current}},21018:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var n=r(11035),o=r.n(n),i=r(21019);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=o.a.createContext({}),l=()=>o.a.useContext(u),d=e=>{var t;return o.a.createElement(u.Provider,{value:s(s({},e.value),{},{collaborationUrls:null!==(t=e.value.collaborationUrls)&&void 0!==t?t:new i.a})},e.children)}},21019:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(21020),o=r(21022);class i{constructor(e){this.rpUrls=void 0,this.graphUrls=void 0,this.dataverseUrls=void 0,this.rpUrls=e?new o.a:new n.a,this.graphUrls=new a,this.dataverseUrls=new s}}class a{}class s{}},21020:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(21021);class o{constructor(){this.ppapiVersion="api-version=1"}getEnvironmentFilterQueryString(e,t){return t?"".concat(e,"$filter=environmentId eq '").concat(t,"'"):""}getTargetService(){return n.a.ppapi}getStartSessionUrl(e,t,r){return"powerapps/".concat(e,"/").concat(t,"/startSession?").concat(this.ppapiVersion)}getRefreshSessionUrl(e,t,r,n){return"powerapps/".concat(e,"/").concat(t,"/sessions/").concat(n,"/refreshSession?").concat(this.ppapiVersion)}getEndSessionUrl(e,t,r,n){return"powerapps/".concat(e,"/").concat(t,"/sessions/").concat(n,"/endSession?").concat(this.ppapiVersion)}getGetSessionsUrl(e,t,r){return"powerapps/".concat(e,"/").concat(t,"/sessions?").concat(this.ppapiVersion)}getUsersPermissionsUrl(e,t,r){var n=r?"($filter=maxAssignedTo('".concat(r,"'))"):"";return"powerapps/apps/".concat(e,"/permissions?$expand=permissions").concat(n).concat(this.getEnvironmentFilterQueryString("&",t),"&").concat(this.ppapiVersion)}getModifyPermissionsUrl(e,t){return"powerapps/apps/".concat(e,"/modifyPermissions?").concat(this.getEnvironmentFilterQueryString("&",t),"&").concat(this.ppapiVersion)}getSyncCommentPrivilegesUrl(e,t){return"powerapps/apps/".concat(e,"/synchronizeCommentPrivileges?").concat(this.ppapiVersion)}}},21022:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(21021);class o{constructor(){this.rpApiVersion="api-version=2020-06-01",this.appBasePath="/providers/Microsoft.PowerApps"}getEnvironmentFilterQueryString(e){return e?"&$filter=environmentId eq '".concat(e,"'"):""}getSessionBasePath(e,t,r){return"api/environments/".concat(r,"/").concat(e,"/").concat(t)}getTargetService(){return n.a.paRp}getStartSessionUrl(e,t,r){return"".concat(this.getSessionBasePath(e,t,r),"/startSession?").concat(this.rpApiVersion)}getRefreshSessionUrl(e,t,r,n){return"".concat(this.getSessionBasePath(e,t,r),"/sessions/").concat(n,"/refreshSession?").concat(this.rpApiVersion)}getEndSessionUrl(e,t,r,n){return"".concat(this.getSessionBasePath(e,t,r),"/sessions/").concat(n,"/endSession?").concat(this.rpApiVersion)}getGetSessionsUrl(e,t,r){return"".concat(this.getSessionBasePath(e,t,r),"/sessions?").concat(this.rpApiVersion)}getUsersPermissionsUrl(e,t,r){var n=r?"($filter=maxAssignedTo('".concat(r,"'))"):"";return"".concat(this.appBasePath,"/apps/").concat(e,"/permissions?$expand=permissions").concat(n).concat(this.getEnvironmentFilterQueryString(t),"&").concat(this.rpApiVersion)}getModifyPermissionsUrl(e,t){return"".concat(this.appBasePath,"/apps/").concat(e,"/modifyPermissions?").concat(this.getEnvironmentFilterQueryString(t),"&").concat(this.rpApiVersion)}getSyncCommentPrivilegesUrl(e,t){return"".concat(this.appBasePath,"/environments/").concat(t,"/apps/").concat(e,"/synchronizeCommentPrivileges?").concat(this.rpApiVersion)}}},21023:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r(11035),o=r(21018),i=r(21024),a=r(18577),s=n.createContext({}),c=()=>n.useContext(s),u=e=>{var{httpRequestor:t,telemetryService:r}=Object(o.b)(),{resourceId:c,getDependenciesAsync:u}=e,[l,d]=n.useState(),p=n.useMemo(()=>c?new i.a(t,r,c,u):void 0,[t,r,c,u]),f=n.useCallback(()=>{var e=null==p?void 0:p.getSharedWorkspaceId();r.trackInfo(a.a.FRSContainerFetched,{sharedWorkspaceName:c,sharedWorkspaceId:e}),d(e)},[p,r,c]),v=n.useMemo(()=>({frsService:p,resourceId:c,sharedWorkspaceId:l,onFRSContainerFetched:f,onFRSContainerConnected:e.onFRSContainerConnected,onFRSContainerDisconnected:e.onFRSContainerDisconnected,onFRSContainerConnectionError:e.onFRSContainerConnectionError}),[p,c,l,f,e.onFRSContainerConnected,e.onFRSContainerDisconnected,e.onFRSContainerConnectionError]);return n.createElement(s.Provider,{value:v},e.children)}},21024:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(21025),o=r(21021),i=r(21026),a=r(21028),s=r(18073),c=r(18577),u=r(21029),l=r(21030),d=r(21032),p=r(21031),f=r(21033);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){h(i,n,o,a,s,"next",e)}function s(e){h(i,n,o,a,s,"throw",e)}a(void 0)}))}}class y extends i.a{constructor(e,t,r,n){super(e,"sharedworkspaces"),this.telemetryService=t,this.sharedWorkspaceName=r,this.getDependenciesAsync=n,this.sharedWorkspaceId=void 0}createContainer(e,t){var r=this;return g((function*(){var{sharedWorkspaceName:n}=r;if(!n)return Promise.reject();var{enableVerboseFluidLogging:o,enableRecreatingDeletedContainers:i}=null!=t?t:{},a={sharedWorkspaceName:n},s=r.telemetryService.createScenarioTracker(c.b.GetSharedWorkspace,u.a.Load,a);try{var d=r.getDependenciesAsync?yield r.getDependenciesAsync():void 0,p=yield r.getOrCreateSharedWorkspace(n,d);r.sharedWorkspaceId=p.sharedworkspaceid;var v=yield r.getFluidContainerAndServices(p,e,o);return s.complete(b(b({},a),{},{sharedWorkspaceId:p.sharedworkspaceid})),{container:v.container,audience:v.services.audience}}catch(h){var m=Object(l.a)(h);return s.failure(b(b(b({},a),m),{},{sharedWorkspaceId:r.sharedWorkspaceId})),Object(f.a)(h)&&r.canDeleteContainer(i)?((yield r.deleteSharedWorkspace())&&y.deletedContainers.add(n),r.sharedWorkspaceId=void 0,Promise.reject({message:"Container was deleted. Should retry.",canRetry:!0,name:"FRSError",innerError:m})):(r.sharedWorkspaceId=void 0,Promise.reject(m))}}))()}canDeleteContainer(e){var{sharedWorkspaceName:t,sharedWorkspaceId:r}=this;return!(!e||!r)&&!y.deletedContainers.has(t)}getSharedWorkspaceId(){return this.sharedWorkspaceId}deleteSharedWorkspace(){var e=this;return g((function*(){var{sharedWorkspaceId:t,sharedWorkspaceName:r}=e;if(!t)return Promise.reject();var i={sharedWorkspaceName:r,sharedWorkspaceId:t},a=e.telemetryService.createScenarioTracker(c.b.DeleteSharedWorkspace,u.a.Delete,i);try{var s="".concat(e.entityPath,"(").concat(t,")"),d=yield e.requestor.makeRequestAsync({service:o.a.cds,path:s,method:n.a.Delete,responseType:"json"},a);return a.complete(b({},i)),d.statusCode>=200&&d.statusCode<300}catch(v){var f=Object(l.a)(v);return Object(p.b)(v)&&404===v.status?(a.completeWithWarning(b(b({},i),f)),!1):(a.failure(b(b({},i),f)),Promise.reject(f))}}))()}getSharedWorkspace(e){var t=this;return g((function*(){var r={sharedWorkspaceName:e},i=t.telemetryService.createScenarioTracker(c.b.GetSharedWorkspace,u.a.Load,r);try{var a="".concat(t.entityPath,"?").concat(t.getFilterString(e),"&").concat(t.getSelectString()),s=yield t.requestor.makeRequestAsync({service:o.a.cds,path:a,method:n.a.Get,responseType:"json"},i);return i.complete(b(b({},r),{},{sharedWorkspaceFound:s.body.value.length>0})),s.body.value[0]}catch(d){return i.failure(b(b({},r),Object(l.a)(d))),Promise.reject(Object(l.a)(d))}}))()}getOrCreateSharedWorkspace(e,t){var r=this;return g((function*(){var i={sharedWorkspaceName:e},a=r.telemetryService.createScenarioTracker(c.b.GetOrCreateSharedWorkspace,u.a.Create,i);try{var s="".concat(r.odataPath,"/GetOrCreateSharedWorkspace"),d=yield r.requestor.makeRequestAsync({service:o.a.cds,path:s,method:n.a.Post,responseType:"json",body:JSON.stringify({target:b({name:e},t?{sharedworkspace_sharedobject:t.map(e=>({objectid:e.objectId,objecttype:e.objectType}))}:{})}),headers:{Prefer:"return=representation","Content-Type":"application/json"}},a);return a.complete(i),d.body}catch(p){return a.failure(b(b({},i),Object(l.a)(p))),Promise.reject(Object(l.a)(p))}}))()}getFilterString(e){return"$filter=name eq '".concat(e,"'")}getSelectString(){return"$select=sharedworkspaceid,name,accesstoken,discoveryendpoint,workspaceschema,tenantid"}getFluidContainerAndServices(e,t,r){var n=this;return g((function*(){var o={sharedWorkspaceName:null==e?void 0:e.name,sharedWorkspaceId:null==e?void 0:e.sharedworkspaceid},i=n.telemetryService.createScenarioTracker(c.b.GetFluidContainerAndServices,u.a.Other,o);try{var d={endpoint:e.discoveryendpoint,tokenProvider:new a.a(e.accesstoken,()=>n.fetchAccessToken()),type:"remote",tenantId:e.tenantid},p=new s.a({connection:d,logger:n.getFluidLogger(r,e)}),f=yield p.getContainer(e.sharedworkspaceid,t);return i.complete(o),f}catch(v){return i.failure(b(b({},o),Object(l.a)(v))),Promise.reject(Object(l.a)(v))}}))()}fetchAccessToken(){var e=this;return g((function*(){var{sharedWorkspaceName:t}=e,r={sharedWorkspaceName:t},n=e.telemetryService.createScenarioTracker(c.b.FetchAccessToken,u.a.Load,r);try{var o=yield e.getSharedWorkspace(t);return n.complete(b(b({},r),{},{sharedWorkspaceFound:!!o})),null==o?void 0:o.accesstoken}catch(i){return n.failure(b(b({},r),Object(l.a)(i))),Promise.reject(Object(l.a)(i))}}))()}getFluidLogger(e,t){return e?new d.a(this.telemetryService,{containerIdFromDataverse:null==t?void 0:t.sharedworkspaceid}):void 0}}y.deletedContainers=new Set},21026:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(21027);class o extends n.a{constructor(e,t){super(e),this.entityPath=void 0,this.entityPath="".concat(this.odataPath,"/").concat(t)}}},21027:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){this.odataPath="/api/data/v9.1",this.requestor=void 0,this.requestor=e}}},21028:function(e,t,r){"use strict";function n(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}r.d(t,"a",(function(){return i}));class i{constructor(e,t){this.cachedAccessToken=void 0,this.fetchAccessToken=void 0,this.cachedAccessToken=e,this.fetchAccessToken=t}fetchOrdererToken(e,t,r){var n=this;return o((function*(){return r&&(n.cachedAccessToken=yield n.fetchAccessToken()),{jwt:n.cachedAccessToken}}))()}fetchStorageToken(e,t,r){var n=this;return o((function*(){return r&&(n.cachedAccessToken=yield n.fetchAccessToken()),{jwt:n.cachedAccessToken}}))()}}},21032:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(18577);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a{constructor(e,t){this.telemetryService=e,this.baseParameters=t}send(e){if(e&&0!==Object.keys(e).length){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.baseParameters);for(var r of Object.keys(e))t[r]=e[r];"error"===e.category?this.telemetryService.trackError(n.a.VerboseFluidLogger,t):this.telemetryService.trackInfo(n.a.VerboseFluidLogger,t)}}}},21033:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(21034);function o(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.error;return(null==r?void 0:r.code)===n.b||(null==r?void 0:r.message)===n.c}function i(e){var t;return function(e){return"fileNotFoundOrAccessDeniedError"===(null==e?void 0:e.errorType)}(e)&&!(null==e||null===(t=e.message)||void 0===t||!t.includes(n.d))}},21034:function(e,t,r){"use strict";r.d(t,"m",(function(){return n})),r.d(t,"j",(function(){return o})),r.d(t,"k",(function(){return i})),r.d(t,"l",(function(){return a})),r.d(t,"f",(function(){return s})),r.d(t,"h",(function(){return c})),r.d(t,"n",(function(){return u})),r.d(t,"a",(function(){return l})),r.d(t,"g",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"e",(function(){return f})),r.d(t,"c",(function(){return v})),r.d(t,"b",(function(){return b})),r.d(t,"d",(function(){return m}));var n="PowerAppsRPSessionsDetails",o=9e5,i=1e4,a=6e4,s="PresenceTeachingBubblePermanentlyHidden",c="PresenceTeachingBubbleDismissedOnce",u=3e5,l=18e4,d=4,p="coPresenceWrapper",f="FRSServiceLoading",v="FCB.RealTimeCollaboration is not enabled.",b="0x80048d0c",m="R11s fetch error: Document is deleted and cannot be accessed."},22258:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(18474),o=r(22259);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"selection",r=arguments.length>2?arguments[2]:void 0,i=Object(n.i)(e,e=>({personaName:"userName"in e?e.userName:e.userId,data:e}),r,t);return i.defaultProps=a(a({},i.defaultProps),{},{itemPresenceFacepileAs:o.a}),i}},22259:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(18261),o=r(11035),i=r(21018),a=r(22260),s=["personas"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=e=>{var{graphService:t}=Object(i.b)(),{personas:r}=e,l=u(e,s),d=r?r.filter(e=>{var t;return!(null===(t=e.data.additionalDetails)||void 0===t||!t.AadObjectId)}).map(e=>e.data.additionalDetails.AadObjectId):[],{userData:p,userPhotos:f}=Object(a.a)(t,d),v=d.map(e=>{var t;return{personaName:null===(t=p[e])||void 0===t?void 0:t.displayName,imageUrl:f[e]}});return o.createElement(n.a,c({personas:v},l))}},22260:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(12304);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){s(i,n,o,a,c,"next",e)}function c(e){s(i,n,o,a,c,"throw",e)}a(void 0)}))}}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{data:o,isInitialLoading:a}=Object(n.a)(["userDataAndPhotos",t],c((function*(){return{userData:yield e.getUsers(t),userPhotos:yield e.getUserPhotos(t)}})),i({keepPreviousData:!0},r));return{isInitialLoading:a,userData:(null==o?void 0:o.userData)||{},userPhotos:(null==o?void 0:o.userPhotos)||{}}}},23450:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.SchemaNameIsNotUnique="0x80044363",e.CdsUserNoRolesAssigned="0x80042f09",e.SolutionDependenciesExist="0x8004f01d",e.RetrieveMultipleNotPermitted="0x80040256",e.RetrieveMultipleNotImplemented="0x80040219",e.InsufficientPermissions="0x80040220",e.CannotStartAnotherOperation="0x80071151",e}({})},24447:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(12457),o=r(11819),i=r(15179),a=r(11035),s=r(24448),c=r(24477),u=r(24478);r.d(t,"b",(function(){return s.b}));var l=Object(i.b)(e=>{var t=Object(n.R)();return a.createElement(u.a,{telemetryScope:c.b,telemetryPrefix:c.a,featureGates:e.featureGates},a.createElement(s.a,{environmentId:t.currentEnvironmentName,resourceId:e.resourceId,resourceType:e.resourceType,getDependenciesAsync:e.getDependenciesAsync,onFRSContainerConnected:e.onFRSContainerConnected,onFRSContainerDisconnected:e.onFRSContainerDisconnected,onFRSContainerDisposed:e.onFRSContainerDisposed,onFRSContainerConnectionError:e.onFRSContainerConnectionError,enableVerboseFluidLogging:e.enableVerboseFluidLogging},e.children))},[o.p])},24448:function(e,t,r){"use strict";var n=r(24449);r.d(t,"a",(function(){return n.a}));r(24454);var o=r(24455);r.d(t,"b",(function(){return o.a}));r(24473)},24449:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11035),o=r(24450),i=r(24453),a=r(21023),s=r(21018),c=["children"];function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var d=e=>{var{children:t}=e,r=l(e,c),{featureGates:d}=Object(s.b)();return n.createElement(o.a,r,n.createElement(a.a,r,n.createElement(i.a,u({},r,{disabled:!(null!=d&&d.useFRS)}),t)))}},24450:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c}));var n=r(11035),o=r(21018),i=r(24451),a=n.createContext({}),s=()=>n.useContext(a),c=e=>{var[t,r]=n.useState({}),{environmentId:s,resourceType:c,resourceId:u,rpPresenceServiceOverride:l,sessionRefreshIntervals:d}=e,{httpRequestor:p,telemetryService:f,collaborationUrls:v}=Object(o.b)(),b=n.useMemo(()=>u&&s&&!l?new i.a(p,f,c,u,s,v):void 0,[p,f,c,u,s,l]),m=n.useMemo(()=>({presentUsers:t,setPresentUsers:r,environmentId:s,resourceId:u,resourceType:c,rpPresenceService:null!=l?l:b,sessionRefreshIntervals:d}),[t,r,s,u,c,b,l,d]);return n.createElement(a.Provider,{value:m},e.children)}},24451:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(24452),o=r(18577),i=r(21029),a=r(21025),s=r(21031);function c(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){c(i,n,o,a,s,"next",e)}function s(e){c(i,n,o,a,s,"throw",e)}a(void 0)}))}}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f{constructor(e,t,r,n,o,i){this.httpRequestor=void 0,this.telemetryService=void 0,this.resourceType=void 0,this.resourceId=void 0,this.environmentId=void 0,this.collaborationUrls=void 0,this.httpRequestor=e,this.telemetryService=t,this.resourceType=r,this.resourceId=n,this.environmentId=o,this.collaborationUrls=i}parseJsonOrEmpty(e){try{return JSON.parse(e)}catch(t){return{}}}postProcessCurrentSessionResponse(e){return d(d({},e.currentSession),{},{userClientContext:this.parseJsonOrEmpty(e.currentSession.userClientContext)})}postProcessCopresenceDetailsResponse(e){var t={};return Object.keys(e.sessions).forEach(r=>{var n=e.sessions[r];t[r]=d(d({},n),{},{userClientContext:this.parseJsonOrEmpty(n.userClientContext)})}),d(d({},e),{},{sessions:t})}startSession(e,t){var r=this;return u((function*(){var n=r.telemetryService.createScenarioTracker(o.b.StartSession,i.a.Create);try{var c=yield r.httpRequestor.makeRequestAsync({service:r.collaborationUrls.rpUrls.getTargetService(),path:r.collaborationUrls.rpUrls.getStartSessionUrl(r.resourceType,r.resourceId,r.environmentId),method:a.a.Post,body:JSON.stringify({sessionType:e,userClientContext:JSON.stringify(t)}),headers:{"Content-Type":"application/json"},responseType:"json"},n);return n.complete(),{currentSession:r.postProcessCurrentSessionResponse(c.body),copresenceDetails:r.postProcessCopresenceDetailsResponse(c.body.copresenceDetails)}}catch(u){if(Object(s.b)(u))throw n.failure({errorData:u.body.error}),u.body.error;throw n.failure({errorData:u}),u}}))()}getSessions(){var e=this;return u((function*(){var t=e.telemetryService.createScenarioTracker(o.b.GetActiveSessions,i.a.Load);try{var r=yield e.httpRequestor.makeRequestAsync({service:e.collaborationUrls.rpUrls.getTargetService(),path:e.collaborationUrls.rpUrls.getGetSessionsUrl(e.resourceType,e.resourceId,e.environmentId),method:a.a.Get,responseType:"json"},t);return t.complete(),{copresenceDetails:e.postProcessCopresenceDetailsResponse(r.body.copresenceDetails)}}catch(c){if(Object(s.b)(c))throw t.failure({errorData:c.body.error}),c.body.error;throw c.code!==n.a.CopresenceDetailsNotFound&&t.failure({errorData:c}),c}}))()}refreshSession(e,t){var r=this;return u((function*(){var n=r.telemetryService.createScenarioTracker(o.b.RefreshSession,i.a.Update);try{var c=yield r.httpRequestor.makeRequestAsync({service:r.collaborationUrls.rpUrls.getTargetService(),path:r.collaborationUrls.rpUrls.getRefreshSessionUrl(r.resourceType,r.resourceId,r.environmentId,e),method:a.a.Post,responseType:"json",headers:{"Content-Type":"application/json"},body:JSON.stringify({userClientContext:JSON.stringify(t)})},n);return n.complete(),{currentSession:r.postProcessCurrentSessionResponse(c.body),copresenceDetails:r.postProcessCopresenceDetailsResponse(c.body.copresenceDetails)}}catch(u){if(Object(s.b)(u))throw n.failure({errorData:u.body.error}),u.body.error;throw n.failure({errorData:u}),u}}))()}endSession(e){var t=this;return u((function*(){var r=t.telemetryService.createScenarioTracker(o.b.EndSession,i.a.Delete);try{yield t.httpRequestor.makeRequestAsync({service:t.collaborationUrls.rpUrls.getTargetService(),path:t.collaborationUrls.rpUrls.getEndSessionUrl(t.resourceType,t.resourceId,t.environmentId,e),method:a.a.Post,headers:{"Content-Type":"application/json"},responseType:"json"},r),r.complete()}catch(n){if(Object(s.b)(n))throw r.failure({errorData:n.body.error}),n.body.error;throw r.failure({errorData:n}),n}}))()}}},24452:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i}));var n=function(e){return e.ApplicationNotFound="ApplicationNotFound",e.CopresenceDetailsNotFound="CopresenceDetailsNotFound",e.SessionNotFound="SessionNotFound",e.SessionUserMismatch="SessionUserMismatch",e.SessionNotAvailable="SessionNotAvailable",e.ServiceToServiceEnvironmentNotFound="ServiceToServiceEnvironmentNotFound",e.EnvironmentDisabled="EnvironmentDisabled",e.BusinessAppPlatformRequestFailed="BusinessAppPlatformRequestFailed",e}({}),o=e=>{var t=e;return t&&void 0!==t.code&&void 0!==t.message&&t.code in n},i=e=>{var t=[n.ServiceToServiceEnvironmentNotFound,n.EnvironmentDisabled,n.BusinessAppPlatformRequestFailed];return o(e)&&t.includes(e.code)}},24453:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(17931),o=r(11035),i=r(12307),a=r(18577),s=r(21018),c=r(21023),u=r(21034),l=r(21033),d=["retryConnecting","enableVerboseFluidLogging","enableRecreatingDeletedContainers"];function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var g=e=>{var t,{retryConnecting:r,enableVerboseFluidLogging:v,enableRecreatingDeletedContainers:m}=e,g=h(e,d),{telemetryService:y}=Object(s.b)(),{frsService:O,resourceId:S,sharedWorkspaceId:P,onFRSContainerFetched:j,onFRSContainerConnected:w,onFRSContainerDisconnected:C,onFRSContainerDisposed:k,onFRSContainerConnectionError:E}=Object(c.b)(),I=Object(i.b)().getDefaultOptions(),D=o.useRef(),T=o.useMemo(()=>({sharedWorkspaceName:S,sharedWorkspaceId:P}),[S,P]),x=o.useCallback((e,t)=>{var n;if(Object(l.b)(t))return!1;if("function"==typeof r)return r(e,t);var o="number"==typeof r?r:"number"==typeof(null==I||null===(n=I.queries)||void 0===n?void 0:n.retry)?I.queries.retry:3,i=null==t?void 0:t.canRetry;if(void 0!==i)return i&&e<o;if("boolean"==typeof r)return r;if(void 0===r){var a,s;if("boolean"==typeof(null==I||null===(a=I.queries)||void 0===a?void 0:a.retry))return I.queries.retry;if("function"==typeof(null==I||null===(s=I.queries)||void 0===s?void 0:s.retry))return I.queries.retry(e,t)}return e<o},[r,null==I||null===(t=I.queries)||void 0===t?void 0:t.retry]),R=o.useCallback(()=>{y.trackInfo(a.a.DataverseSharedStateProviderConnected,b(b({},T),{},{durationFromLastDisconnect:D.current?Date.now()-D.current:void 0})),D.current=void 0,null==w||w()},[y,T,w]),U=o.useCallback(()=>{D.current=Date.now(),y.trackInfo(a.a.DataverseSharedStateProviderDisconnected,T),null==C||C()},[y,T,C]),F=o.useCallback(()=>{D.current=Date.now(),y.trackInfo(a.a.DataverseSharedStateProviderDisposed,T),null==k||k()},[y,T,k]),A=o.useCallback(e=>{(null==e?void 0:e.message)!==u.e&&(y.trackInfo(a.a.DataverseSharedStateProviderErrorConnecting,b(b({},T),{},{error:e})),null==E||E(e))},[y,T,E]);return o.createElement(n.b,p({sessionId:S,sessionFactory:function(){var e,t=(e=function*(e,t){if(!O)return Promise.reject({message:u.e,canRetry:!1});var r=O.createContainer(t,{enableVerboseFluidLogging:v,enableRecreatingDeletedContainers:m});return yield r,null==j||j(),r},function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){f(i,n,o,a,s,"next",e)}function s(e){f(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(e,r){return t.apply(this,arguments)}}(),retryConnecting:x,onConnect:R,onDisconnect:U,onDispose:F,onErrorConnecting:A},g),e.children)}},24454:function(e,t,r){},24455:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(11035),o=r(21018),i=r(21023),a=r(24450),s=r(24456),c=r(24466),u=r(24472),l=e=>{var{featureGates:t,telemetryService:r}=Object(o.b)(),{resourceId:l}=Object(i.b)(),{environmentId:d,rpPresenceService:p,resourceId:f}=Object(a.b)();if(!(null!=l?l:f))return null;var v=null;return null!=t&&t.useFRS||!d||!p?null!=t&&t.useFRS&&(v=n.createElement(s.a,e)):v=n.createElement(c.a,e),n.createElement(u.a,{telemetryService:r,strings:e.localizationStrings},v)}},24456:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(18257),o=r(11035),i=r(21018),a=r(21017),s=r(21016),c=r(18577),u=r(24457),l=r(24459),d=r(24463),p=r(11543),f=r.n(p),v=r(21023),b=r(22260);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=e=>{var t,{myself:r,members:p}=Object(n.a)(),g=Object(a.a)(null!==(t=p)&&void 0!==t?t:[]),y=Object(s.a)(r),[O,S]=o.useState(g),[P,j]=o.useState([]),w=o.useRef(void 0),C=o.useRef(),{localizationStrings:k}=e,{graphService:E,setCollaboratingUsers:I,telemetryService:D,featureGates:T}=Object(i.b)(),{resourceId:x,sharedWorkspaceId:R}=Object(v.b)();o.useEffect(()=>(g.length?(C.current&&(clearTimeout(C.current),C.current=void 0),S(g)):C.current=window.setTimeout(()=>{C.current=void 0,S(g)},5e3),()=>{C.current&&clearTimeout(C.current)}),[g]),o.useEffect(()=>{var e,t=null!==(e=O.map(e=>({userId:e.userId,connections:e.connections.map(e=>({id:e.id}))})))&&void 0!==e?e:[];I(t);var r=O.filter(e=>{var t;return e.userId!==(null==y?void 0:y.userId)&&!(null===(t=e.additionalDetails)||void 0===t||!t.AadObjectId)}).map(e=>e.additionalDetails.AadObjectId);if(!f()(r,w.current)&&R&&x){var n={sharedWorkspaceId:R,sharedWorkspaceName:x,isCoauthoringEnabled:null==T?void 0:T.useFRS};0===r.length?D.trackInfo(c.a.FRSJustMyselfPresent,n):D.trackInfo(c.a.FRSOtherUsersPresent,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({numUsers:r.length},n)),w.current=r}j(r)},[O,y,R,x,null==T?void 0:T.useFRS]);var{userData:U,userPhotos:F}=Object(b.a)(E,P);if(!O.length)return o.createElement(d.a,{localizationStrings:k});if((null==P?void 0:P.length)>0&&U){var A=P.filter(e=>!!U[e]).map(e=>Object(u.a)({localizationStrings:k,user:U[e],imageUrl:F[e],hideSessionType:!0}));return o.createElement(l.a,{presentUsers:A,localizationStrings:k})}return o.createElement(o.Fragment,null)}},24457:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(24458),o=e=>{var{localizationStrings:t,user:r,imageUrl:o,userStatus:i,session:a,hideSessionType:s}=e,c=(null==a?void 0:a.activeSessionType)===n.a.Writer?t.editorStatusText:t.viewerStatusText,u=(null==a?void 0:a.activeSessionType)===n.a.Writer?"Edit":"View";return{displayName:r.displayName,emailAddress:r.mail,alias:r.userPrincipalName,imageUrl:o,userStatus:i,location:null==a?void 0:a.userClientContext.location,userContext:s?void 0:c,userContextIcon:s?void 0:u}}},24458:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.Writer="Writer",e.Reader="Reader",e}({})},24459:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(21010),o=r(11035),i=r(21018),a=r(24460),s=r(21034),c=r(18577),u=r(24461);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=e=>{var[t,r]=o.useState(!1),{telemetryService:l,featureGates:p}=Object(i.b)(),[f,v]=o.useState(a.a.isAvailable()&&a.a.getItem(s.h));o.useEffect(()=>{var t=a.a.isAvailable()&&a.a.getItem(s.f);e.presentUsers.length>0&&!t&&r(!0)},[e.presentUsers]);var b=o.useCallback(e=>{r(!1),f?e&&(a.a.isAvailable()&&a.a.setItem(s.f,!0),l.trackInfo(c.a.TeachingBubblePermanentDismissal)):(a.a.isAvailable()&&a.a.setItem(s.h,!0),v(!0))},[f,v,r,l,a.a]);return o.createElement(o.Fragment,null,(null==p?void 0:p.enablePresenceTeachingBubble)&&t&&o.createElement(u.a,{targetId:s.i,localizationStrings:e.localizationStrings,onDismiss:b,showPermanentDismissCheckbox:!!f}),e.presentUsers.length>0&&o.createElement("div",{id:s.i,style:{display:"flex"}},o.createElement(n.a,{presentUsers:e.presentUsers,maxDisplayableUsers:s.g,strings:d({},e.localizationStrings),onActionClick:e=>l.trackInfo(c.a.PresenceActionClicked,{action:e})})))}},24460:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));class n{constructor(e){this.storage=void 0,this.storage=e}getItem(e){var t=this.storage.getItem(e);if(t)try{return JSON.parse(t)}catch(r){return void this.storage.removeItem(e)}}setItem(e,t){this.storage.setItem(e,JSON.stringify(t))}removeItem(e){this.storage.removeItem(e)}isAvailable(){if(!this.storage)return!1;var e=!1;try{this.storage.setItem("__storageTest","__storageTest"),e="__storageTest"===this.storage.getItem("__storageTest"),this.storage.removeItem("__storageTest")}catch(t){}return e}}var o=new n(window.sessionStorage),i=new n(window.localStorage)},24461:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(12705),o=r(17001),i=r(12142),a=r(12329),s=r(13176),c=r(12520),u=r(13272),l=r(11035),d=r(24462),p=e=>{var{localizationStrings:t}=e,[r,p]=l.useState(!1),f=Object(n.a)(),v=Object(d.a)(f);return l.createElement(o.a,{styles:v.bubble,target:"#".concat(e.targetId),onDismiss:()=>{e.onDismiss(r)},calloutProps:{preventDismissOnLostFocus:!0,directionalHint:i.a.bottomCenter,onDismiss:()=>{}},hasCloseButton:!0,headline:t.teachingBubbleHeadline},l.createElement(a.a,{tokens:{childrenGap:14}},l.createElement(s.a,{styles:v.text},t.teachingBubbleContent),l.createElement(c.a,{styles:v.link,href:"https://go.microsoft.com/fwlink/?linkid=2205805",underline:!0,target:"_blank"},t.learnMore),e.showPermanentDismissCheckbox&&l.createElement(u.a,{styles:v.checkbox,label:t.teachingBubbleCheckboxText,onChange:(e,t)=>{p(!!t)}})))}},24462:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12092),o=e=>({checkbox:Object(n.db)({root:{"&.is-checked .ms-Checkbox-checkbox":{background:e.palette.white},"&.is-checked.ms-Checkbox .ms-Checkbox-checkmark":{color:e.palette.themePrimary},":hover .ms-Checkbox-checkbox, :focus .ms-Checkbox-checkbox":{borderColor:e.palette.white,background:"transparent"},":hover .ms-Checkbox-text, :focus .ms-Checkbox-text":{color:e.palette.white},":hover .ms-Checkbox-checkmark, :focus .ms-Checkbox-checkmark":{color:e.palette.white},marginTop:14},checkbox:{borderColor:e.palette.white},text:{color:e.palette.white}}),bubble:{bodyContent:{paddingBottom:"0"}},link:Object(n.db)({root:{color:e.palette.white,"&.ms-Link:hover, &.ms-Link:focus":{color:"".concat(e.palette.white," !important")}}}),text:Object(n.db)({root:{color:e.palette.white}})})},24463:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(12705),o=r(13176),i=r(12520),a=r(13117),s=r(13346),c=r(13348),u=r(11035),l=r(24464),d=r(24465),p=e=>{var t=Object(n.a)(),r={onRenderContent:()=>u.createElement("div",{style:{textAlign:"center",maxWidth:"248px"}},u.createElement(o.a,{variant:"small"},Object(d.a)(e.localizationStrings.emptyPresenceTooltip,u.createElement(i.a,{href:"https://go.microsoft.com/fwlink/?linkid=2208276",underline:!0,target:"_blank"},e.localizationStrings.learnMore))))};return u.createElement(a.a,{id:"copresenceErrorTooltip",tooltipProps:r,closeDelay:1e3,calloutProps:{styles:l.a}},u.createElement(s.a,{styles:l.c,showUnknownPersonaCoin:!0,size:c.c.size24,coinProps:{styles:Object(l.b)(t)}}))}},24464:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n={root:{height:"100%",marginRight:"-4px"}},o=e=>({initials:{color:e.palette.black}}),i={root:{marginRight:4}}},24465:function(e,t,r){"use strict";function n(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=[],i=0;return e.replace(/{(\d+)}/g,(t,n,a)=>(n<r.length&&(i!==a&&o.push(e.slice(i,a)),o.push(r[n]),i=a+t.length),"")),0!==o.length&&i===e.length||o.push(e.slice(i)),o}r.d(t,"a",(function(){return n}))},24466:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r(11543),o=r.n(n),i=r(21279),a=r.n(i),s=r(11035),c=r(12304),u=r(21018),l=r(24467),d=r(24468),p=r(21034),f=r(24452),v=r(24457),b=r(24469),m=r(24470),h=r(24450),g=r(18577),y=r(24459),O=r(24458),S=r(22260),P=e=>{var t,{graphService:r,telemetryService:n,featureGates:i,setCollaboratingUsers:P}=Object(u.b)(),{resourceType:j,presentUsers:w,setPresentUsers:C,environmentId:k,rpPresenceService:E,resourceId:I,sessionRefreshIntervals:D}=Object(h.b)(),T=Object(d.a)(),[x,R]=s.useState(!1),[U,F]=s.useState(!1),[A,N]=s.useState((new Date).getTime()),[W,L]=s.useState(null!==(t=null==D?void 0:D.active)&&void 0!==t?t:p.k),M=s.useRef([]),{selectedNode:B,localizationStrings:z,currentUserId:q}=e,{data:G}=Object(c.a)(["session",q,I,k],()=>q&&I&&k&&E?!T&&Object(m.g)(A)?(F(!0),null):Object(m.d)({rpPresenceService:E,telemetryService:n,sessionCache:b.b,currentUserId:q,environmentId:k,resourceId:I,resourceType:j,isWindowFocused:T,location:B,avoidRpSessionRecoverFromSessionStorage:!(null==i||!i.avoidRpSessionRecoverFromSessionStorage)},null==G?void 0:G.currentSession.sessionId):null,{refetchInterval:W,refetchIntervalInBackground:!0,keepPreviousData:!0,suspense:!0,enabled:!(x||U||null!=i&&i.useFRS),onSettled:()=>{var e,t,r=T?null!==(e=null==D?void 0:D.active)&&void 0!==e?e:p.k:null!==(t=null==D?void 0:D.inactive)&&void 0!==t?t:p.l;W!==r&&L(r)},onError:e=>{Object(f.b)(e)&&R(!0)},refetchOnMount:!1}),V=s.useMemo(()=>G?Object.values(G.copresenceDetails.sessions).filter(e=>Object(m.c)(e)):[],[null==G?void 0:G.copresenceDetails.sessions]),J=s.useMemo(()=>{var e=a()(V.map(e=>e.user.objectId));return o()(e,M.current)||(M.current=e),M.current},[V]),{isInitialLoading:_,userData:H,userPhotos:$}=Object(S.a)(r,J);s.useEffect(()=>{T&&U?(F(!1),n.trackInfo(g.a.WindowRefocusedAfterTimeout,{TotalWindowInactiveTime:(new Date).getTime()-A})):T||N((new Date).getTime())},[T]),s.useEffect(()=>{var e=()=>{try{null!=G&&G.currentSession.sessionId&&E&&E.endSession(null==G?void 0:G.currentSession.sessionId)}catch(e){n.trackError(g.a.FailedEndSessionOnUnmount,e)}};return b.a.callback=e,e},[]),s.useEffect(()=>{if(G&&H&&!_){var t=Object(m.b)(z,V,G.currentSession,H,$);if(!o()(w,t)){var r;null===(r=e.onPresentUsersUpdated)||void 0===r||r.call(e,t);var i=Object(m.e)(V);null!=i&&i.length&&n.trackInfo(g.a.RPPresentUsers,{numUsers:i.length,numConnections:Object(l.a)(i),collaboratingUsers:i}),P(i),C(t)}}},[V,H,$,B,w]);if(G&&J.length>0&&H&&!x){var Q=Object.values(H).filter(e=>e.id!==G.currentSession.user.objectId),K=V.find(e=>e.activeSessionType===O.a.Writer),X=Q.findindex(e=>e.id===(null==K?void 0:K.user.objectId));X>0&&Q.unshift(Q.splice(X,1)[0]);var Y=Q.map(t=>{return Object(v.a)({localizationStrings:z,user:t,imageUrl:$[t.id],userStatus:Object(m.a)(V,t.id),session:(r=t.id,n=V.filter(e=>e.user.objectId===r),n.length>1?Object(m.f)(n)[0]:n[0]),hideSessionType:!e.showSessionType});var r,n});return s.createElement(y.a,{presentUsers:Y,localizationStrings:z})}return s.createElement(s.Fragment,null)}},24467:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>e.reduce((e,t)=>e+t.connections.length,0)},24468:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(16182),o=r.n(n),i=r(11035),a=r.n(i),s=()=>{var[e,t]=Object(i.useState)(!0),r=a.a.useCallback(o()(e=>{switch(null==e?void 0:e.type){case"focus":return t(!0);case"blur":return t(!1);case"visibilitychange":return document.hidden?t(!1):t(!0)}},100,{leading:!1}),[t]);return Object(i.useEffect)(()=>(document.addEventListener("visibilitychange",r),document.addEventListener("blur",r),window.addEventListener("blur",r),window.addEventListener("focus",r),document.addEventListener("focus",r),()=>{window.removeEventListener("blur",r),document.removeEventListener("blur",r),window.removeEventListener("focus",r),document.removeEventListener("focus",r),document.removeEventListener("visibilitychange",r)}),[r]),e}},24469:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s}));var n=r(24460),o=r(21034),i=n.b.isAvailable()?n.b.getItem(o.m):void 0;if(i)for(var a of(n.b.isAvailable()&&n.b.removeItem(o.m),Object.keys(i)))i[a].lastUpdatedTime+o.j<(new Date).getTime()&&delete i[a];else i={};var s={};window.addEventListener("beforeunload",e=>{i&&n.b.isAvailable()&&n.b.setItem(o.m,i),s.callback&&s.callback()})},24470:function(e,t,r){"use strict";r.d(t,"d",(function(){return y})),r.d(t,"c",(function(){return O})),r.d(t,"e",(function(){return S})),r.d(t,"b",(function(){return P})),r.d(t,"a",(function(){return j})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return C}));var n=r(21029),o=r(21030),i=r(21034),a=r(24471),s=r(18577),c=r(24452),u=r(24458),l=r(24457);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){f(i,n,o,a,s,"next",e)}function s(e){f(i,n,o,a,s,"throw",e)}a(void 0)}))}}var b=[c.a.SessionNotFound,c.a.CopresenceDetailsNotFound,c.a.SessionUserMismatch],m=e=>"".concat(e.environmentId,"/").concat(e.resourceType,"(").concat(e.resourceId,")"),h=function(){var e=v((function*(e){try{var t=yield e.rpPresenceService.startSession(u.a.Writer,{status:e.isWindowFocused?a.a.Active:a.a.Inactive,location:e.location});return e.sessionCache[m(e)]={sessionId:t.currentSession.sessionId,lastUpdatedTime:new Date(t.currentSession.lastUpdatedTime).getTime()},t}catch(r){throw r}}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=v((function*(e,t){try{var r=yield e.rpPresenceService.refreshSession(t,{status:e.isWindowFocused?a.a.Active:a.a.Inactive,location:e.location});return e.sessionCache[m(e)]={sessionId:r.currentSession.sessionId,lastUpdatedTime:new Date(r.currentSession.lastUpdatedTime).getTime()},r}catch(n){if(!Object(c.c)(n)||!b.includes(n.code))throw n}}));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=v((function*(e,t){var r=e.telemetryService.createScenarioTracker(s.b.RenewOrStartNewSession,n.a.Create);try{var i,a;if(t||e.avoidRpSessionRecoverFromSessionStorage||e.sessionCache&&e.sessionCache[m(e)]&&(t=e.sessionCache[m(e)].sessionId),t){r.progress({message:"Renewing existing session",sessionId:t});try{(i=yield g(e,t))||r.progress({message:"Existing session is expired"})}catch(c){r.progress(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({message:"Renewing existing session failed"},Object(o.a)(c)))}}return i||(r.progress({message:"Starting new session"}),a=yield h(e)),i?(r.complete({message:"Renewed existing session ".concat(i.currentSession.sessionId)}),i):(r.complete({message:"Started new session",sessionId:a.currentSession.sessionId}),a)}catch(c){throw r.failure(Object(o.a)(c)),c}}));return function(t,r){return e.apply(this,arguments)}}(),O=e=>new Date(e.lastUpdatedTime).getTime()+i.a>(new Date).getTime(),S=e=>e.reduce((e,t)=>{var r=e.find(e=>e.userId===t.user.objectId);return r?(r.connections.push({id:t.sessionId}),e):[...e,{userId:t.user.objectId,connections:[{id:t.sessionId}]}]},[]),P=(e,t,r,n,o)=>{var i={};for(var a of t){var s;if(n[a.user.objectId]&&a.sessionId!==r.sessionId&&O(a)&&a.userClientContext&&a.userClientContext.location)i[a.userClientContext.location]=[...null!==(s=i[a.userClientContext.location])&&void 0!==s?s:[],Object(l.a)({localizationStrings:e,user:n[a.user.objectId],imageUrl:null==o?void 0:o[a.user.objectId]})]}return i},j=(e,t)=>e.filter(e=>e.user.objectId===t).find(e=>O(e)&&e.userClientContext.status===a.a.Active)?a.a.Active:a.a.Inactive,w=e=>e.sort((e,t)=>e.activeSessionType===u.a.Writer?-1:t.activeSessionType===u.a.Writer?1:new Date(t.lastUpdatedTime).getTime()-new Date(e.lastUpdatedTime).getTime()),C=e=>(new Date).getTime()>e+i.n},24471:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.Active="Active",e.Inactive="Inactive",e}({})},24472:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(11035),o=r.n(n),i=r(18577),a=r(24463);class s extends o.a.PureComponent{constructor(e){super(e),this.state={hasError:!1}}render(){return this.state.hasError?o.a.createElement(a.a,{localizationStrings:this.props.strings}):this.props.children}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.props.telemetryService.trackError(i.a.PresenceIndicatorCrashed,{eventData:t},e)}}},24473:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(11035),o=r(11064),i=r.n(o),a=r(21018),s=r(24474),c=r(22258);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"selection",r=arguments.length>2?arguments[2]:void 0,o=Object(c.a)(e,t,r),u=Object(s.a)(e),d=t=>{var r,i=Object(a.b)();return i&&i.featureGates?null!==(r=i.featureGates)&&void 0!==r&&r.useFRS?n.createElement(o,t):n.createElement(u,t):n.createElement(e,t)};return(d=i()(d,e)).defaultProps=l({},e.defaultProps),d}},24474:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(18261),o=r(18265),i=r(13348),a=r(12061),s=r(12065),c=r(11064),u=r.n(c),l=r(11035),d=r(24450),p=r(24475),f=r(24476),v=["onRenderItemLabel","pathMapping","styles","nodeHeight","iconWidth","theme","className","itemPresenceOptions","itemPresenceFacepileProps","shouldRollUpPresentUsers"];function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function g(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function y(e){var t=Object(a.a)(),r=r=>{var a,{onRenderItemLabel:s,pathMapping:c,styles:u,nodeHeight:p,iconWidth:b,theme:m,className:y,itemPresenceOptions:O,itemPresenceFacepileProps:S,shouldRollUpPresentUsers:P}=r,j=g(r,v),w=null===(a=Object(d.b)())||void 0===a?void 0:a.presentUsers,C=t(u,{nodeHeight:p,iconWidth:b,theme:m,className:y}),k=l.useCallback((e,t,a,u,d)=>{var p,v,b,m=null===(p=null==O||null===(v=O.showPresenceForItem)||void 0===v?void 0:v.call(O,e))||void 0===p||p,g=Object(f.a)(r.items,a,e,c,w,P);return l.createElement(l.Fragment,null,null!==(b=null==s?void 0:s(e,t,a,u,d))&&void 0!==b?b:d(),m&&g&&l.createElement(n.a,h({personas:g.map(e=>({personaName:e.displayName,imageUrl:e.imageUrl})),personaSize:i.c.size16,maxDisplayablePersonas:2,overflowButtonType:o.a.descriptive,overflowButtonProps:{},styles:C.subComponentStyles.itemPresenceFacepile},S,{getPersonaProps:()=>({imageShouldFadeIn:!0,hidePersonaDetails:!0})})))},[s,w,c,null==O?void 0:O.showPresenceForItem]);return l.createElement(e,h({},j,{nodeHeight:p,iconWidth:b,theme:m,className:y,styles:u,onRenderItemLabel:k}))};return(r=u()(Object(s.a)(r,p.a),e)).defaultProps=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e.defaultProps),r}},24475:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({subComponentStyles:{itemPresenceFacepile:{root:{display:"inline-block",marginRight:8,marginLeft:8},members:{overflow:"visible"}}}})},24476:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=(e,t)=>{for(var r=e.indexOf(t)+1,n=[];e[r]&&e[r].level>t.level;)n.push(e[r]),r++;return n},o=function(e,t,r,o,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=[],c=o&&o(r),u=void 0!==c?i[c]:void 0;if(u&&s.push(...u),a&&r.isFolder&&!t){var l=n(e,r);l.forEach(e=>{var t=o&&o(e),r=void 0!==t?i[t]:void 0;r&&s.push(...r)})}return s}},24477:function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return c}));var n="collaboration-environment-makers",o="Collaboration/EnvironmentMakers",i="studio-collaboration",a="Collaboration",s="dataverse-comments-pane",c="Collaboration/Comments"},24478:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(12294),o=r(15179),i=r(21018),a=r(24479),s=r(11035),c=r.n(s),u=r(24488),l=r(24489),d=r(24491),p=r(12992),f=Object(o.b)(e=>{var[t,r]=Object(s.useState)(),{telemetryScope:n,telemetryPrefix:o,httpClient:f,children:v,featureGates:b}=e,m=Object(s.useMemo)(()=>Object(p.a)(n,o),[n,o]),h=Object(s.useMemo)(()=>Object(d.a)(f,m),[m,f]),g=Object(s.useMemo)(()=>new a.a(h,m,u.a),[h,m]),y=new l.a,O=Object(s.useMemo)(()=>({telemetryService:m,httpRequestor:h,graphService:g,featureGates:b,collaborationUrls:y,collaboratingUsers:t,setCollaboratingUsers:r}),[m,h,g,b,t,r]);return c.a.createElement(i.a,{value:O},v)},[n.r]),v=e=>{var t=Object(i.b)();return t&&t.graphService&&t.httpRequestor&&t.telemetryService?c.a.createElement(c.a.Fragment,null,e.children):c.a.createElement(f,e)}},24488:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}));var n="powerPlatform.powerApps.disableMembersIndicator",o="1234123412341234123412341234123412341234123="},24489:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(21019),o=r(24490),i=r(12378);class a extends n.a{constructor(){var e=!i.a.getConfig().deprecateLegacyPARP;super(e),e||(this.rpUrls=new o.a)}}},24490:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(21021),o=r(21020);class i extends o.a{getBasePresenceURL(e,t){return"powerapps/tenants/:tenantId/environments/:environmentName/".concat(e,"/").concat(t)}getTargetService(){return n.a.ppapi}getStartSessionUrl(e,t,r){return"".concat(this.getBasePresenceURL(e,t),"/startSession?").concat(this.ppapiVersion)}getGetSessionsUrl(e,t){return"".concat(this.getBasePresenceURL(e,t),"/sessions?").concat(this.ppapiVersion)}getRefreshSessionUrl(e,t,r,n){return"".concat(this.getBasePresenceURL(e,t),"/sessions/").concat(n,"/refreshSession?").concat(this.ppapiVersion)}getEndSessionUrl(e,t,r,n){return"".concat(this.getBasePresenceURL(e,t),"/sessions/").concat(n,"/endSession?").concat(this.ppapiVersion)}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/app-module-designer~p~14ff675d.e7f3feff.chunk.js.map